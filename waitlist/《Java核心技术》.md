[TOC]

# 《Java核心技术》

## 一、Java概述

- 简单性
- 面向对象
- 网络技能
- 健壮性
- 安全性
- 体系结构中立
- 可移植性
- 解释性
- 高性能
- 多线程
- 动态性

----



## 二、Java的基本程序设计结构

### 1、数据类型

- Java是一种强类型的语言，这就意味着必须为没一个变量声明一种类型，总共有8种基本类型，1种表示真值的boolean类型，1种表示Unicode编码的char和2种浮点类型，4种整型
- 整型：

  - byte（1字节）、short（2字节）、int（4字节）、long（8字节）相应的取值范围都是-2^字节数~2^字节数-1
  - 在Java平台中，整型的范围与运行Java的机器无关，与此相反，c和c++针对不同的处理器选择有效的整型，这样有可能造成在一个32位处理器上运行很好的程序在16位系统上运行却发生整数溢出
  - 十六进制前有0x，八进制前有一个0，加0b写二进制数，100_100_100，可以让人更容易读，编译器会去除这些下划线
- 浮点类型：
  - 三种表示溢出的出错情况的三个特殊的浮点数值：正无穷大、负无穷大、NaN(不是一个数字)，不能检测一个特定的值是不是等于Double.NaN，所有的非数值都认为是不同的
  - 浮点数不适用于禁止出现舍入误差的金融计算中，都采用BigDecimal类

- char类型：
  - char类型用于表示单个字符，例如'A'是编码为65所对应的字符常量。与“A” 不同，“A”是一个包含字符A  的字符串
  - Unicode编码单元可以表示为十六进制值，其范围从\u0000到\Uffff
  - 想要弄清楚char类型，就必须了解Unicode编码表，Unicode打破了传统的字符编码方法的限制，在Unicode出现之前，已经有许多种不同的标准：美国的ASCLL，西欧洲=语言中的ISO8859-1。。
  - 这样就产生了下面的两个问题：
    - 一个是对任意给定的代码值，在不同的编码方案中会对应不同的字符
    - 二是采用大字符集的语言其编码长度可能会有不同，例如有些常用的字符集采用单字节编码，二Unicode采用双字节编码
    - 在发布Unicode1.0的时候当时仅占用65536（2的16次幂），但是很快，由于加入了中文和韩文等大量文字后，现在16位的char类已经不能满足描述所有Unicode字符的需要了

### 2、字符串

- 从概念上讲，Java字符串就是Unicode字符序列，Java没有预置字符串类型，二是在标准Java类库中提供了一个预定义类，很自然地叫做String，每个用双引号括起来的字符串都是String类的一个实例
- 不可变字符串：对字符串的修改都会重新创建一个字符串对象。这样做是否会降低运行效率呢？看起来好像修改一个代码单元比创建一个新的字符串更简洁，但是，不可变字符串却又自己的优点：编译器可以让字符串共享
- 总而言之，Java的设计者认为字符串共享带来的高效率远远胜于提取、拼接字符串所带来的低效率。
- ”hello“.equals(greeting)可以比较两个字符串是否相等，可以使字符串常量也可以是字符串变量，如果想不区分大小写，可以用equalsIgnoreCase()
- 如果虚拟机始终将字符串共享那么就可以用==来比较字符串是否相等，但是事实是只有字符串常量是共享的，而+或者substring等操作产生的结果不是共享的
- 空串""是一个Java对象，有自己的长度0和内容(空)，不过String还可以存放一个特殊的值，名为null，这表示目前没有任何对象与该变量关联`if (str!=null && str.length()>0)`
- Java字符串由char序列构成，char数据类型是一个采用UTF-16编码表示Unicode代码点的代码单元，大多数常用的Unicode字符使用一个代码单元就可以表示，而辅助字符需要**一对代码单元**来表示

  - length()方法返回采用UTF-16编码表示的给定字符串所需要的代码单元数量
  - str.codePoint(0,str.length())返回字符串的**实际长度，即代码点数量**
- **代码点**（Code Point)：Unicode是属于编码字符集（CCS）的范围。Unicode所做的事情就是将我们需要表示的字符表中的每个字符映射成一个数字，这个数字被称为相应字符的码点（code point）。例如“严”字在Unicode中对应的码点是U+0x4E25。
  - 代码点是字符集被编码后出现的概念。字符集（Code Set）是一个集合，集合中的元素就是字符，比如ASCII字符集，其中的字符就是'A'、'B'等字符。为了在计算机中处理字符集，必须把字符集数字化，就是给字符集中的每一个字符一个编号，计算机程序中要用字符，直接用这个编号就可以了。于是就出现了编码后的字符集，叫做编码字符集(Coded Code Set)。编码字符集中每一个字符都和一个编号对应。那么这个编号就是代码点（Code Point）。
- **代码单元**（Code Unit）：是指一个已编码的文本中具有最短的比特组合的单元。对于UTF-8来说，代码单元是8比特长；对于UTF-16来说，代码单元是16比特长。换一种说法就是UTF-8的是以一个字节为最小单位的，UTF-16是以两个字节为最小单位的。
  - 代码单元是把代码点存放到计算机后出现的概念。一个字符集，比如有10个字符，每一个字符从0到9依次编码。那么代码点就是0、1、。。。、9。为了在计算机中存储这10个代代码点，一个代码点给一个字节，那么这里的一个字节就是一个代码单元。比如Unicode是一个编码字符集，其中有65536个字符，代码点依次为0、1、2、。。。、65535，为了在计算机中表示这些代码点就出现了代码单元，65536个代码点为了统一表示每个代码点必须要有两个字节表示才行。但是为了节省空间0-127的ASCII码就可以不用两个字节来表示，只需要一个字节，于是不同的表示方案就形成了不同的编码方案，比如utf-8、utf-16等。对utf-8而言代码单元就是一个字节，对utf-16而言代码单元就是两个字节。

```java
        String sentence = "\u0041 \u0042";  // 该字符串的第二个（从一开始计）字符是空格
        System.out.println(sentence);
        int lengthU = sentence.length();
        int lengthP = sentence.codePointCount(0, lengthU);
        System.out.println(lengthU);        // 3个代码单元
        System.out.println(lengthP);        // 3个代码点

        System.out.println("---------------我是分割线-----------------");
        String sentence2 = "\u03C0 \uD835\uDD6B";    // 该字符串的第二个（从一开始计）字符是空格
        System.out.println(sentence2);
        int lengthU2 = sentence2.length();
        int lengthP2 = sentence2.codePointCount(0, lengthU);
        System.out.println(lengthU2);        // 4个代码单元
        System.out.println(lengthP2);        // 3个代码点
---------输出
A B
3
3
---------------我是分割线-----------------
π 𝕫
4
3
```



- ##### 字符编码

  前面还都属于字符集的概念，现在终于到 CEF 的层次了。为了便于计算的存储和处理，现在我们要把哪些纯数学数字对应成有限长度的比特值了。最直观的设计当然是一个字符的码点是什么数字，我们就把这个数字转换成相应的二进制表示，例如“严”在 Unicode 中对应的数字是 0x4E25,他的二进制是`100 1110 0010 0101`，也就是严这个字需要两个字节进行存储。按照这种方法大部分汉字都可以用两个字节来表示了。但是还有其他语系的存在，没准儿他们所使用的字符用这种方法转换就需要 4 个字节。这样问题又来了到底该使用几个字节表示一个字符呢？如果规定两个字节，有的字符会表示不出来，如果规定较多的字节表示一个字符，很多人又不答应，因为本来有些语言的字符两个字节处理就可以了，凭什么用更多的字节表示，多么浪费。

  这时就会想可不可以用变长的字节来存储一个字符呢？如果使用了变长的字节表示一个字符，那就必须要知道是几个字节表示了一个字符，要不然计算机可没那么聪明。

- 除了 UTF-8 这种转换方法，还存在 UTF-16，UTF-32 等等转换方法。（注意UTF后边的数字代表的是码元的大小。码元（Code Unit）是指一个已编码的文本中具有最短的比特组合的单元。对于 UTF-8 来说，码元是 8 比特长；对于 UTF-16 来说，码元是 16 比特长。**换一种说法就是 UTF-8 的是以一个字节为最小单位的，UTF-16 是以两个字节为最小单位的。）**

- [编码发展历史](https://github.com/acmerfight/insight_python/blob/master/Unicode_and_Character_Sets.md)

- switch case的case标签可以使
  - 类型为char、byte、short或int琥珀其包装类的常量表达式
  - 枚举常量，使用枚举常量时，不必再每个标签中致命枚举名，可以由switch的表达式确定
  - 从Java SE7开始，case标签还可以是字符串字面量
- 数组长度为0余null不同，空数组也是一个对象，只是包含元素个数为0
- 



---



## 三、类与对象



----

