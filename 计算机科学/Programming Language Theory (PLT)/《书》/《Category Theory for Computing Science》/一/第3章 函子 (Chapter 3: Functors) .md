[toc]



好的，让我们继续详细解析您提供的章节 **3 Functors（函子）**。本章主要探讨范畴论中的**函子**，包括函子的定义、例子、性质、等价范畴（equivalence of categories）、以及范畴的商（quotient categories）。通过这些内容，您将深入理解函子在范畴论中的核心作用及其在数学不同领域中的应用。

---

## 3 Functors（函子）

函子是范畴论中的核心概念之一，它将一个范畴的结构映射到另一个范畴，同时保持范畴的基本结构（即对象和箭头之间的关系）。函子在数学中扮演着桥梁的角色，连接不同的数学结构和理论。

### 3.1 函子的定义

**定义 3.1：** 设 $\mathcal{C}$ 和 $\mathcal{D}$ 是两个范畴。一个**函子** $F$ 从范畴 $\mathcal{C}$ 到范畴 $\mathcal{D}$ 是一个图同态，满足以下两个条件：

1. **保持恒等箭头（Preserves identities）：**
   
   对于范畴 $\mathcal{C}$ 中的每一个对象 $A$，有：
   
   $$
   F(\text{id}_A) = \text{id}_{F(A)}
   $$
   
   即，恒等箭头在函子作用下被映射为目标范畴中对应对象的恒等箭头。

2. **保持复合（Preserves composition）：**
   
   对于范畴 $\mathcal{C}$ 中的任意两条可复合的箭头 $f: A \rightarrow B$ 和 $g: B \rightarrow C$，有：
   
   $$
   F(g \circ f) = F(g) \circ F(f)
   $$
   
   即，箭头的复合在函子作用下等于箭头各自作用后的复合。

**符号表示：**

$$
F: \mathcal{C} \rightarrow \mathcal{D}
$$

**解释：**

- **对象映射（Object Mapping）：** $F$ 将范畴 $\mathcal{C}$ 中的每一个对象 $A$ 映射为范畴 $\mathcal{D}$ 中的对象 $F(A)$。
  
- **箭头映射（Arrow Mapping）：** $F$ 将范畴 $\mathcal{C}$ 中的每一条箭头 $f: A \rightarrow B$ 映射为范畴 $\mathcal{D}$ 中的箭头 $F(f): F(A) \rightarrow F(B)$。

- **结构保持（Structure Preservation）：** 函子不仅映射对象和箭头，还保持了恒等箭头和箭头的复合关系，确保了范畴结构的完整性。

### 3.2 函子的例子

理解函子的最佳方式是通过具体的例子。以下是几个常见的函子例子：

#### 3.2.1 恒等函子（Identity Functor）

**定义：**

对任意范畴 $\mathcal{C}$，存在一个恒等函子 $\text{Id}_{\mathcal{C}}$ ，其定义为：

- **对象映射：** 对每个对象 $A \in \mathcal{C}$，有 $\text{Id}_{\mathcal{C}}(A) = A$。
  
- **箭头映射：** 对每条箭头 $f: A \rightarrow B$，有 $\text{Id}_{\mathcal{C}}(f) = f$。

**性质：**

- 恒等函子是每个范畴的恒等元，满足对于任意函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，有：
  
  $$
  F \circ \text{Id}_{\mathcal{C}} = F \quad \text{和} \quad \text{Id}_{\mathcal{D}} \circ F = F
  $$

#### 3.2.2 对偶函子（Dual Functor）

**定义：**

给定一个范畴 $\mathcal{C}$，其**对偶范畴** $\mathcal{C}^{\text{op}}$ 定义为：

- **对象：** $\mathcal{C}^{\text{op}}$ 的对象与 $\mathcal{C}$ 的对象相同。
  
- **箭头：** $\mathcal{C}^{\text{op}}$ 中的每条箭头 $f^{\text{op}}: B \rightarrow A$ 对应于 $\mathcal{C}$ 中的箭头 $f: A \rightarrow B$。

**对偶函子 $(-)^{\text{op}}$：**

$$
(-)^{\text{op}}: \mathcal{C} \rightarrow \mathcal{C}^{\text{op}}
$$

**定义：**

- **对象映射：** 对每个对象 $A \in \mathcal{C}$，有 $(-)^{\text{op}}(A) = A$。
  
- **箭头映射：** 对每条箭头 $f: A \rightarrow B$，有 $(-)^{\text{op}}(f) = f^{\text{op}}: B \rightarrow A$。

**性质：**

- 对偶函子是自身的对偶，即 $(\mathcal{C}^{\text{op}})^{\text{op}} = \mathcal{C}$。
  
- 对偶函子的复合也是对偶函子，即 $(-)^{\text{op}} \circ (-)^{\text{op}} = \text{Id}_{\mathcal{C}}$。

#### 3.2.3 自由函子（Free Functor）

**定义：**

在范畴论中，自由函子通常用于将某种结构映射到另一种结构，同时保持结构的“自由性”。例如，从集合范畴 $\text{Set}$ 到群范畴 $\text{Grp}$ 的自由群函子 $F$ 定义为：

- **对象映射：** 对每个集合 $S$，$F(S)$ 是生成集合 $S$ 的自由群。
  
- **箭头映射：** 对每个函数 $f: S \rightarrow T$，$F(f): F(S) \rightarrow F(T)$ 是由 $f$ 唯一确定的群同态。

**性质：**

- 自由函子左伴随于忘却函子（forgetful functor），即存在自然同构：
  
  $$
  \text{Hom}_{\text{Grp}}(F(S), G) \cong \text{Hom}_{\text{Set}}(S, U(G))
  $$
  
  其中 $U: \text{Grp} \rightarrow \text{Set}$ 是忘却函子，将群映射为其底层集合。

#### 3.2.4 忘却函子（Forgetful Functor）

**定义：**

忘却函子 $U: \mathcal{D} \rightarrow \mathcal{C}$ 是将具有更多结构的范畴 $\mathcal{D}$ 映射到具有较少结构的范畴 $\mathcal{C}$ 的函子。例如，从群范畴 $\text{Grp}$ 到集合范畴 $\text{Set}$ 的忘却函子 $U$ 定义为：

- **对象映射：** 对每个群 $G$，有 $U(G)$ 是群 $G$ 的底层集合。
  
- **箭头映射：** 对每个群同态 $f: G \rightarrow H$，有 $U(f) = f$（即视为集合之间的函数）。

**性质：**

- 忘却函子通常有左伴随函子（如自由函子），这使得它们在范畴论中具有重要的角色。
  
- 忘却函子保持箭头的复合和恒等箭头，但可能不保留其他结构性质，如同构性或单射性。

### 3.3 函子的性质

函子不仅是对象和箭头的映射，还具有保持范畴结构的性质。以下是一些重要的函子性质：

#### 3.3.1 全函子与满函子（Full and Faithful Functors）

**定义：**

- **全函子（Full Functor）：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 被称为**全函子**，如果对于任意两个对象 $A, B \in \mathcal{C}$，函子 $F$ 在 $\text{Hom}(A, B)$ 上的映射 $F_{A,B}: \text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))$ 是满射的。
  
- **满函子（Faithful Functor）：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 被称为**满函子**，如果对于任意两个对象 $A, B \in \mathcal{C}$，函子 $F$ 在 $\text{Hom}(A, B)$ 上的映射 $F_{A,B}: \text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))$ 是单射的。
  
- **全且满函子（Fully Faithful Functor）：** 一个函子同时是全函子和满函子，则称其为**全且满函子**。

**解释：**

- **全函子：** 意味着在目标范畴 $\mathcal{D}$ 中，$F$ 的图像覆盖了所有可能的箭头，即 $F$ 没有遗漏任何箭头。
  
- **满函子：** 意味着 $F$ 不会将不同的箭头映射到同一个箭头上，即 $F$ 保持了箭头的区分性。

**性质：**

- **等价关系：** 全且满函子在某种程度上保留了范畴 $\mathcal{C}$ 的结构，使得 $F$ 能够在目标范畴 $\mathcal{D}$ 中“完整地”表示 $\mathcal{C}$ 的结构。

#### 3.3.2 自然同构函子（Naturally Isomorphic Functors）

**定义：**

- **自然变换（Natural Transformation）：** 设 $F, G: \mathcal{C} \rightarrow \mathcal{D}$ 是两个函子。一个**自然变换** $\eta$ 从 $F$ 到 $G$，记作 $\eta: F \Rightarrow G$，由一族箭头 $\eta_A: F(A) \rightarrow G(A)$ 组成，对于每个对象 $A \in \mathcal{C}$，满足对任意箭头 $f: A \rightarrow B$ 有：
  
  $$
  \eta_B \circ F(f) = G(f) \circ \eta_A
  $$
  
- **自然同构（Natural Isomorphism）：** 如果自然变换 $\eta$ 中的每个箭头 $\eta_A$ 都是同构箭头，则称 $\eta$ 是一个**自然同构**。此时，$F$ 和 $G$ 被称为**自然同构**，记作 $F \cong G$。

**解释：**

- 自然同构表示两个函子在范畴论的结构下是等价的，它们在结构上没有区别，只是在具体表现上可能不同。

**性质：**

- 自然同构是函子之间的一种强等价关系，是范畴论中重要的等价概念。

#### 3.3.3 伴随函子（Adjoint Functors）

**定义：**

- **左伴随函子和右伴随函子（Left and Right Adjoint Functors）：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 和 $G: \mathcal{D} \rightarrow \mathcal{C}$ 是两个函子。如果对于任意对象 $C \in \mathcal{C}$ 和 $D \in \mathcal{D}$，存在一个自然同构：
  
  $$
  \text{Hom}_{\mathcal{D}}(F(C), D) \cong \text{Hom}_{\mathcal{C}}(C, G(D))
  $$
  
  则称 $F$ 是 $G$ 的**左伴随函子**，而 $G$ 是 $F$ 的**右伴随函子**。

**解释：**

- 伴随函子描述了两类函子之间的互补关系，反映了范畴之间的深层结构联系。

**性质：**

- **唯一性：** 伴随函子在范畴论中具有高度的唯一性和结构性，常用于构造和分析复杂的范畴结构。
  
- **伴随定理（Adjoint Functor Theorems）：** 这些定理为证明某些函子存在伴随函子提供了条件和方法，是范畴论中的重要工具。

### 3.4 等价范畴（Equivalence of Categories）

**定义：**

两个范畴 $\mathcal{C}$ 和 $\mathcal{D}$ 被称为**等价范畴**，记作 $\mathcal{C} \simeq \mathcal{D}$，如果存在两个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 和 $G: \mathcal{D} \rightarrow \mathcal{C}$，使得：

1. $F \circ G \cong \text{Id}_{\mathcal{D}}$
2. $G \circ F \cong \text{Id}_{\mathcal{C}}$

其中，$\cong$ 表示自然同构。

**解释：**

- 等价范畴意味着这两个范畴在范畴论的视角下“是相同的”，尽管它们可能在具体表现上有所不同。
  
- 等价范畴保留了所有范畴论中的结构和性质，是范畴论中的一种重要的等价关系。

**性质：**

- **反对称性：** 如果 $\mathcal{C} \simeq \mathcal{D}$，则 $\mathcal{D} \simeq \mathcal{C}$。
  
- **传递性：** 如果 $\mathcal{C} \simeq \mathcal{D}$ 且 $\mathcal{D} \simeq \mathcal{E}$，则 $\mathcal{C} \simeq \mathcal{E}$。

**例子：**

1. **集合与自身：** 任意范畴与自身是等价范畴，因为恒等函子是一个等价关系的示例。
  
2. **有限维向量空间：** 不同的基底选择对应的范畴中的等价函子。

### 3.5 范畴的商（Quotient Categories）

**定义：**

**商范畴**（Quotient Category）是通过在原范畴中引入等价关系，将某些箭头视为等价，从而构造出的新范畴。

**具体定义：**

设 $\mathcal{C}$ 是一个范畴，且在 $\mathcal{C}$ 中定义了一个等价关系 $\sim$ 在箭头上。商范畴 $\mathcal{C}/\sim$ 定义为：

- **对象：** 与 $\mathcal{C}$ 相同。
  
- **箭头：** $\mathcal{C}/\sim$ 中的箭头是 $\mathcal{C}$ 中箭头的等价类。
  
- **复合与恒等：** 保持原范畴中的复合与恒等箭头。

**解释：**

- 商范畴通过将某些箭头视为等价，实现了对原范畴结构的简化或修改。
  
- 商范畴在处理同一对象之间的多余箭头或识别某些结构时非常有用。

**例子：**

1. **群的商群：** 在群范畴中，通过正规子群定义商群范畴。
  
2. **拓扑空间的商空间：** 在拓扑范畴中，通过识别拓扑空间中的等价关系构造商空间。

**性质：**

- 商范畴通常保留了原范畴的一些基本性质，但可能在某些方面有所不同。
  
- 构造商范畴需要确保等价关系的一致性，以保持范畴结构的完整性。

### 3.6 习题（Exercises）

以下是一些习题，帮助您巩固对函子、等价范畴和商范畴的理解：

1. **习题1：恒等函子的性质**
   
   - **题目：** 证明恒等函子 $\text{Id}_{\mathcal{C}}$ 是每个范畴 $\mathcal{C}$ 的一个同构函子。
   
   - **提示：** 需要构造一个自然同构 $\eta: \text{Id}_{\mathcal{C}} \Rightarrow \text{Id}_{\mathcal{C}}$，并验证自然同构的条件。

2. **习题2：对角填充的唯一性**
   
   - **题目：** 证明：如果 $\mathcal{M}$ 中的每个箭头都是单射，或者 $\mathcal{E}$ 中的每个箭头都是射影箭头，那么在定义 **FS-3** 中的唯一性条件可以省略。
   
   - **提示：** 利用 $\mathcal{M}$ 或 $\mathcal{E}$ 中箭头的单射或射影性质，确保对角填充箭头的唯一性。

3. **习题3：集合范畴中的因式分解系统**
   
   - **题目：** 证明：在集合范畴 $\text{Set}$ 中，$\mathcal{E}$ 类由所有射影箭头（满射函数）组成，$\mathcal{M}$ 类由所有单射箭头（注入函数）组成，这两类箭头构成了一个因式分解系统。
   
   - **提示：** 需要验证 **FS-1**, **FS-2**, **FS-3** 三个条件。

4. **习题4：单子范畴中的因式分解系统缺失**
   
   - **题目：** 设 $\mathbb{Z}$ 是整数单子的集合，$\mathbb{N}$ 是非负整数单子的集合，包含映射 $i : \mathbb{N} \rightarrow \mathbb{Z}$（既是单射又是射影）。证明如下交换方形：
   
     $$
     \begin{array}{ccc}
     \mathbb{N} & \xrightarrow{i} & \mathbb{Z} \\
     \downarrow{i} & & \downarrow{i} \\
     \mathbb{N} & \xrightarrow{i} & \mathbb{Z}
     \end{array}
     $$
   
     该方形是交换的，但不存在一个对角填充箭头 $h : \mathbb{Z} \rightarrow \mathbb{N}$。因此，$\mathcal{E}$ 类的所有射影箭头和 $\mathcal{M}$ 类的所有单射箭头在单子范畴中不构成一个因式分解系统。
   
   - **提示：** 假设存在对角箭头 $h$，并通过性质推导出矛盾。

5. **习题5：自然同构的性质**
   
   - **题目：** 设 $F, G: \mathcal{C} \rightarrow \mathcal{D}$ 是两个函子，且 $\eta: F \Rightarrow G$ 是一个自然同构。证明：$F$ 和 $G$ 是等价范畴中的函子。
   
   - **提示：** 利用自然同构的定义和等价范畴的定义。

6. **习题6：伴随函子的实例**
   
   - **题目：** 在集合范畴 $\text{Set}$ 中，构造自由群函子 $F: \text{Set} \rightarrow \text{Grp}$ 和忘却函子 $U: \text{Grp} \rightarrow \text{Set}$，并证明 $F$ 是 $U$ 的左伴随函子。
   
   - **提示：** 利用自由群与群同态的定义，构造自然同构。

7. **习题7：商范畴的构造**
   
   - **题目：** 设 $\mathcal{C}$ 是一个范畴，且在 $\mathcal{C}$ 中定义了一个等价关系 $\sim$ 在箭头上。构造商范畴 $\mathcal{C}/\sim$ 并验证其满足范畴的公理。
   
   - **提示：** 需要验证对象和箭头的定义，以及箭头复合的合法性。

8. **习题8：等价范畴的应用**
   
   - **题目：** 证明：有限维向量空间范畴 $\text{Vect}_n$ 和 $\text{Vect}_m$ 当且仅当 $n = m$ 时，才是等价范畴。
   
   - **提示：** 利用维数的保持性质和函子的结构保持条件。

9. **习题9：函子的复合与恒等性**
   
   - **题目：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 和 $G: \mathcal{D} \rightarrow \mathcal{E}$ 是两个函子，证明函子复合 $G \circ F: \mathcal{C} \rightarrow \mathcal{E}$ 也是一个函子。
   
   - **提示：** 验证保持恒等箭头和箭头复合的条件。

10. **习题10：同构函子的分类**
    
    - **题目：** 证明：在任何范畴中，只有同构函子是全且满的，并且保留了对象和箭头的结构。
    
    - **提示：** 利用全函子和满函子的定义，结合同构函子的性质。

---

## 总结

本章 **3 Functors（函子）** 深入探讨了范畴论中的函子概念，包括函子的定义、例子、性质、等价范畴以及范畴的商。函子作为连接不同范畴的桥梁，在范畴论中具有核心地位，其应用广泛涵盖了数学的各个领域。

**关键点回顾：**

1. **函子的定义与结构保持：**
   - 函子不仅映射对象和箭头，还保持恒等箭头和箭头的复合关系，确保了范畴结构的完整性。

2. **函子的例子：**
   - 恒等函子、对偶函子、自由函子和忘却函子等都是函子的典型例子，通过具体例子加深对函子概念的理解。

3. **函子的性质：**
   - 全函子与满函子描述了函子在箭头映射上的覆盖性和区分性。
   - 自然同构函子和伴随函子展示了函子之间的高级关系和互补性。

4. **等价范畴：**
   - 等价范畴揭示了不同范畴在结构上的等价性，使得我们可以在不同的数学背景下进行转换而不丢失信息。

5. **商范畴：**
   - 商范畴通过引入等价关系简化和修改原范畴的结构，广泛应用于构造和分析新的范畴。

6. **习题的应用：**
   - 通过习题，您可以实践如何构造和验证函子，理解函子的高级性质，掌握等价范畴和商范畴的构造方法。

**进一步学习建议：**

- **自然变换与同伦论：** 自然变换是函子之间的重要关系，深入理解自然变换有助于掌握更高级的范畴论概念。
  
- **伴随函子的应用：** 伴随函子在许多数学领域中具有重要应用，尤其是在代数和拓扑学中。

- **高阶范畴论：** 探索更高阶的范畴，如2-范畴（2-categories）和∞-范畴（∞-categories），扩展对范畴论的理解。

通过对函子及其相关概念的深入学习，您将能够更好地理解范畴论的抽象框架及其在数学和计算机科学中的广泛应用。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ---------------------------

好的，让我们继续详细解析您提供的章节 **3.1 Functors（函子）**。本节主要介绍函子的正式定义、具体例子以及其在不同范畴中的应用。通过这些内容，您将深入理解函子作为范畴之间结构保持映射的重要性及其多样性。

---

## 3.1 函子

函子是范畴论中的核心概念之一，它将一个范畴的结构映射到另一个范畴，同时保持范畴的基本结构（即对象和箭头之间的关系）。函子在数学中扮演着桥梁的角色，连接不同的数学结构和理论。

### 3.1.1 定义

**定义 3.1.1：** 一个**函子** $F : \mathcal{C} \rightarrow \mathcal{D}$ 是一对函数 $F_0 : \text{Ob}(\mathcal{C}) \rightarrow \text{Ob}(\mathcal{D})$ 和 $F_1 : \text{Hom}(\mathcal{C}) \rightarrow \text{Hom}(\mathcal{D})$，满足以下条件：

1. **F–1（保持箭头源和靶）：** 对于范畴 $\mathcal{C}$ 中的每一个箭头 $f: A \rightarrow B$，有 $F_1(f): F_0(A) \rightarrow F_0(B)$ 是范畴 $\mathcal{D}$ 中的一个箭头。

2. **F–2（保持恒等箭头）：** 对于范畴 $\mathcal{C}$ 中的每一个对象 $A$，有：
   
   $$
   F_1(\text{id}_A) = \text{id}_{F_0(A)}
   $$
   
   即，恒等箭头在函子作用下被映射为目标范畴中对应对象的恒等箭头。

3. **F–3（保持箭头复合）：** 对于范畴 $\mathcal{C}$ 中的任意两条可复合箭头 $f: A \rightarrow B$ 和 $g: B \rightarrow C$，有：
   
   $$
   F_1(g \circ f) = F_1(g) \circ F_1(f)
   $$
   
   即，箭头的复合在函子作用下等于箭头各自作用后的复合。

**符号表示：**

$$
F: \mathcal{C} \rightarrow \mathcal{D}
$$

**解释：**

- **对象映射（Object Mapping）：** $F$ 将范畴 $\mathcal{C}$ 中的每一个对象 $A$ 映射为范畴 $\mathcal{D}$ 中的对象 $F(A)$。

- **箭头映射（Arrow Mapping）：** $F$ 将范畴 $\mathcal{C}$ 中的每一条箭头 $f: A \rightarrow B$ 映射为范畴 $\mathcal{D}$ 中的箭头 $F(f): F(A) \rightarrow F(B)$。

- **结构保持（Structure Preservation）：** 函子不仅映射对象和箭头，还保持了恒等箭头和箭头的复合关系，确保了范畴结构的完整性。

**惯例：**

按照图同态的惯例，$F(A)$ 和 $F(f)$ 分别表示对象和箭头的映射。尽管 $F_0$ 和 $F_1$ 的表示不常用，但为了强调其组成部分，有时会使用它们。

### 3.1.2 例子：单子同态作为函子

**例子 3.1.2：** 一个单子同态 $f: M \rightarrow N$ 确定了从单子范畴 $\mathcal{C}(M)$ 到单子范畴 $\mathcal{C}(N)$ 的一个函子。

**具体说明：**

- **对象映射：** 在单子范畴 $\mathcal{C}(M)$ 和 $\mathcal{C}(N)$ 中，每个范畴只有一个对象。因此，函子 $F$ 必须将 $\mathcal{C}(M)$ 的唯一对象映射到 $\mathcal{C}(N)$ 的唯一对象。

- **箭头映射：** 单子范畴中的箭头对应于单子同态。由于 $f$ 是一个单子同态，函子 $F$ 的箭头映射部分 $F_1$ 就是单子同态 $f$ 的作用。

- **保持恒等箭头和复合：** 函子 $F$ 需要满足 $F(\text{id}) = \text{id}$ 和 $F(g \circ h) = F(g) \circ F(h)$。这与单子同态的性质一致，因为单子同态自然满足这些条件。

**结论：** 每个单子同态都可以视为一个函子，函子在单子范畴中的作用与单子同态的作用一致。

### 3.1.3 例子：偏序集中的单调映射

**例子 3.1.3：** 在偏序集范畴 $\mathcal{C}(S, \alpha)$ 和 $\mathcal{C}(T, \beta)$ 中，函子 $f: S \rightarrow T$ 必须是一个**单调映射**（monotone map）。

**具体说明：**

- **对象映射：** 偏序集范畴中的对象是偏序集，函子 $F$ 将偏序集 $S$ 映射到偏序集 $T$ 的单调映射 $f$。

- **箭头映射：** 在偏序集范畴中，存在从 $x$ 到 $y$ 的箭头当且仅当 $x \leq y$。因此，函子 $F$ 必须确保如果 $x \leq y$ 在 $S$ 中成立，则 $f(x) \leq f(y)$ 在 $T$ 中也成立。

- **保持恒等箭头和复合：** 对于偏序集范畴，恒等映射显然是单调的，且两个单调映射的复合也是单调的。因此，函子 $F$ 自然满足保持恒等箭头和复合箭头的条件。

**结论：** 在偏序集范畴中，函子对应于单调映射。

### 3.1.4 例子：投影函子

**例子 3.1.4：** 在积范畴 $\mathcal{C} \times \mathcal{C}$ 到范畴 $\mathcal{C}$ 的投影函子。

**具体说明：**

- **第一投影函子 $P_1$：**
  
  $$
  P_1 : \mathcal{C} \times \mathcal{C} \rightarrow \mathcal{C}
  $$
  
  - **对象映射：** 对于对象 $(C, D) \in \mathcal{C} \times \mathcal{C}$，有 $P_1(C, D) = C$。
  
  - **箭头映射：** 对于箭头 $(f, g): (C, D) \rightarrow (C', D')$，有 $P_1(f, g) = f$。
  
- **第二投影函子 $P_2$：**
  
  $$
  P_2 : \mathcal{C} \times \mathcal{C} \rightarrow \mathcal{C}
  $$
  
  - **对象映射：** 对于对象 $(C, D) \in \mathcal{C} \times \mathcal{C}$，有 $P_2(C, D) = D$。
  
  - **箭头映射：** 对于箭头 $(f, g): (C, D) \rightarrow (C', D')$，有 $P_2(f, g) = g$。

**性质：**

- **保持恒等箭头：** 对于任意对象 $(C, D)$，有：
  
  $$
  P_1(\text{id}_{(C, D)}) = \text{id}_C \quad \text{和} \quad P_2(\text{id}_{(C, D)}) = \text{id}_D
  $$
  
- **保持复合箭头：** 对于可复合的箭头 $(f, g): (C, D) \rightarrow (C', D')$ 和 $(f', g'): (C', D') \rightarrow (C'', D'')$，有：
  
  $$
  P_1((f', g') \circ (f, g)) = P_1(f' \circ f, g' \circ g) = f' \circ f = P_1(f', g') \circ P_1(f, g)
  $$
  
  同理，$P_2$ 也满足类似性质。

**结论：** 投影函子 $P_1$ 和 $P_2$ 是积范畴到单一范畴的标准函子，分别提取积范畴中对象或箭头的第一或第二坐标。

### 3.1.5 例子：非子范畴的函子

**例子 3.1.5：** 函子的像不必是目标范畴的子范畴。

**具体说明：**

- **范畴 $2 + 2$ 和 $3$：**
  
  - **范畴 $2 + 2$：** 可以描述为包含对象 $0, 1, 10, 2$ 和箭头 $0 \rightarrow 1$ 及 $10 \rightarrow 2$，没有其他非恒等箭头。
  
  - **范畴 $3$：** 可以描述为包含对象 $0, 1, 2$，箭头包括 $0 \rightarrow 1$、$1 \rightarrow 2$ 及它们的复合 $0 \rightarrow 2$。
  
- **定义函子 $F : 2 + 2 \rightarrow 3$：**
  
  - **对象映射：**
    
    $$
    F(0) = 0, \quad F(1) = F(10) = 1, \quad F(2) = 2
    $$
    
  - **箭头映射：**
    
    - $F(0 \rightarrow 1) = 0 \rightarrow 1$
    - $F(10 \rightarrow 2) = 1 \rightarrow 2$
    
    由于 $2 + 2$ 中只有这两条非恒等箭头，函子的箭头映射被确定。
  
- **观察：** 函子的像包括了 $0 \rightarrow 1$ 和 $1 \rightarrow 2$，但不包括 $0 \rightarrow 2$ 的复合箭头。因此，函子 $F$ 的像不是范畴 $3$ 的子范畴，因为缺少了 $0 \rightarrow 2$ 的箭头。

**结论：** 此例展示了函子的像不必是目标范畴的子范畴，即使函子保持了范畴的结构。

### 3.1.6 类别的类别（The Category of Categories）

**定义 3.1.6：** 类别 $\text{Cat}$ 是所有小范畴作为对象，所有函子作为箭头构成的范畴。

**具体说明：**

- **对象：** 所有小范畴（即对象和箭头的集合都是集合）的集合。

- **箭头：** 所有函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，其中 $\mathcal{C}, \mathcal{D}$ 是小范畴。

- **复合：** 函子复合作为箭头的复合，即如果 $F: \mathcal{C} \rightarrow \mathcal{D}$ 和 $G: \mathcal{D} \rightarrow \mathcal{E}$，则复合函子 $G \circ F: \mathcal{C} \rightarrow \mathcal{E}$ 定义为：
  
  $$
  (G \circ F)(C) = G(F(C)) \quad \text{和} \quad (G \circ F)(f) = G(F(f)) \quad \forall f: C \rightarrow C'
  $$
  
- **恒等箭头：** 对于每个小范畴 $\mathcal{C}$，有恒等函子 $\text{Id}_{\mathcal{C}}: \mathcal{C} \rightarrow \mathcal{C}$。

**注意事项：**

- **集合大小问题：** $\text{Cat}$ 包含所有小范畴，因此它本身并不是一个小范畴，而是一个大范畴（large category）。为避免悖论，通常不将 $\text{Cat}$ 视为其自身的对象。

- **别名 $\text{CAT}$：** 有时为了包含所有大范畴，引入一个更广泛的类别 $\text{CAT}$，其中包含所有小范畴和普通的大范畴作为对象，函子作为箭头。不过，这涉及更复杂的基础问题，不在本讨论范围内。

**结论：** 类别的类别 $\text{Cat}$ 是范畴论中一个重要的结构，允许我们在范畴之间进行函子复合和其他操作。

### 3.1.7 例子：子范畴的包含函子

**例子 3.1.7：** 子范畴的包含映射是一个函子。

**具体说明：**

- **子范畴的定义：** 设 $\mathcal{A}$ 是范畴 $\mathcal{B}$ 的一个子范畴，意味着 $\mathcal{A}$ 的对象是 $\mathcal{B}$ 对象的一个子集，且 $\mathcal{A}$ 中的箭头是 $\mathcal{B}$ 中的箭头，满足在 $\mathcal{A}$ 中箭头的复合与恒等箭头与 $\mathcal{B}$ 中相同。

- **包含函子：** 包含函子 $I: \mathcal{A} \rightarrow \mathcal{B}$ 定义为：
  
  - **对象映射：** 对于每个对象 $A \in \mathcal{A}$，有 $I(A) = A$（视为 $\mathcal{B}$ 中的对象）。
  
  - **箭头映射：** 对于每条箭头 $f: A \rightarrow B$ 在 $\mathcal{A}$ 中，有 $I(f) = f$（视为 $\mathcal{B}$ 中的箭头）。
  
- **保持恒等箭头和复合：** 由于 $\mathcal{A}$ 是 $\mathcal{B}$ 的子范畴，包含函子自然满足保持恒等箭头和箭头复合的条件。

**具体例子：**

- **集合范畴 $\text{Set}$ 与其子范畴 $\text{FinSet}$：** $\text{FinSet}$ 是有限集合及其函数的子范畴。包含函子将每个有限集合和函数映射为 $\text{Set}$ 中的对应对象和箭头。

- **图范畴 $\text{Grf}$ 与其子范畴：** 例如，有限图的范畴作为 $\text{Grf}$ 的子范畴，其包含函子将有限图映射为 $\text{Grf}$ 中的对应对象和箭头。

**结论：** 子范畴的包含函子是保持范畴结构的标准函子，通过直接映射子范畴中的对象和箭头到大范畴中。

### 3.1.8 忘却函子（Underlying Functors）

**定义 3.1.8：** **忘却函子**（underlying functor 或 forgetful functor）是将具有更多结构的范畴映射到具有较少结构的范畴的函子，通常通过“忘记”某些结构属性来实现。

**具体说明：**

- **例子 3.1.8：**
  
  1. **单子到半群的忘却函子：**
     
     $$
     U: \text{Mon} \rightarrow \text{Sem}
     $$
     
     - **对象映射：** 对于每个单子 $M$，有 $U(M) = M$（视为半群）。
     
     - **箭头映射：** 对于每个单子同态 $f: M \rightarrow N$，有 $U(f) = f$（视为半群同态）。
     
     - **解释：** 通过忘记单子的单位元，函数保持了半群结构。
  
  2. **半群到集合的忘却函子：**
     
     $$
     U: \text{Sem} \rightarrow \text{Set}
     $$
     
     - **对象映射：** 对于每个半群 $S$，有 $U(S) = S$（视为集合）。
     
     - **箭头映射：** 对于每个半群同态 $f: S \rightarrow T$，有 $U(f) = f$（视为集合函数）。
     
     - **解释：** 通过忘记半群的运算，仅保留集合结构。

**性质：**

- **忠实性（Faithfulness）：** 忘却函子通常是**忠实函子**，即它们在箭头映射上是单射的，这意味着不同的结构保持箭头在目标范畴中也不同。

- **不满射性（Not Full）：** 忘却函子通常不是**全函子**，因为目标范畴中的箭头可能不保留源范畴中的结构。

- **保同构性（Preserves Isomorphisms）：** 忘却函子通常保留同构箭头，即如果 $f$ 在源范畴中是同构箭头，则 $U(f)$ 在目标范畴中也是同构箭头。

**注意事项：**

- **不保持单射和射影：** 忘却函子不一定保持源范畴中的单射或射影性质。例如，某些单射箭头在目标范畴中可能不再是单射。

- **可分离性：** 不同的结构属性可能通过不同的忘却函子被“忘记”，导致不同的函数行为。

**结论：** 忘却函子是连接具有更多结构和较少结构范畴的重要工具，通过“忘记”某些结构属性，实现了结构的简化和转换。

### 3.1.9 例子：图的底层集函子

**例子 3.1.9：** 图有两个底层集合：节点集和箭头集。因此，存在多个底层函子将图范畴 $\text{Grf}$ 映射到 $\text{Set} \times \text{Set}$ 或 $\text{Set}$ 中的不同部分。

**具体说明：**

- **底层函子 $U: \text{Grf} \rightarrow \text{Set} \times \text{Set}$：**
  
  $$
  U(G) = (G_0, G_1)
  $$
  
  - **对象映射：** 对于每个图 $G$，$U(G)$ 是其节点集 $G_0$ 和箭头集 $G_1$ 的有序对。
  
  - **箭头映射：** 对于每个图同态 $f: G \rightarrow H$，$U(f)$ 是函数 $(f_0, f_1): (G_0, G_1) \rightarrow (H_0, H_1)$，其中 $f_0$ 和 $f_1$ 分别是节点和箭头的映射。
  
- **箭头集函子 $A: \text{Grf} \rightarrow \text{Set}$：**
  
  $$
  A(G) = G_1
  $$
  
  - **对象映射：** 对于每个图 $G$，$A(G)$ 是其箭头集 $G_1$。
  
  - **箭头映射：** 对于每个图同态 $f: G \rightarrow H$，$A(f)$ 是函数 $f_1: G_1 \rightarrow H_1$。
  
- **节点集函子 $N: \text{Grf} \rightarrow \text{Set}$：**
  
  $$
  N(G) = G_0
  $$
  
  - **对象映射：** 对于每个图 $G$，$N(G)$ 是其节点集 $G_0$。
  
  - **箭头映射：** 对于每个图同态 $f: G \rightarrow H$，$N(f)$ 是函数 $f_0: G_0 \rightarrow H_0$。

**观察：**

- **非单一性：** 不同的底层函子捕捉了图的不同结构部分（节点和箭头），展示了函子在处理复杂结构时的灵活性。

- **非全子范畴：** 这些函子的像不必是目标范畴的子范畴，因为它们仅选择了结构的一部分。

**结论：** 图的底层集函子展示了如何通过不同的函子捕捉结构的不同方面，体现了函子的多样性和灵活性。

### 3.1.10 例子：类别的底层图函子

**例子 3.1.10：** 忘记类别的组合和恒等箭头，仅保留其作为图的结构。

**具体说明：**

- **底层图函子 $U: \text{Cat} \rightarrow \text{Grf}$：**
  
  - **对象映射：** 对于每个类别 $\mathcal{C}$，$U(\mathcal{C})$ 是其底层图，即对象集和箭头集。
  
  - **箭头映射：** 对于每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，$U(F)$ 是对应的图同态，将 $\mathcal{C}$ 的对象和箭头映射到 $\mathcal{D}$ 的对象和箭头。
  
- **节点集函子 $O: \text{Cat} \rightarrow \text{Set}$：**
  
  $$
  O(\mathcal{C}) = \text{Ob}(\mathcal{C})
  $$
  
  - **对象映射：** 对于每个类别 $\mathcal{C}$，$O(\mathcal{C})$ 是其对象集。
  
  - **箭头映射：** 对于每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，$O(F)$ 是函数 $F_0: \text{Ob}(\mathcal{C}) \rightarrow \text{Ob}(\mathcal{D})$。
  
- **箭头集函子 $A: \text{Cat} \rightarrow \text{Set}$：**
  
  $$
  A(\mathcal{C}) = \text{Hom}(\mathcal{C})
  $$
  
  - **对象映射：** 对于每个类别 $\mathcal{C}$，$A(\mathcal{C})$ 是其箭头集。
  
  - **箭头映射：** 对于每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，$A(F)$ 是函数 $F_1: \text{Hom}(\mathcal{C}) \rightarrow \text{Hom}(\mathcal{D})$。

**观察：**

- **结构丧失：** 通过底层图函子，仅保留了类别的对象和箭头的映射，丢失了箭头的复合和恒等结构。

- **函子的单向性：** $U$ 是一个函子，但不是逆函子，因为它不能恢复类别的复合结构。

**结论：** 类别的底层图函子展示了函子如何通过忽略某些结构属性，实现结构的简化和转换。

### 3.1.11 例子：切片范畴的底层函子

**例子 3.1.11：** 切片范畴的底层函子。

**具体说明：**

- **切片范畴 $\mathcal{C}/A$：**
  
  - **定义：** 对于给定范畴 $\mathcal{C}$ 和对象 $A \in \mathcal{C}$，切片范畴 $\mathcal{C}/A$ 的对象是范畴 $\mathcal{C}$ 中的箭头 $f: B \rightarrow A$。
  
  - **箭头：** $\mathcal{C}/A$ 中的箭头从 $f: B \rightarrow A$ 到 $g: C \rightarrow A$ 是 $\mathcal{C}$ 中的箭头 $h: B \rightarrow C$，满足：
    
    $$
    g \circ h = f
    $$
  
- **底层函子 $U: \mathcal{C}/A \rightarrow \mathcal{C}$：**
  
  - **对象映射：** 对于每个对象 $f: B \rightarrow A$ 在 $\mathcal{C}/A$ 中，有 $U(f) = B$。
  
  - **箭头映射：** 对于每个箭头 $h: B \rightarrow C$ 在 $\mathcal{C}/A$ 中，有 $U(h) = h$。
  
- **解释：**
  
  - **对象映射：** 函子 $U$ 将切片范畴中的箭头对象映射为源对象。
  
  - **箭头映射：** 函子 $U$ 将切片范畴中的箭头 $h$ 映射为 $\mathcal{C}$ 中的箭头 $h$ 本身。

**具体例子：**

- **集合范畴 $\text{Set}/S$：** 切片范畴中的对象是集合映射 $f: T \rightarrow S$，函子 $U$ 将 $f$ 映射为其源集合 $T$，箭头 $h: T \rightarrow U(T') = T'$ 满足 $f' \circ h = f$。

**结论：** 切片范畴的底层函子通过映射切片范畴中的箭头对象到源对象，实现了切片范畴与原范畴之间的结构保持关系。

---

## 总结

本节 **3.1 Functors（函子）** 详细介绍了函子的正式定义、具体例子及其在不同范畴中的应用。函子作为范畴之间的结构保持映射，是范畴论中的基础工具，具有以下关键特性和应用：

**关键点回顾：**

1. **函子的定义与结构保持：**
   - 函子由对象映射和箭头映射组成，且必须保持恒等箭头和箭头的复合关系。
   
2. **具体例子：**
   - **单子同态作为函子：** 单子同态可以自然地视为单子范畴之间的函子。
   - **偏序集中的单调映射：** 在偏序集范畴中，函子对应于单调映射。
   - **投影函子：** 在积范畴中，投影函子提取对象或箭头的特定坐标。
   - **非子范畴的函子：** 函子的像不必是目标范畴的子范畴，展示了函子的灵活性。
   - **类别的类别：** $\text{Cat}$ 是一个重要的范畴，包含所有小范畴和函子。
   - **子范畴的包含函子：** 子范畴的包含函子是保持范畴结构的标准函子。
   - **忘却函子：** 通过“忘记”某些结构属性，实现结构的简化和转换。
   - **图的底层集函子：** 函子可以捕捉复杂结构的不同方面。
   - **类别的底层图函子：** 忘记类别的组合和恒等箭头，仅保留图结构。
   - **切片范畴的底层函子：** 将切片范畴中的箭头对象映射为源对象。

3. **函子的性质：**
   - **全函子与满函子：** 描述函子在箭头映射上的覆盖性和区分性。
   - **自然同构函子与伴随函子：** 展示函子之间的高级关系和互补性。

4. **应用与重要性：**
   - **连接不同范畴：** 函子作为桥梁，连接不同的数学结构和理论。
   - **范畴的描述与转换：** 通过函子，可以在不同的数学背景下进行转换而不丢失信息。
   - **结构保持：** 函子确保了范畴结构的完整性，使得在范畴之间的映射是有意义的。

5. **习题的应用：**
   - **验证函子的性质：** 通过习题，实践如何构造和验证函子，理解函子的高级性质。
   - **理解范畴的等价性与商范畴：** 通过习题，掌握等价范畴和商范畴的构造方法和应用。

**进一步学习建议：**

- **自然变换与同伦论：** 自然变换是函子之间的重要关系，深入理解自然变换有助于掌握更高级的范畴论概念。
  
- **伴随函子的应用：** 伴随函子在许多数学领域中具有重要应用，尤其是在代数和拓扑学中。
  
- **高阶范畴论：** 探索更高阶的范畴，如2-范畴（2-categories）和∞-范畴（∞-categories），扩展对范畴论的理解。

通过对函子及其相关概念的深入学习，您将能够更好地理解范畴论的抽象框架及其在数学和计算机科学中的广泛应用。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ----------------------------

好的，让我们继续详细解析您提供的章节 **3.1 Functors（函子）**。本节将深入探讨函子的更多例子、性质以及一些重要的函子概念，如自由函子、幂集函子、Hom函子等。此外，还将介绍相关的命题和习题，帮助您更好地理解和应用函子的概念。

---

## 3.1 Functors（函子）

函子是范畴论中的核心概念之一，它将一个范畴的结构映射到另一个范畴，同时保持范畴的基本结构（即对象和箭头之间的关系）。函子在数学中扮演着桥梁的角色，连接不同的数学结构和理论。

### 3.1.12 自由函子（Free Functors）

**定义 3.1.12：** 自由函子是一类特殊的函子，通常用于将某种结构映射到另一种结构，同时保持某些“自由性”。一个典型的例子是从集合范畴 $\text{Set}$ 到单子范畴 $\text{Mon}$ 的自由单子函子。

**具体例子：自由单子函子**

- **函子定义：**
  
  $$
  F: \text{Set} \rightarrow \text{Mon}
  $$
  
  - **对象映射：** 对每个集合 $A$，$F(A)$ 是集合 $A$ 的自由单子，记作 $F(A) = A^*$，即 Kleene 闭包，包含所有有限长度的 $A$ 上的字符串（包括空字符串），并以字符串连接作为运算。
  
  - **箭头映射：** 对每个函数 $f: A \rightarrow B$，$F(f) = f^* : F(A) \rightarrow F(B)$ 是由 $f$ 唯一确定的单子同态，其作用方式为：
    
    $$
    f^*(a_1a_2 \cdots a_n) = f(a_1)f(a_2) \cdots f(a_n)
    $$
    
    其中 $a_i \in A$。

- **函子性质验证：**
  
  1. **保持恒等箭头：** 对于每个集合 $A$，有：
     
     $$
     F(\text{id}_A) = (\text{id}_A)^* = \text{id}_{A^*}
     $$
     
     因为恒等函数作用于字符串时保持字符串不变，故 $(\text{id}_A)^*$ 是自由单子 $A^*$ 上的恒等同态。
  
  2. **保持复合箭头：** 对于任意两个函数 $f: A \rightarrow B$ 和 $g: B \rightarrow C$，有：
     
     $$
     F(g \circ f) = (g \circ f)^* = g^* \circ f^*
     $$
     
     因为：
     
     $$
     (g \circ f)^*(a_1a_2 \cdots a_n) = g(f(a_1))g(f(a_2)) \cdots g(f(a_n)) = (g^* \circ f^*)(a_1a_2 \cdots a_n)
     $$
     
     所以，$F(g \circ f) = F(g) \circ F(f)$。

**结论：** 自由单子函子 $F: \text{Set} \rightarrow \text{Mon}$ 确实是一个函子，因为它满足保持恒等箭头和复合箭头的条件。

**进一步说明：**

- **Kleene 闭包 $A^*$：** 由所有有限长度的 $A$ 上的字符串组成，包括空字符串 $\epsilon$，其运算为字符串连接。自由单子的性质确保了 $A^*$ 是生成 $A$ 的“最自由”的单子。

- **复合函子的自明性：** 因为函数复合在映射到单子同态后对应于单子同态的复合，所以自由单子函子自然满足保持复合的条件。

### 3.1.13 例子：自由类别函子（Free Category Functor）

**例子 3.1.13：** 自由类别函子将一个图映射到其自由生成的类别。这展示了函子如何在不同范畴之间传递和生成结构。

**具体说明：**

- **自由类别函子 $F: \text{Grf} \rightarrow \text{Cat}$：**
  
  - **对象映射：** 对于每个图 $G$，$F(G)$ 是由 $G$ 生成的自由类别。自由类别的对象是图 $G$ 的节点，箭头是图 $G$ 中的路径（包括空路径作为恒等箭头）。
  
  - **箭头映射：** 对于每个图同态 $\phi: G \rightarrow H$，$F(\phi)$ 是一个函数，将 $F(G)$ 的对象和箭头映射到 $F(H)$ 的对象和箭头。具体来说：
    
    - **对象映射：** $F(\phi)_0 = \phi_0$，即将 $G$ 的节点映射到 $H$ 的节点。
    
    - **箭头映射：** 对于每个路径 $(f_n, f_{n-1}, \ldots, f_1)$ 在 $F(G)$ 中，定义：
      
      $$
      F(\phi)_1(f_n, f_{n-1}, \ldots, f_1) = (\phi_1(f_n), \phi_1(f_{n-1}), \ldots, \phi_1(f_1))
      $$
      
      这确保了路径的复合在函子作用下对应于路径复合后的映射。

- **保持恒等箭头和复合：**
  
  - **恒等箭头：** 空路径 $()$ 在自由类别中对应于恒等箭头，因此 $F(\phi)_1(()) = ()$，即 $\text{id}$ 被映射为 $\text{id}$。
  
  - **箭头复合：** 函子 $F$ 保持路径的复合，即：
    
    $$
    F(\phi)((g_n, \ldots, g_1) \circ (f_m, \ldots, f_1)) = F(\phi)(g_n, \ldots, g_1, f_m, \ldots, f_1) = (\phi(g_n), \ldots, \phi(g_1), \phi(f_m), \ldots, \phi(f_1))
    $$
    
    而：
    
    $$
    F(\phi)(g_n, \ldots, g_1) \circ F(\phi)(f_m, \ldots, f_1) = (\phi(g_n), \ldots, \phi(g_1)) \circ (\phi(f_m), \ldots, \phi(f_1)) = (\phi(g_n), \ldots, \phi(g_1), \phi(f_m), \ldots, \phi(f_1))
    $$
    
    因此，$F(\phi \circ \phi') = F(\phi) \circ F(\phi')$。

**结论：** 自由类别函子 $F: \text{Grf} \rightarrow \text{Cat}$ 是一个函子，因为它满足保持恒等箭头和复合箭头的条件。

### 3.1.14 映射提升性质（Map-Lifting Property）

**定义 3.1.14：** 自由类别函子 $F: \text{Grf} \rightarrow \text{Cat}$ 和其他自由函子（如自由单子函子）具有一种称为**映射提升性质**的特性，这一性质也被称为其**普遍映射性质**（universal mapping property）。这将在后续章节中作为自由性的定义属性进行详细讨论。

**具体说明：**

- **自由类别函子 $F: \text{Grf} \rightarrow \text{Cat}$：**
  
  - **包含映射 $\eta_G: G \rightarrow U(F(G))$：** 其中 $U: \text{Cat} \rightarrow \text{Grf}$ 是自由类别的底层图函子。对于每个图 $G$，$\eta_G$ 将 $G$ 映射到其自由类别 $F(G)$ 的底层图中。
    
    - **对象部分：** $\eta_G$ 在对象上的映射是恒等的，因为 $F(G)$ 的对象与 $G$ 的节点相同。
    
    - **箭头部分：** 对于每个图中的箭头 $f \in G_1$，$\eta_G(f)$ 是自由类别中对应的长度为一的路径 $(f)$。

- **映射提升性质：**
  
  - **命题 3.1.15：** 设 $G$ 是一个图，$C$ 是一个类别，且 $h: G \rightarrow U(C)$ 是一个图同态。则存在一个唯一的函子 $\beta h: F(G) \rightarrow C$，使得：
    
    $$
    U(\beta h) \circ \eta_G = h
    $$
  
  - **解释：** 映射提升性质保证了任何从图到类别底层图的同态都可以唯一地提升为一个从自由类别到目标类别的函子。这是自由函子的一个重要特性，体现了其普遍映射性质。

**结论：** 自由类别函子 $F: \text{Grf} \rightarrow \text{Cat}$ 通过映射提升性质，将图同态唯一地扩展为类别间的函子，体现了自由性的核心理念。

### 3.1.15 命题：映射提升性质的证明

**命题 3.1.15：** 设 $G$ 是一个图，$C$ 是一个类别。对于每个图同态 $h: G \rightarrow U(C)$，存在唯一的函子 $\beta h: F(G) \rightarrow C$，使得：

$$
U(\beta h) \circ \eta_G = h
$$

**证明：**

- **对象映射：** 对于每个对象 $a \in G_0$，有：
  
  $$
  \beta h(a) = h(a)
  $$
  
  因为 $h$ 在对象上的映射是恒等的，$\beta h$ 也应当在对象上映射为相同的对象。

- **箭头映射：** 对于每个路径 $p = (f_n, f_{n-1}, \ldots, f_1)$ 在 $F(G)$ 中，定义：
  
  $$
  \beta h(p) = h(f_n) \circ h(f_{n-1}) \circ \cdots \circ h(f_1)
  $$
  
  这确保了 $\beta h$ 在箭头复合上的保持性。

- **验证函子的条件：**
  
  1. **保持恒等箭头：** 空路径 $()$ 在 $F(G)$ 中对应于恒等箭头 $\text{id}_a$，有：
     
     $$
     \beta h(()) = \text{id}_{h(a)} = \text{id}_{\beta h(a)}
     $$
  
  2. **保持复合箭头：** 对于任意两条可复合路径 $p$ 和 $q$，有：
     
     $$
     \beta h(q \circ p) = \beta h(q \circ p) = \beta h(q) \circ \beta h(p) = (\text{composed arrows in } C)
     $$
     
     这与自由类别中的箭头复合一致。

- **唯一性：** 假设存在另一个函子 $\beta' h: F(G) \rightarrow C$ 也满足 $U(\beta' h) \circ \eta_G = h$。对于任意路径 $p$，有：
  
  $$
  \beta' h(p) = \beta h(p)
  $$
  
  因此，$\beta' h = \beta h$，证明了唯一性。

**结论：** 映射提升性质得证，即每个图同态 $h: G \rightarrow U(C)$ 唯一地对应一个函子 $\beta h: F(G) \rightarrow C$。

### 3.1.16 幂集函子（Powerset Functors）

**定义 3.1.16：** 对于任意集合 $S$，其幂集 $P(S)$ 是所有 $S$ 的子集的集合。存在三种不同的函子 $F$ 使得 $F_0(S) = P(S)$；它们在箭头映射上的定义不同。其中一种在托普斯理论（topos theory）中非常重要，被称为**幂集函子**（powerset functor）。

**具体说明：**

- **逆像函子：**
  
  - **定义：** 对于每个函数 $f: A \rightarrow B$，逆像函数 $f^{-1}: P(B) \rightarrow P(A)$ 定义为：
    
    $$
    f^{-1}(C) = \{ a \in A \mid f(a) \in C \}
    $$
    
    即，$C$ 的逆像是所有被 $f$ 映射到 $C$ 中元素的 $A$ 的元素的集合。

  - **性质：** 如果 $f$ 是双射，则 $f^{-1}$ 也可以表示为双射的逆函数。

- **正像函子（存在像函子）：**
  
  - **定义：** 对于每个函数 $f: A \rightarrow B$，正像函数 $f^*: P(A) \rightarrow P(B)$ 定义为：
    
    $$
    f^*(C) = \{ f(x) \mid x \in C \}
    $$
    
    即，$C$ 的正像是通过 $f$ 映射后的 $C$ 中元素的集合。

- **普遍像函子（Universal Image Functor）：**
  
  - **定义：** 对于每个函数 $f: A \rightarrow B$，普遍像函数 $f!: P(A) \rightarrow P(B)$ 定义为：
    
    $$
    f!(C) = \{ y \in B \mid \forall x \in A, (f(x) = y \Rightarrow x \in C) \}
    $$
    
    即，$f!(C)$ 包含所有 $B$ 中的元素 $y$，如果 $y$ 的任何前像都属于 $C$，则 $y$ 被包含在 $f!(C)$ 中。

**结论：** 这些不同的幂集函子在不同的数学背景下具有不同的用途和性质，尤其是在逻辑和拓扑学中发挥重要作用。

### 3.1.17 定义：幂集函子

**定义 3.1.17：** 幂集函子 $P: \text{Set}^{\text{op}} \rightarrow \text{Set}$ 定义如下：

- **对象映射：** 对于每个集合 $S$，有 $P(S)$ 是 $S$ 的幂集，即所有子集的集合。
  
- **箭头映射：** 对于每个函数 $f: A \rightarrow B$（视为 $\text{Set}^{\text{op}}$ 中从 $B$ 到 $A$ 的箭头），有：
  
  $$
  P(f) = f^{-1}: P(B) \rightarrow P(A)
  $$
  
  其中 $f^{-1}(C) = \{ a \in A \mid f(a) \in C \}$。

**说明：**

- **保持恒等箭头：** 对于每个集合 $A$，有：
  
  $$
  P(\text{id}_A) = (\text{id}_A)^{-1} = \text{id}_{P(A)}
  $$
  
- **保持复合箭头：** 对于任意两个函数 $f: A \rightarrow B$ 和 $g: B \rightarrow C$，有：
  
  $$
  P(g \circ f) = (g \circ f)^{-1} = f^{-1} \circ g^{-1} = P(f) \circ P(g)
  $$
  
  这与函子保持箭头复合的条件一致。

**符号注意：** 在范畴论的文献中，逆像函数通常用 $f^*$ 表示，但这里我们继续使用 $f^{-1}$ 的符号表示。

**结论：** 幂集函子 $P: \text{Set}^{\text{op}} \rightarrow \text{Set}$ 是一个函子，因为它满足保持恒等箭头和复合箭头的条件。

### 3.1.18 反函子（Contravariant Functors）

**定义 3.1.18：** 一个函子 $F: \mathcal{C}^{\text{op}} \rightarrow \mathcal{D}$ 被称为**反函子**（contravariant functor）。反函子可以看作是从范畴 $\mathcal{C}$ 到范畴 $\mathcal{D}$ 的函子，但它在箭头映射上“反向”。

**具体说明：**

- **对象映射：** 对于每个对象 $A \in \mathcal{C}$，有 $F(A) \in \mathcal{D}$。
  
- **箭头映射：** 对于每个箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$，有 $F(f): F(B) \rightarrow F(A)$ 在 $\mathcal{D}$。
  
- **保持恒等箭头和复合：**
  
  - 对于每个对象 $A \in \mathcal{C}$，有：
    
    $$
    F(\text{id}_A) = \text{id}_{F(A)}
    $$
  
  - 对于任意两条可复合箭头 $f: A \rightarrow B$ 和 $g: B \rightarrow C$ 在 $\mathcal{C}$，有：
    
    $$
    F(g \circ f) = F(f) \circ F(g)
    $$
    
    这意味着反函子在箭头复合上是反向的。

**解释：**

- **对偶范畴的应用：** 反函子 $F: \mathcal{C}^{\text{op}} \rightarrow \mathcal{D}$ 可以视为从范畴 $\mathcal{C}$ 到范畴 $\mathcal{D}$ 的函子，但在箭头映射时将方向反转。这使得反函子可以描述诸如共变与逆变的关系。

**结论：** 反函子是一类特殊的函子，通过对偶范畴的构造，实现了箭头方向的反转，广泛应用于各种数学理论中。

### 3.1.19 其他幂集函子（Other Powerset Functors）

**定义 3.1.19：** 除了逆像函子 $P: \text{Set}^{\text{op}} \rightarrow \text{Set}$，还有两种协变的幂集函子：

1. **存在像函子（Existential Image Functor）：**
   
   - **定义：** 对于每个函数 $f: A \rightarrow B$，存在像函子 $f^*: P(A) \rightarrow P(B)$ 定义为：
     
     $$
     f^*(C) = \{ f(x) \mid x \in C \}
     $$
   
   - **性质：** $f^*$ 将 $A$ 的子集映射为 $B$ 的子集，是一个协变函子。

2. **普遍像函子（Universal Image Functor）：**
   
   - **定义：** 对于每个函数 $f: A \rightarrow B$，普遍像函子 $f!: P(A) \rightarrow P(B)$ 定义为：
     
     $$
     f!(C) = \{ y \in B \mid f^{-1}(\{ y \}) \subseteq C \}
     $$
     
     即，$y \in B$ 当且仅当所有被 $f$ 映射到 $y$ 的 $A$ 的元素都属于 $C$ 时，$y$ 被包含在 $f!(C)$ 中。
   
   - **性质：** $f!$ 也是一个协变函子，其作用方式与 $f^*$ 不同，体现了对 $C$ 的严格限制。

**结论：** 存在像函子和普遍像函子是幂集函子的重要变种，它们在不同的数学理论中有着不同的应用，尤其是在逻辑和拓扑学中。

### 3.1.20 Hom函子（Hom Functors）

**定义 3.1.20：** 设 $\mathcal{C}$ 是一个范畴，且 $C$ 是 $\mathcal{C}$ 中的一个固定对象。对于任意对象 $A \in \mathcal{C}$，$\text{Hom}(C, A)$ 表示从 $C$ 到 $A$ 的所有箭头的集合。我们可以将这种映射构造成一个函子。

**具体说明：**

- **协变 Hom函子 $\text{Hom}(C, -): \mathcal{C} \rightarrow \text{Set}$：**
  
  - **对象映射：** 对于每个对象 $A \in \mathcal{C}$，有：
    
    $$
    \text{Hom}(C, -)(A) = \text{Hom}(C, A)
    $$
  
  - **箭头映射：** 对于每条箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$，有：
    
    $$
    \text{Hom}(C, -)(f) = \text{Hom}(C, f): \text{Hom}(C, A) \rightarrow \text{Hom}(C, B)
    $$
    
    其中 $\text{Hom}(C, f)(g) = f \circ g$ 对于 $g: C \rightarrow A$。

- **性质验证：**
  
  1. **保持恒等箭头：** 对于每个对象 $A \in \mathcal{C}$，有：
     
     $$
     \text{Hom}(C, -)(\text{id}_A)(g) = \text{id}_A \circ g = g
     $$
     
     因此，$\text{Hom}(C, -)(\text{id}_A) = \text{id}_{\text{Hom}(C, A)}$。
  
  2. **保持复合箭头：** 对于任意两条可复合箭头 $f: A \rightarrow B$ 和 $g: B \rightarrow D$，有：
     
     $$
     \text{Hom}(C, -)(g \circ f)(h) = (g \circ f) \circ h = g \circ (f \circ h) = \text{Hom}(C, g)(\text{Hom}(C, f)(h))
     $$
     
     因此，$\text{Hom}(C, -)(g \circ f) = \text{Hom}(C, g) \circ \text{Hom}(C, f)$。

**结论：** $\text{Hom}(C, -): \mathcal{C} \rightarrow \text{Set}$ 是一个协变函子，因为它满足保持恒等箭头和复合箭头的条件。

**进一步说明：**

- **变元参数化：** $C$ 是一个固定对象，因此 $\text{Hom}(C, -)$ 函子依赖于 $\mathcal{C}$ 中其他对象和箭头的变化。

- **类似函数：** 这个函子类似于在集合论中将函数作用于集合的方式，但在范畴论中，它作用于箭头的复合。

### 3.1.21 定义：反协变 Hom函子（Contravariant Hom Functors）

**定义 3.1.21：** 对于给定的对象 $D \in \mathcal{C}$，**反协变 Hom函子** $\text{Hom}(-, D): \mathcal{C}^{\text{op}} \rightarrow \text{Set}$ 定义如下：

- **对象映射：** 对于每个对象 $A \in \mathcal{C}$，有：
  
  $$
  \text{Hom}(-, D)(A) = \text{Hom}(A, D)
  $$
  
- **箭头映射：** 对于每条箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$（视为 $\mathcal{C}^{\text{op}}$ 中从 $B$ 到 $A$ 的箭头），有：
  
  $$
  \text{Hom}(-, D)(f) = \text{Hom}(f, D): \text{Hom}(B, D) \rightarrow \text{Hom}(A, D)
  $$
  
  其中 $\text{Hom}(f, D)(g) = g \circ f$ 对于 $g: B \rightarrow D$。

**解释：**

- **反向映射：** 反协变 Hom函子通过反转箭头的方向，实现了箭头映射的反向性。
  
- **保持结构：** 尽管箭头方向反转，但函子仍然保持了恒等箭头和箭头的复合关系。

**结论：** 反协变 Hom函子 $\text{Hom}(-, D): \mathcal{C}^{\text{op}} \rightarrow \text{Set}$ 是一个函子，因为它满足保持恒等箭头和复合箭头的条件。

### 3.1.22 定义：双变量 Hom函子（Two-Variable Hom Functor）

**定义 3.1.22：** **双变量 Hom函子** $\text{Hom}(-, -): \mathcal{C}^{\text{op}} \times \mathcal{C} \rightarrow \text{Set}$ 定义如下：

- **对象映射：** 对于每对对象 $(C, D) \in \mathcal{C}^{\text{op}} \times \mathcal{C}$，有：
  
  $$
  \text{Hom}(-, -)(C, D) = \text{Hom}(C, D)
  $$
  
- **箭头映射：** 对于每对箭头 $(f, g)$ ，其中 $f: C' \rightarrow C$ 在 $\mathcal{C}^{\text{op}}$（即 $f: C \rightarrow C'$ 在 $\mathcal{C}$），和 $g: D \rightarrow D'$ 在 $\mathcal{C}$，有：
  
  $$
  \text{Hom}(-, -)(f, g): \text{Hom}(C, D) \rightarrow \text{Hom}(C', D')
  $$
  
  定义为：
  
  $$
  \text{Hom}(-, -)(f, g)(h) = g \circ h \circ f
  $$
  
  其中 $h: C \rightarrow D$。

**解释：**

- **多变量函子：** 双变量 Hom函子是通过积范畴 $\mathcal{C}^{\text{op}} \times \mathcal{C}$ 来定义的，它允许函子同时依赖于两个对象和两个箭头。
  
- **保持结构：** 双变量 Hom函子通过在每个变量上分别应用箭头的映射，确保了复合箭头的保持性。

**结论：** 双变量 Hom函子 $\text{Hom}(-, -): \mathcal{C}^{\text{op}} \times \mathcal{C} \rightarrow \text{Set}$ 是一个函子，因为它满足保持恒等箭头和复合箭头的条件。

**进一步说明：**

- **产品范畴的应用：** 利用积范畴的概念，双变量 Hom函子能够在单一的函子框架下处理多个变量，类似于多元函数在集合论中的作用。

- **自然变换的基础：** 双变量 Hom函子为自然变换和范畴间的高级结构提供了基础。

### 3.1.23 习题（Exercises）

以下是一些习题，帮助您巩固对函子及其相关概念的理解和应用：

1. **习题1：函子定义中的箭头定义条件的省略**
   
   - **题目：** 在函子的定义中，证明“F₁(g) ◦ F₁(f) 是在 $\mathcal{D}$ 中定义的”这一条件可以省略。
   
   - **提示：** 考虑范畴中的箭头复合的存在性，以及函子保持复合的条件。

2. **习题2：初始和终端对象在范畴中的性质**
   
   - **题目：** 描述在范畴 $\text{Cat}$ 中的初始对象和终端对象。
   
   - **提示：** 考虑范畴间函子的特殊形式，如空范畴和单一对象的范畴。

3. **习题3：存在像函子和普遍像函子是函子**
   
   - **题目：** 证明 **3.1.19** 中的存在像函子和普遍像函子确实是函子。
   
   - **提示：** 验证它们保持恒等箭头和复合箭头的条件。

4. **习题4：函子在范畴中的单射性**
   
   - **题目：** 
     a. 证明一个函子在范畴 $\text{Cat}$ 中是单射函子当且仅当它在对象和箭头上都是单射的。
     b. 证明在 **3.1.8** 中描述的函子 $U: \text{Mon} \rightarrow \text{Sem}$ 是一个单射函子。
   
   - **提示：** 利用函子在对象和箭头映射上的单射性，以及单射函子的定义。

5. **习题5：构造和验证一个函子**
   
   - **题目：** 给定一个半群 $S$，构造一个单子 $M = S \cup \{e\}$，其中 $e$ 是一个新的元素，满足 $e \cdot s = s \cdot e = s$ 对所有 $s \in S$ 成立。定义函子 $F: \text{Sem} \rightarrow \text{Mon}$ 使得：
     a. $F(S) = S_1$（按照上述构造）。
     b. 对每个半群同态 $f: S \rightarrow T$，定义 $F(f): S_1 \rightarrow T_1$ 为 $f$ 在 $S$ 上的作用，并将 $e_S$ 映射为 $e_T$。
     c. 证明 $F$ 是一个函子，并且是单射函子。
   
   - **提示：** 验证函子定义的保持恒等和复合条件。

6. **习题6：证明一个自然同构的双射性**
   
   - **题目：** 设 $U: \text{Mon} \rightarrow \text{Set}$ 是忘却函子，$F: \text{Set} \rightarrow \text{Mon}$ 是自由单子函子。对于每个集合 $A$ 和单子 $M$，构造一个双射：
     
     $$
     \beta: \text{Hom}_{\text{Set}}(A, U(M)) \rightarrow \text{Hom}_{\text{Mon}}(F(A), M)
     $$
     
     其中 $\beta(f)(a_1a_2 \cdots a_n) = f(a_1)f(a_2) \cdots f(a_n)$。
   
   - **提示：** 验证 $\beta$ 的单射性和满射性。

7. **习题7：验证另一个双射性的构造**
   
   - **题目：** 设 $U: \text{Mon} \rightarrow \text{Sem}$ 是函子，$F: \text{Sem} \rightarrow \text{Mon}$ 是函子如习题5所构造。定义一个函数：
     
     $$
     \gamma: \text{Hom}_{\text{Sem}}(S, U(M)) \rightarrow \text{Hom}_{\text{Mon}}(F(S), M)
     $$
     
     其中 $\gamma(h)(s) = h(s)$ 对于 $s \in S$，且 $\gamma(h)(e_S) = 1$（$1$ 是 $M$ 的单位元）。证明 $\gamma$ 的值域是 $\text{Hom}_{\text{Mon}}(F(S), M)$ 且 $\gamma$ 是双射。
   
   - **提示：** 类比习题6，利用函子和自由结构的特性。

8. **习题8：相互为子范畴**
   
   - **题目：** 证明单子范畴 $\text{Mon}$ 和半群范畴 $\text{Sem}$ 是彼此的子范畴。
   
   - **提示：** 构造包含函子并验证子范畴的定义条件。

9. **习题9：集合范畴与部分函数范畴的子范畴关系**
   
   - **题目：** 证明集合范畴 $\text{Set}$ 和部分函数范畴 $\text{Pfn}$ 是彼此的子范畴。提示：构造一个单射函子从 $\text{Pfn}$ 到 $\text{Set}$，如将每个集合 $A$ 映射到 $A \cup \{A\}$，将每个部分函数 $f: A \rightarrow B$ 映射为全函数 $f_0: A \cup \{A\} \rightarrow B \cup \{A\}$，其中：
     
     $$
     f_0(x) = \begin{cases}
     f(x) & \text{如果 } x \in A \text{ 且 } f(x) \text{ 定义} \\
     B & \text{否则}
     \end{cases}
     $$
     $$
   
   - **提示：** 利用函子保持箭头复合和恒等箭头的性质。

10. **习题10：离散范畴和不离散范畴的特性**
    
    - **题目：** 
      a. 证明：一个范畴 $\mathcal{A}$ 是**离散的**（discrete），当且仅当对于任何集合函数 $F: \mathcal{A}_0 \rightarrow \mathcal{B}_0$，其中 $\mathcal{B}$ 是任意范畴，$F$ 是一个唯一的函子。
      
      b. 定义：一个范畴 $\mathcal{B}$ 是**不离散的**（indiscrete），当且仅当对于任何集合函数 $F: \mathcal{A}_0 \rightarrow \mathcal{B}_0$，其中 $\mathcal{A}$ 是任意范畴，$F$ 是一个唯一的函子。
    
    - **提示：** 利用离散范畴和不离散范畴在箭头上的特殊性质，验证函子的唯一性。

---

## 总结

本节 **3.1 Functors（函子）** 深入探讨了函子的正式定义、具体例子及其在不同范畴中的应用。函子作为范畴之间的结构保持映射，是范畴论中的基础工具，具有以下关键特性和应用：

**关键点回顾：**

1. **函子的定义与结构保持：**
   - 函子由对象映射和箭头映射组成，且必须保持恒等箭头和箭头的复合关系。

2. **具体例子：**
   - **单子同态作为函子：** 单子同态可以自然地视为单子范畴之间的函子。
   - **偏序集中的单调映射：** 在偏序集范畴中，函子对应于单调映射。
   - **投影函子：** 在积范畴中，投影函子提取对象或箭头的特定坐标。
   - **非子范畴的函子：** 函子的像不必是目标范畴的子范畴，展示了函子的灵活性。
   - **类别的类别：** $\text{Cat}$ 是一个重要的范畴，包含所有小范畴和函子。
   - **子范畴的包含函子：** 子范畴的包含函子是保持范畴结构的标准函子。
   - **忘却函子：** 通过“忘记”某些结构属性，实现结构的简化和转换。
   - **图的底层集函子：** 函子可以捕捉复杂结构的不同方面。
   - **类别的底层图函子：** 忘记类别的组合和恒等箭头，仅保留图结构。
   - **切片范畴的底层函子：** 将切片范畴中的箭头对象映射为源对象。
   - **自由函子和映射提升性质：** 自由函子通过映射提升性质，将结构映射到目标范畴，并保持结构的自由性。

3. **函子的性质：**
   - **全函子与满函子：** 描述函子在箭头映射上的覆盖性和区分性。
   - **自然同构函子与伴随函子：** 展示函子之间的高级关系和互补性。

4. **应用与重要性：**
   - **连接不同范畴：** 函子作为桥梁，连接不同的数学结构和理论。
   - **范畴的描述与转换：** 通过函子，可以在不同的数学背景下进行转换而不丢失信息。
   - **结构保持：** 函子确保了范畴结构的完整性，使得在范畴之间的映射是有意义的。

5. **习题的应用：**
   - **验证函子的性质：** 通过习题，实践如何构造和验证函子，理解函子的高级性质。
   - **理解范畴的等价性与商范畴：** 通过习题，掌握等价范畴和商范畴的构造方法和应用。

**进一步学习建议：**

- **自然变换与同伦论：** 自然变换是函子之间的重要关系，深入理解自然变换有助于掌握更高级的范畴论概念。
  
- **伴随函子的应用：** 伴随函子在许多数学领域中具有重要应用，尤其是在代数和拓扑学中。
  
- **高阶范畴论：** 探索更高阶的范畴，如2-范畴（2-categories）和∞-范畴（∞-categories），扩展对范畴论的理解。

通过对函子及其相关概念的深入学习，您将能够更好地理解范畴论的抽象框架及其在数学和计算机科学中的广泛应用。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ---------------------------

好的，让我们继续详细解析您提供的章节 **3.2 Actions（作用）**。本节主要探讨**集合值函子**（set-valued functors）作为**有限状态机**（finite state machines）的自然推广，以及它们在范畴论中的理论重要性，特别是与**Yoneda 引理**（Yoneda Lemma）的关联。我们将逐步解析每个子部分，以帮助您深入理解这些概念及其应用。

---

## 3.2 Actions（作用）

在本节中，我们将讨论**集合值函子**，它们作为有限状态机的自然推广，具有重要的理论意义。虽然本节内容主要在第12章和一些零散的例子中引用，但它们在范畴论中通过Yoneda引理（第4.5节）具有重要的理论价值。

### 3.2.1 单子作用（Monoid Actions）

**定义 3.2.1：** 设 $M$ 是一个单子（monoid），具有单位元 $1$，$S$ 是一个集合。**$M$ 在 $S$ 上的作用**是一个函数：

$$
\alpha : M \times S \rightarrow S
$$

满足以下两个条件：

1. **A–1（单位元作用）：**
   
   对于所有 $s \in S$，有：
   
   $$
   \alpha(1, s) = s
   $$
   
   通常简写为：
   
   $$
   1s = s
   $$

2. **A–2（结合律）：**
   
   对于所有 $m, n \in M$ 和 $s \in S$，有：
   
   $$
   \alpha(mn, s) = \alpha(m, \alpha(n, s))
   $$
   
   简写为：
   
   $$
   (mn)s = m(ns)
   $$

**术语解释：**

- **$M$-集（$M$-Set）：** 当集合 $S$ 上有单子 $M$ 的作用时，称 $S$ 为一个 $M$-集。

- **作用的直观理解：** 可以将集合 $S$ 视为状态空间，单子 $M$ 的元素作为作用，诱导状态之间的转换。

**类比：**

- 类似于**标量乘法**中，标量作用于向量的方式，单子作用于集合中的元素。

### 3.2.2 定义：等变映射（Equivariant Maps）

**定义 3.2.2：** 设 $M$ 是一个单子，在集合 $S$ 和 $T$ 上分别有 $M$ 的作用。**从 $S$ 到 $T$ 的等变映射**是一个函数：

$$
\phi : S \rightarrow T
$$

满足对于所有 $m \in M$ 和 $s \in S$，有：

$$
\phi(ms) = m\phi(s)
$$

**性质：**

- **恒等映射：** 恒等函数 $\text{id}_S : S \rightarrow S$ 是一个等变映射，因为：

  $$
  \text{id}_S(ms) = ms = m\text{id}_S(s)
  $$

- **复合映射：** 两个等变映射的复合仍然是等变映射。设 $\phi: S \rightarrow T$ 和 $\psi: T \rightarrow U$ 为等变映射，则 $\psi \circ \phi : S \rightarrow U$ 也是等变映射：

  $$
  \psi(\phi(ms)) = \psi(m\phi(s)) = m\psi(\phi(s)) = m(\psi \circ \phi)(s)
  $$

**类别 $M\text{-Act}$：**

- **对象：** $M$-集，即具有 $M$ 作用的集合。

- **箭头：** 等变映射。

- **结论：** 对于每个单子 $M$，$M\text{-Act}$ 构成一个范畴，其中对象是 $M$-集，箭头是等变映射。

### 3.2.3 作用作为函子（Actions as Functors）

**定义 3.2.3：** 设 $\alpha$ 是单子 $M$ 在集合 $S$ 上的作用。令 $\mathcal{C}(M)$ 表示由单子 $M$ 确定的范畴（参见2.3.12）。该作用确定了一个函子：

$$
F_\alpha : \mathcal{C}(M) \rightarrow \text{Set}
$$

**函子的定义：**

1. **对象映射（AF–1）：**

   $$
   F_\alpha(\ast) = S
   $$

   其中 $\ast$ 是范畴 $\mathcal{C}(M)$ 中的唯一对象。

2. **箭头映射（AF–2）：**

   对于 $m \in M$，有：

   $$
   F_\alpha(m) : S \rightarrow S
   $$

   定义为：

   $$
   F_\alpha(m)(s) = \alpha(m, s) = ms
   $$

**结论：** 每个单子作用 $\alpha$ 都对应一个从单子范畴 $\mathcal{C}(M)$ 到集合范畴 $\text{Set}$ 的函子 $F_\alpha$。

**推广：** 这种观察允许我们将作用推广到更一般的范畴中，如后续的3.2.6节所述。

### 3.2.4 例子：向量空间上的单子作用

**例子 3.2.4：** 一个单子 $M$ 在向量空间 $V$ 上的作用是一个单子作用的特例，其中 $S$ 是向量空间，且作用具有额外的线性结构。

**具体说明：**

- **作用的类型：** 当 $S$ 是一个向量空间时，单子 $M$ 通常是由线性变换构成的集合，闭合于复合和包含恒等变换。

- **额外结构：** 在线性变换的情况下，作用不仅满足单子的基本性质（A–1 和 A–2），还保持了向量空间的线性结构，如加法和数乘。这超出了基本的单子作用定义，不在上述定义的范围内。

**讨论：**

- **广义性：** 上述定义非常一般，不要求 $S$ 具有任何额外结构（如加法、数乘或连续性），因此适用于更广泛的情况。

- **权衡：** 缺乏额外结构意味着可以应用于更多情境，但也意味着能够使用的定理和工具更少。

**结论：** 单子作用的定义非常通用，适用于各种没有额外结构的集合，但在特定情境下，如向量空间上的线性变换作用，需要考虑额外的结构保持性。

### 3.2.5 例子：有限状态机（Finite State Machines）

**例子 3.2.5：** 单子作用在**有限状态机**中的应用是一个重要的实例，展示了单子作用如何描述状态转换系统。

**有限状态机的定义：**

一个有限状态机 $M = (A, S, s_0, \phi)$ 包括：

- **字母表 $A$：** 一个有限集合，元素被视为字符或标记（tokens）。

- **状态集 $S$：** 一个有限集合，元素被视为状态。

- **初始状态 $s_0 \in S$：** 一个指定的起始状态。

- **转换函数 $\phi : A \times S \rightarrow S$：** 定义每个字符和状态下的状态转换。

**有限状态机与单子作用的关联：**

- **自由单子 $A^*$：** 由字母表 $A$ 生成的自由单子，包含所有有限长度的字符串（包括空字符串），运算为字符串连接。

- **作用的定义：** 定义一个函数：

  $$
  \phi^* : A^* \times S \rightarrow S
  $$

  通过递归定义：

  1. **基底情况：**

     $$
     \phi^*(\epsilon, s) = s \quad \text{对所有 } s \in S
     $$

  2. **递归情况：**

     对于任意 $a \in A$ 和 $w \in A^*$ 以及 $s \in S$，有：

     $$
     \phi^*(aw, s) = \phi(a, \phi^*(w, s))
     $$

**验证单子作用的条件：**

1. **单位元作用（A–1）：**

   空字符串 $\epsilon$ 是自由单子的单位元，有：

   $$
   \phi^*(\epsilon, s) = s
   $$

2. **结合律（A–2）：**

   对于任意 $u, v \in A^*$ 和 $s \in S$，有：

   $$
   \phi^*(uv, s) = \phi^*(u, \phi^*(v, s)) = \phi^*(u, \phi^*(v, s)) = \phi^*(u, \phi^*(v, s)) = \phi^*(u, \phi^*(v, s))
   $$

   这满足了结合律。

**附加结构：**

- **识别语言：** 如果有限状态机有一组接受状态 $F \subseteq S$，则语言 $L \subseteq A^*$ 定义为能够从初始状态 $s_0$ 通过转换达到接受状态的字符串集合。

- **变换机器：** 有限状态机还可以扩展为输出状态或进行转导（transducer），即在每次状态转换时输出符号。

**参考文献：**

- **Lewis 和 Papadimitriou (1981)：** 提供了有限状态机的基础介绍。
  
- **Eilenberg (1976) 和 Lallement (1979)：** 使用代数方法研究有限状态机，特别是作为识别器的应用。

**结论：** 有限状态机是单子作用在集合上的一个具体应用，通过自由单子 $A^*$ 描述字符串的处理和状态的转换。

### 3.2.6 集合值函子作为作用（Set-Valued Functors as Actions）

**讨论：**

为了推广单子作用的概念，引入**类型**的概念。设想在状态空间 $S$ 上不仅有作用，还有一个类型集 $T$，并有一个函数：

$$
\text{type} : S \rightarrow T
$$

将每个状态 $s \in S$ 分配一个类型 $\text{type}(s) \in T$。

**类型限制：**

- **输入和输出类型：** 对于单子 $M$ 的每个元素 $m \in M$，定义两个函数：

  $$
  \text{input}(m) : M \rightarrow T
  $$
  
  $$
  \text{output}(m) : M \rightarrow T
  $$

  其中，$\text{input}(m)$ 是 $m$ 作用的输入类型，$\text{output}(m)$ 是 $m$ 作用后的输出类型。

- **组合限制：** $m_1 \cdot m_2$ 定义时，要求：

  $$
  \text{output}(m_2) = \text{input}(m_1)
  $$

  即，$m_1$ 的输入类型必须与 $m_2$ 的输出类型相同。

- **单位元作用：** 对于每个类型 $t \in T$，存在一个操作 $1_t \in M$，满足：

  $$
  \text{input}(1_t) = t, \quad \text{output}(1_t) = t
  $$
  
  并且对于任意 $m \in M$：

  $$
  1_t \cdot m = m \quad \text{当且仅当} \quad \text{input}(m) = t
  $$
  
  $$
  m \cdot 1_t = m \quad \text{当且仅当} \quad \text{output}(m) = t
  $$

**范畴构造：**

- **范畴 $C$：** $C$ 是由类型集 $T$ 构成的范畴，**对象**是类型 $t \in T$，**箭头**是单子 $M$ 的元素 $m \in M$，满足：

  $$
  \text{source}(m) = \text{input}(m), \quad \text{target}(m) = \text{output}(m)
  $$

  其中，$1_t$ 是每个对象 $t$ 的恒等箭头。

**函子的定义：**

- **函子 $F : C \rightarrow \text{Set}$：**

  - **对象映射：**

    $$
    F(t) = \{ s \in S \mid \text{type}(s) = t \}
    $$

  - **箭头映射：** 对于每个箭头 $m : t \rightarrow t'$，有：

    $$
    F(m) : F(t) \rightarrow F(t')
    $$
    
    定义为：
    
    $$
    F(m)(s) = ms
    $$

**验证函子的条件：**

1. **保持恒等箭头：**

   对于每个类型 $t \in T$，有：

   $$
   F(1_t)(s) = 1_t s = s \quad \text{对所有 } s \in F(t)
   $$

   因此，$F(1_t) = \text{id}_{F(t)}$。

2. **保持复合箭头：**

   对于任意两个箭头 $m_1 : t \rightarrow t'$ 和 $m_2 : t' \rightarrow t''$，有：

   $$
   F(m_2 \cdot m_1)(s) = (m_2 \cdot m_1)s = m_2(m_1 s) = F(m_2)(F(m_1)(s))
   $$

   因此，$F(m_2 \cdot m_1) = F(m_2) \circ F(m_1)$。

**结论：** 通过上述构造，集合值函子 $F : C \rightarrow \text{Set}$ 将范畴 $C$ 的对象和箭头映射到集合和函数上，满足函子的定义条件，从而将单子作用推广为更一般的范畴上的集合值函子。

**逆向构造：**

如果给定一个小范畴 $C$，且存在一个函子 $F : C \rightarrow \text{Set}$，满足当 $C$ 中对象 $C$ 和 $D$ 不同时，$F(C)$ 和 $F(D)$ 是不相交的集合，则可以逆向构造一个作用：

1. **类型集 $T$：** 令 $T$ 为范畴 $C$ 的对象集。

2. **单子 $M$：** 令 $M$ 为范畴 $C$ 的箭头集。

3. **状态集 $S$：** 令 $S = \bigsqcup_{t \in T} F(t)$，即 $F(t)$ 的不相交并集。

4. **类型函数：**

   $$
   \text{type}(s) = t \quad \text{当且仅当} \quad s \in F(t)
   $$

5. **输入和输出类型：** 对于每个箭头 $m \in M$，设：

   $$
   \text{input}(m) = \text{source}(m)
   $$
   
   $$
   \text{output}(m) = \text{target}(m)
   $$

6. **作用定义：** 对于每个 $m \in M$ 和 $s \in S$，

   $$
   m \ast s = F(m)(s)
   $$

**结论：** 如果范畴 $C$ 是小范畴，且函子 $F : C \rightarrow \text{Set}$ 满足上述不相交条件，则可以构造出一个单子作用。这表明，集合值函子与单子作用之间存在紧密的对应关系。

### 3.2.7 例子：Hom函子（Hom Functors）

**例子 3.2.7：** 对于任何给定范畴 $\mathcal{C}$ 中的对象 $C$，**Hom函子** $\text{Hom}(C, -) : \mathcal{C} \rightarrow \text{Set}$ 是一个集合值函子的特例。

**具体说明：**

- **协变 Hom函子 $\text{Hom}(C, -)$：**
  
  - **对象映射：**
    
    $$
    \text{Hom}(C, -)(A) = \text{Hom}(C, A)
    $$
  
  - **箭头映射：**
    
    对于每条箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$，有：
    
    $$
    \text{Hom}(C, -)(f) = \text{Hom}(C, f) : \text{Hom}(C, A) \rightarrow \text{Hom}(C, B)
    $$
    
    定义为：
    
    $$
    \text{Hom}(C, f)(g) = f \circ g \quad \text{对所有 } g: C \rightarrow A
    $$

- **反协变 Hom函子 $\text{Hom}(-, D) : \mathcal{C}^{\text{op}} \rightarrow \text{Set}$：**
  
  - **对象映射：**
    
    $$
    \text{Hom}(-, D)(A) = \text{Hom}(A, D)
    $$
  
  - **箭头映射：**
    
    对于每条箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$，有：
    
    $$
    \text{Hom}(-, D)(f) = \text{Hom}(f, D) : \text{Hom}(B, D) \rightarrow \text{Hom}(A, D)
    $$
    
    定义为：
    
    $$
    \text{Hom}(f, D)(g) = g \circ f \quad \text{对所有 } g: B \rightarrow D
    $$

**重要性：**

- **Yoneda引理：** Hom函子在范畴论中具有核心地位，尤其是与Yoneda引理紧密相关。Yoneda引理揭示了范畴中的对象可以通过Hom函子完全描述。

- **Cayley定理的推广：** 当 $\mathcal{C}$ 是一个单子时，Hom函子 $\text{Hom}(C, -)$ 对应于单子的左乘作用，类似于Cayley定理中群作为自身的置换群的表示。

**结论：** Hom函子是集合值函子的一个基本且重要的实例，展示了函子如何捕捉范畴中的箭头结构，并在理论上具有深远的影响。

---

## 总结

本节 **3.2 Actions（作用）** 探讨了**集合值函子**作为单子作用的自然推广及其在范畴论中的重要性。通过具体的定义和例子，您可以看到函子如何将代数结构（如单子）与集合上的作用联系起来，并进一步推广到更一般的范畴结构中。

**关键点回顾：**

1. **单子作用的定义与性质：**
   - 单子作用描述了单子元素如何在集合上诱导状态转换，满足单位元作用和结合律。
   - 等变映射构成了一个范畴 $M\text{-Act}$。

2. **作用作为函子的对应关系：**
   - 每个单子作用对应于一个从单子范畴到集合范畴的函子。
   - 通过这种对应关系，作用的概念可以推广到更一般的范畴结构中。

3. **具体例子：**
   - **向量空间上的单子作用：** 展示了单子作用在具有额外结构的集合（如向量空间）上的应用。
   - **有限状态机：** 通过自由单子作用描述了有限状态机的状态转换机制。
   - **Hom函子：** 作为集合值函子的一个基本实例，展示了函子在捕捉范畴结构中的核心作用。

4. **映射提升性质（Map-Lifting Property）：**
   - 自由函子（如自由类别函子和自由单子函子）具有映射提升性质，确保任何从源结构到目标结构的映射可以唯一地提升为函子映射。

5. **类型化作用：**
   - 通过引入类型集 $T$，将单子作用推广为带有输入和输出类型限制的结构，进一步对应于集合值函子的更一般形式。

**进一步学习建议：**

- **Yoneda引理（Yoneda Lemma）：** 深入理解Yoneda引理及其在范畴论中的应用，特别是如何通过Hom函子完全描述范畴中的对象。

- **伴随函子与自然变换：** 探索函子之间的更高级关系，如伴随函子和自然变换，以扩展对范畴论结构的理解。

- **高阶范畴论（Higher Category Theory）：** 研究2-范畴（2-categories）、∞-范畴（∞-categories）等更高阶的范畴结构，进一步拓展范畴论的应用范围。

通过对本节内容的深入学习，您将能够更好地理解集合值函子与单子作用之间的联系，掌握如何将代数结构与范畴论中的函子概念结合起来，并应用这些知识解决更复杂的数学和计算机科学问题。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ----------------------------

好的，让我们继续详细解析您提供的章节 **3.2 Actions（作用）**。本节探讨了**集合值函子**（set-valued functors）作为**有限状态机**（finite state machines）的自然推广，并介绍了一些相关的高级概念和应用实例。以下是对**3.2.8** 到 **3.2.12** 小节的详细解析。

---

## 3.2 Actions（作用）

在本节中，我们将进一步探讨单子作用及其推广，尤其是**集合值函子**在描述复杂系统（如有限状态机）中的应用。这些概念不仅在理论上具有重要意义，还在计算机科学等领域有广泛应用。

### 3.2.8 变量集（Variable Sets）

**概念解释：**

有时，将集合值函子 $F: \mathcal{C} \rightarrow \text{Set}$ 理解为在**单变量集合**上的作用可能更为直观。这里，“单变量集合”指的是一个集合，其结构不依赖于类型，而是通过范畴 $\mathcal{C}$ 的对象和箭头来参数化其变化。

**具体说明：**

- **参数空间（Parameter Space）：** 范畴 $\mathcal{C}$ 的对象构成了一个参数空间，用于描述集合 $S$ 在不同“视角”下的变化。每个对象可以被视为一种不同的“视角”或“状态”。

- **视角的变化：** 范畴 $\mathcal{C}$ 的箭头表示视角之间的转换。这些转换不仅改变了集合 $S$ 的状态，还可能诱导集合的结构发生变化。

**直观理解：**

可以将集合值函子 $F: \mathcal{C} \rightarrow \text{Set}$ 视为一个**变动的集合**，其在不同的参数（对象）下表现出不同的结构。范畴 $\mathcal{C}$ 的箭头则描述了这些结构之间的关联和转换。

**参考文献：**

- [Barr, McLarty and Wells, 1985] 提供了更深入的讨论和应用实例。

**结论：**

将集合值函子视为变量集上的作用，可以帮助我们更好地理解函数在不同参数下如何影响集合的结构和行为。这种视角在描述动态系统和状态转换时尤为有用。

### 3.2.9 带类型动作的机器（Machines with Typed Actions）

**概念解释：**

为了推广有限状态机的概念，可以引入**类型**（typing）的概念，即为输入和输出赋予类型。这使得状态转换更加严格和有序，确保动作在适当的类型之间进行。

**具体说明：**

- **类型集（Type Set）$T$：** 定义一个类型集 $T$，为每个状态赋予一个类型，通过函数 $\text{type}: S \rightarrow T$ 映射集合 $S$ 的元素到类型集 $T$ 中。

- **输入和输出类型：**
  
  - **输入类型函数** $\text{input}: M \rightarrow T$：为每个动作 $m \in M$ 指定其输入类型。
  
  - **输出类型函数** $\text{output}: M \rightarrow T$：为每个动作 $m \in M$ 指定其输出类型。

- **组合限制：** 动作的复合 $m_1 \cdot m_2$ 仅在 $\text{output}(m_2) = \text{input}(m_1)$ 时定义，确保类型的一致性。

- **单位元作用：** 对于每个类型 $t \in T$，存在一个操作 $1_t \in M$，满足：
  
  $$
  1_t \cdot m = m \quad \text{当且仅当} \quad \text{input}(m) = t
  $$
  
  $$
  m \cdot 1_t = m \quad \text{当且仅当} \quad \text{output}(m) = t
  $$

**范畴构造：**

- **范畴 $\mathcal{C}$：** 类型集 $T$ 作为对象，动作集 $M$ 作为箭头，满足源和靶的类型限制。这里，$M$ 和 $T$ 共同构成了一个小范畴 $\mathcal{C}$，其中 $\text{input}(m)$ 和 $\text{output}(m)$ 分别对应于箭头 $m$ 的源和靶。

**函子的定义：**

- **函子 $F: \mathcal{C} \rightarrow \text{Set}$：**
  
  - **对象映射：**
    
    $$
    F(t) = \{ s \in S \mid \text{type}(s) = t \}
    $$
  
  - **箭头映射：** 对于每个箭头 $m: t \rightarrow t'$，定义：
    
    $$
    F(m): F(t) \rightarrow F(t')
    $$
    
    通过：
    
    $$
    F(m)(s) = m \ast s
    $$
    
    其中 $m \ast s$ 表示动作 $m$ 对状态 $s$ 的作用。

**验证函子的条件：**

1. **保持恒等箭头：**
   
   对于每个类型 $t \in T$，有：
   
   $$
   F(1_t)(s) = 1_t \ast s = s
   $$
   
   因此，$F(1_t) = \text{id}_{F(t)}$。

2. **保持复合箭头：**
   
   对于任意两个箭头 $m_1: t \rightarrow t'$ 和 $m_2: t' \rightarrow t''$，有：
   
   $$
   F(m_2 \cdot m_1)(s) = (m_2 \cdot m_1) \ast s = m_2 \ast (m_1 \ast s) = F(m_2)(F(m_1)(s))
   $$
   
   因此，$F(m_2 \cdot m_1) = F(m_2) \circ F(m_1)$。

**结论：**

通过引入类型，并将单子作用推广为带有输入和输出类型限制的结构，我们可以将动作描述得更加严谨和有序。这种带类型的动作不仅保证了动作之间的兼容性，还为更复杂的系统建模提供了基础。

### 3.2.10 注释：模型非确定性（Remark on Modeling Nondeterminism）

**概念解释：**

在现实系统中，状态转换往往不是确定性的，一个动作可能导致多个不同的状态。为了在范畴论中描述这种**非确定性**，需要扩展动作的定义。

**具体说明：**

- **关系而非函数：** 如果动作 $m$ 导致状态 $x$ 转换到多个状态 $y$，则不能用函数来表示这种多重转换。相反，应使用**关系**（relation）来描述动作的效果。

- **范畴 Rel：** 使用关系范畴 $\text{Rel}$ 代替 $\text{Set}$，其中箭头是从一个集合到另一个集合的关系，而非函数。

- **关系表示动作：**
  
  - **箭头 $m: A \rightarrow B$** 在关系范畴中表示为一个关系 $R_m \subseteq A \times B$。
  
  - **动作定义：**
    
    $$
    R_m = \{ (x, y) \mid \text{动作 } m \text{ 可以将 } x \text{ 转换为 } y \}
    $$
    
    如果动作 $m$ 使状态 $x$ 无法转换，则 $(x, y)$ 不属于 $R_m$。

**具体说明：**

- **范畴 Rel 的特性：** 在 $\text{Rel}$ 中，箭头的复合定义为关系的合成，而不是函数的复合。这允许表示一个动作序列导致的多个可能结果。

**结论：**

通过使用关系范畴 $\text{Rel}$ 来描述动作，可以自然地模型化非确定性的状态转换。这为描述更复杂的系统（如并行系统或具有多个可能结果的计算过程）提供了强大的工具。

**拓展应用：**

- **计算机科学中的应用：** 在程序语言的语义学中，非确定性经常出现，例如在描述并行程序或具有随机性的算法时。关系范畴为这些应用提供了理论基础。

### 3.2.11 例子：带类型动作的有限状态机（Finite State Machines with Typed Actions）

**概念解释：**

为了更具体地展示带类型动作的应用，我们可以通过一个例子来描述一个带有不同模式（modes）的应用程序。该应用程序具有多个模式，每种模式下可以执行不同的任务。

**具体说明：**

- **应用程序的模式：** 假设一个程序有三种模式：
  
  1. **选择模式（Choosing Mode）**：用户选择要执行的任务。
  
  2. **任务1模式（Task 1 Mode）**：执行识别语言 $L_1$ 的任务，使用有限状态机 $m_1$。
  
  3. **任务2模式（Task 2 Mode）**：执行识别语言 $L_2$ 的任务，使用有限状态机 $m_2$。

- **图 $G$ 的构造：**
  
  - **节点（状态）：** 程序的不同状态，包括模式和中间状态。
  
  - **箭头（动作）：** 用户的输入（如输入字符或选择操作），以及程序的状态转换。

- **有限状态机的具体例子：**

  **语言 $L_1$：** 所有以 $x$ 结尾的字符串。

  **语言 $L_2$：** 所有以 $x$ 开头的字符串。

- **机器 $M_1$ 和 $M_2$ 的定义：**
  
  - **机器 $M_1$：** 识别语言 $L_1$，状态集包括开始状态 $s$、接受状态 $a$ 和拒绝状态 $r$。
  
  - **机器 $M_2$：** 识别语言 $L_2$，状态集包括开始状态 $s$、接受状态 $o$ 和拒绝状态 $b$。

- **图 $G$ 的示意图：**

  ```
      m1      c
      ✛       1 ✲ q
      m2      2 ✲ q
             ❘      x
             ❘      x
             ■      y
             ■      y
  ```

  其中，箭头 $x$ 和 $y$ 是不同的动作，$q$ 代表退出或结束。

- **函子 $F: C \rightarrow \text{Set}$ 的定义：**
  
  - **对象映射：**
    
    - $F(c) = \{ s, a, r \}$ ：表示初始状态、接受状态和拒绝状态。
    
    - $F(m_1) = \{ s_1, b_1 \}$ ：机器 $M_1$ 的状态。
    
    - $F(m_2) = \{ s_2, o, b_2 \}$ ：机器 $M_2$ 的状态。
  
  - **箭头映射：**
    
    通过表格定义各箭头在集合中的映射关系。例如，箭头 $q$ 将 $b_1$ 映射到 $r$，而箭头 $x$ 将 $s_1$ 映射到 $a$。

- **机器的行为示例：**
  
  - 输入字符串 "1yxxq" 导致机器 $M_1$ 最终状态为 $a$（接受）。
  
  - 输入字符串 "1yyq2xyyq" 经过机器的多个状态转换，最终状态为 $a$。

**拓展说明：**

- **类型化输入的好处：** 通过引入类型，可以确保输入字符串符合特定的格式或规则，减少错误输入。

- **错误处理：** 可以通过添加额外的状态（如错误状态 $e$）来处理不符合类型规则的输入。

**结论：**

带类型动作的有限状态机通过类型化输入和输出，提供了更严格和有序的状态转换机制。这种模型在实际应用中，如编译器设计和语言识别，具有重要的实用价值。

### 3.2.12 习题

**习题 3.2.12：**

**题目：**

1. 设 $S$ 是一个集合。定义全变换单子 $\text{F}T(S)$ 为所有从 $S$ 到 $S$ 的函数的集合，运算为函数的复合。证明**3.2.1** 中单子作用的定义与以下等价：一个单子作用 $\alpha$ 是一个从单子 $M$ 到全变换单子 $\text{F}T(S)$ 的单子同态。

**解题思路：**

要证明单子作用的定义等价于一个单子同态 $\alpha: M \rightarrow \text{F}T(S)$，我们需要展示以下两者之间的对应关系：

1. **从单子作用到单子同态：**
   
   - 给定一个单子 $M$ 在集合 $S$ 上的作用 $\alpha: M \times S \rightarrow S$，可以构造一个函数 $\phi: M \rightarrow \text{F}T(S)$，其中每个 $m \in M$ 映射为一个函数 $\phi(m): S \rightarrow S$，定义为：
     
     $$
     \phi(m)(s) = \alpha(m, s) = ms
     $$
   
   - 验证 $\phi$ 是一个单子同态：
     
     - **保持单位元：**
       
       $$
       \phi(1)(s) = \alpha(1, s) = s = \text{id}_S(s)
       $$
       
       因此，$\phi(1) = \text{id}_S$。
     
     - **保持复合：**
       
       $$
       \phi(mn)(s) = \alpha(mn, s) = m(ns) = \phi(m)(\phi(n)(s)) = (\phi(m) \circ \phi(n))(s)
       $$
       
       因此，$\phi(mn) = \phi(m) \circ \phi(n)$。

2. **从单子同态到单子作用：**
   
   - 给定一个单子同态 $\phi: M \rightarrow \text{F}T(S)$，定义作用 $\alpha: M \times S \rightarrow S$ 为：
     
     $$
     \alpha(m, s) = \phi(m)(s)
     $$
   
   - 验证 $\alpha$ 满足单子作用的条件：
     
     - **单位元作用：**
       
       $$
       \alpha(1, s) = \phi(1)(s) = \text{id}_S(s) = s
       $$
     
     - **结合律：**
       
       $$
       \alpha(mn, s) = \phi(mn)(s) = (\phi(m) \circ \phi(n))(s) = \phi(m)(\phi(n)(s)) = m(ns)
       $$
       
       因此，$\alpha(mn, s) = m(ns)$。

**结论：**

通过上述对应关系，我们证明了单子作用的定义与从单子 $M$ 到全变换单子 $\text{F}T(S)$ 的单子同态 $\alpha$ 是等价的。这意味着，单子作用可以被视为一个单子同态，将单子的结构映射到集合上的函数空间中。

**详细证明：**

为了更严谨地表达这个证明，我们可以详细展开：

**从单子作用到单子同态的详细证明：**

设 $\alpha: M \times S \rightarrow S$ 是 $M$ 在 $S$ 上的一个作用，满足：

1. $1 \cdot s = s$ 对所有 $s \in S$。
2. $(mn) \cdot s = m \cdot (n \cdot s)$ 对所有 $m, n \in M$ 和 $s \in S$。

定义 $\phi: M \rightarrow \text{F}T(S)$ 为：

$$
\phi(m)(s) = m \cdot s
$$

**验证 $\phi$ 是单子同态：**

1. **保持单位元：**

   $$
   \phi(1)(s) = 1 \cdot s = s = \text{id}_S(s)
   $$
   
   因此，$\phi(1) = \text{id}_S$。

2. **保持复合：**

   对于任意 $m, n \in M$，有：

   $$
   \phi(mn)(s) = (mn) \cdot s = m \cdot (n \cdot s) = \phi(m)(\phi(n)(s)) = (\phi(m) \circ \phi(n))(s)
   $$
   
   因此，$\phi(mn) = \phi(m) \circ \phi(n)$。

**从单子同态到单子作用的详细证明：**

设 $\phi: M \rightarrow \text{F}T(S)$ 是一个单子同态，定义 $\alpha: M \times S \rightarrow S$ 为：

$$
\alpha(m, s) = \phi(m)(s)
$$

**验证 $\alpha$ 满足单子作用的条件：**

1. **单位元作用：**

   $$
   \alpha(1, s) = \phi(1)(s) = \text{id}_S(s) = s
   $$
   
   因此，$1 \cdot s = s$。

2. **结合律：**

   对于任意 $m, n \in M$ 和 $s \in S$，有：

   $$
   \alpha(mn, s) = \phi(mn)(s) = (\phi(m) \circ \phi(n))(s) = \phi(m)(\phi(n)(s)) = m \cdot (n \cdot s)
   $$
   
   因此，$(mn) \cdot s = m \cdot (n \cdot s)$。

**总结：**

通过这两个方向的证明，我们确立了**单子作用**与**单子同态**之间的等价性。这不仅加深了对单子作用本质的理解，还展示了范畴论中函子如何将代数结构与集合上的作用紧密联系起来。

---

## 总结

本节 **3.2 Actions（作用）** 深入探讨了**单子作用**及其在范畴论中的推广，尤其是通过**集合值函子**描述复杂系统（如有限状态机）的方式。以下是本节的关键点回顾：

1. **单子作用的基本定义：**
   - **单子作用**描述了单子元素如何在集合上诱导状态转换，满足单位元作用和结合律。
   - **等变映射**构成了一个范畴 $M\text{-Act}$，其中对象是 $M$-集，箭头是等变映射。

2. **作用与函子的对应关系：**
   - 每个单子作用对应于一个从单子范畴 $\mathcal{C}(M)$ 到集合范畴 $\text{Set}$ 的函子。
   - 通过这种对应关系，可以将作用推广到更一般的范畴结构中，如带类型的动作和变量集上的作用。

3. **具体应用与例子：**
   - **有限状态机：** 通过自由单子作用描述有限状态机的状态转换机制。
   - **带类型动作的机器：** 引入类型后，可以更严格地描述动作的输入和输出，确保动作的兼容性。
   - **Hom函子：** 作为集合值函子的一个基本实例，展示了函子在捕捉范畴结构中的核心作用。

4. **高级概念与拓展：**
   - **非确定性建模：** 通过关系范畴 $\text{Rel}$ 描述非确定性的状态转换。
   - **映射提升性质（Map-Lifting Property）：** 自由函子具有此性质，确保任何从源结构到目标结构的映射可以唯一地提升为函子映射。
   - **等价性证明：** 单子作用与单子同态的等价性，展示了范畴论中结构保持映射的强大能力。

5. **习题的应用：**
   - 通过习题，实践如何构造和验证函子，理解函子的高级性质。
   - 习题帮助理解范畴的等价性、子范畴关系以及函数与单子作用之间的联系。

**进一步学习建议：**

- **Yoneda引理（Yoneda Lemma）：** 深入理解Yoneda引理及其在范畴论中的应用，特别是如何通过Hom函子完全描述范畴中的对象。
  
- **伴随函子与自然变换：** 探索函子之间的更高级关系，如伴随函子和自然变换，以扩展对范畴论结构的理解。
  
- **高阶范畴论（Higher Category Theory）：** 研究2-范畴（2-categories）、∞-范畴（∞-categories）等更高阶的范畴结构，进一步拓展范畴论的应用范围。

通过对本节内容的深入学习，您将能够更好地理解单子作用与范畴论中的函子之间的联系，掌握如何将代数结构与集合上的作用结合起来，并应用这些知识解决更复杂的数学和计算机科学问题。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ---------------------------

好的，让我们继续详细解析您提供的章节 **3.3 Types of Functors（函子的类型）**。本节将探讨函子的不同类型及其性质，包括同构函子、满函子、忠实函子、保留性质的函子等。通过具体的定义、例子和命题，您将更深入地理解函子的多样性及其在范畴论中的重要角色。

---

## 3.3 Types of Functors（函子的类型）

由于 $\text{Cat}$ 本身是一个范畴，我们已经了解了一些函子的类型。因此，给定两个范畴 $\mathcal{C}$ 和 $\mathcal{D}$，一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是**同构函子**，当且仅当存在一个函子 $G: \mathcal{D} \rightarrow \mathcal{C}$，使得 $G \circ F = \text{id}_{\mathcal{C}}$ 且 $F \circ G = \text{id}_{\mathcal{D}}$。这意味着 $F$ 在对象和箭头上都是双射，反之亦然。

### 3.3.1 满函子与忠实函子

#### 3.3.1.1 同构函子（Isomorphism Functors）

**定义：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是**同构函子**（isomorphism functor），当且仅当存在一个函子 $G: \mathcal{D} \rightarrow \mathcal{C}$，使得 $G \circ F = \text{id}_{\mathcal{C}}$ 且 $F \circ G = \text{id}_{\mathcal{D}}$。这种函子在对象和箭头上都是双射，即 **双射函子**（bijective functor）。

**性质：**
- **同构性：** 如果 $F$ 是同构函子，则 $\mathcal{C}$ 和 $\mathcal{D}$ 是范畴上的**等价范畴**（equivalent categories）。
- **反函子：** $G$ 被称为 $F$ 的**逆函子**（inverse functor）。

**例子：**
- **同构单子：** 如果两个单子 $M$ 和 $N$ 在结构上相同，则它们之间的函子映射构成同构函子。
- **类别同构：** 任何两个同构的范畴之间的函子自然是同构函子。

#### 3.3.2 满函子与忠实函子（Full and Faithful Functors）

**定义 3.3.2：** 给定一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，对于每一对对象 $A, B \in \mathcal{C}$，$F$ 诱导一个映射：
$$
\text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))
$$
这将 $f: A \rightarrow B$ 映射为 $F(f): F(A) \rightarrow F(B)$。

**忠实函子（Faithful Functor）：** $F$ 是**忠实**的（faithful），如果对于每一对对象 $A, B \in \mathcal{C}$，诱导的映射
$$
\text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))
$$
是**单射**（injective）的。即，如果 $f \neq g$ 在 $\text{Hom}_{\mathcal{C}}(A, B)$ 中，则 $F(f) \neq F(g)$ 在 $\text{Hom}_{\mathcal{D}}(F(A), F(B))$ 中。

**满函子（Full Functor）：** $F$ 是**满**的（full），如果对于每一对对象 $A, B \in \mathcal{C}$，诱导的映射
$$
\text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))
$$
是**满射**（surjective）的。即，对于 $F(A)$ 和 $F(B)$ 之间的任意箭头 $g$，存在 $\mathcal{C}$ 中的箭头 $f: A \rightarrow B$，使得 $F(f) = g$。

**组合性质：**
- **满且忠实：** 如果 $F$ 同时是满的和忠实的，则 $F$ 是一个**满且忠实函子**（fully faithful functor）。
- **包含函子：** 子范畴的包含函子通常是满且忠实的，因为它们在对象和箭头上的映射都是恒等的。

**例子 3.3.3：** **底层函子（Underlying Functors）**

- **单子范畴到集合范畴的底层函子 $U: \text{Mon} \rightarrow \text{Set}$：**
  - **对象映射：** 忘记单子结构，仅将每个单子映射为其底层集合。
  - **箭头映射：** 忘记单子同态的结构，仅将单子同态视为集合上的函数。

- **满性与忠实性：**
  - **忠实性：** $U$ 是忠实的，因为不同的单子同态在集合上表现为不同的函数。
  - **满性：** $U$ **不满**，因为不是所有集合函数都是单子同态。

**进一步说明：**
- **忠实但不满：** $U$ 保持了箭头的区别性，但不覆盖所有可能的箭头。
- **满且忠实的函子：** 子范畴的包含函子是满且忠实的，因为它们在对象和箭头上的映射都是恒等的。

#### 3.3.3 例子 3.3.3：底层函子并非总是满的

考虑集合 $\{0, 1, 2\}$，它有两种不同的单子结构（通过加法和乘法模 3），但对应的**身份同态**作为集合函数是相同的。这说明，底层函子 $U$ 可能无法区分不同的单子结构，尽管它是忠实的。

### 3.3.4 保持性质的函子（Functors Preserving Properties）

**定义 3.3.6：** 给定一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$，如果对于任何箭头 $f$ 具有性质 $P$，则 $F(f)$ 也具有性质 $P$，则称 $F$ **保持性质 $P$**（preserves the property $P$）。

**例子 3.3.7：**
- **保留单射和满射：**
  - **单子范畴的底层函子 $U: \text{Mon} \rightarrow \text{Set}$：** 保持单射，因为在单子范畴中，单射同态必须在集合上是单射函数。
  - **半群范畴的底层函子 $U: \text{Sem} \rightarrow \text{Set}$：** 不保持满射，因为并非所有集合函数都是半群同态。

- **特定函子不保留性质：**
  - **函子 $F: 2 \rightarrow \text{Set}$：** 定义为将对象 $C$ 和 $D$ 映射到集合 $\{1, 2\}$ 和 $\{3, 4\}$，并将箭头映射为常函数 $f: \{1, 2\} \rightarrow \{3, 4\}$，即 $f(1) = f(2) = 3$。此函子不保留单射性和满射性，因为不同箭头可能被映射为相同的函数，且一些函数不在其像中。

**结论：** 函子是否保留某种性质取决于其定义和所涉及的范畴结构。理解函子如何影响箭头的性质对于构建和分析范畴之间的关系至关重要。

### 3.3.8 命题：每个函子都保留同构性

**命题 3.3.8：** 每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ **保留同构性**，即如果 $f: A \rightarrow B$ 是 $\mathcal{C}$ 中的同构箭头，则 $F(f): F(A) \rightarrow F(B)$ 在 $\mathcal{D}$ 中也是同构箭头。

**证明：**
1. **同构箭头的定义：** 如果 $f: A \rightarrow B$ 是同构的，则存在一个箭头 $g: B \rightarrow A$ 使得 $g \circ f = \text{id}_A$ 且 $f \circ g = \text{id}_B$。
2. **函子的作用：** 应用函子 $F$：
   $$
   F(g \circ f) = F(\text{id}_A) = \text{id}_{F(A)}
   $$
   $$
   F(g) \circ F(f) = \text{id}_{F(A)}
   $$
   同理：
   $$
   F(f \circ g) = F(\text{id}_B) = \text{id}_{F(B)}
   $$
   $$
   F(f) \circ F(g) = \text{id}_{F(B)}
   $$
3. **结论：** 因此，$F(f)$ 存在逆箭头 $F(g)$，使得 $F(g) \circ F(f) = \text{id}_{F(A)}$ 和 $F(f) \circ F(g) = \text{id}_{F(B)}$，即 $F(f)$ 是同构箭头。

**结论：** 所有函子自然保留同构性，这反映了函子作为结构保持映射的基本性质。

### 3.3.9 定义：反映性质的函子（Functors Reflecting Properties）

**定义 3.3.9：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ **反映性质 $P$**，如果对于任何箭头 $f$ 在 $\mathcal{C}$ 中，若 $F(f)$ 具有性质 $P$，则 $f$ 也具有性质 $P$。

**例子：**
- **反映同构性的函子：** 如果 $F$ 是满且忠实的，则 $F$ 反映同构性（见后续命题）。
- **底层函子 $U: \text{Sem} \rightarrow \text{Set}$：** 反映同构性，因为双射半群同态是同构。

**重要性：** 反映性质的函子可以用来从目标范畴的性质推导源范畴的性质，增强了函子在结构分析中的应用能力。

### 3.3.10 命题：满且忠实函子反映同构性

**命题 3.3.10：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是满且忠实的函子，且 $A, B \in \mathcal{C}$，如果 $u: F(A) \rightarrow F(B)$ 在 $\mathcal{D}$ 中是同构箭头，则存在唯一的同构箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$ 中，使得 $F(f) = u$。

**证明：**
1. **满性：** 由于 $F$ 是满的，存在 $f: A \rightarrow B$ 使得 $F(f) = u$。
2. **存在逆箭头：** 因为 $u$ 是同构的，存在 $u^{-1}: F(B) \rightarrow F(A)$ 使得 $u^{-1} \circ u = \text{id}_{F(A)}$ 和 $u \circ u^{-1} = \text{id}_{F(B)}$。
3. **满性应用于逆箭头：** 因为 $F$ 是满的，存在 $g: B \rightarrow A$ 使得 $F(g) = u^{-1}$。
4. **忠实性应用于复合：** 由于 $F$ 是忠实的，
   $$
   F(g \circ f) = F(g) \circ F(f) = u^{-1} \circ u = \text{id}_{F(A)}
   $$
   而 $F(\text{id}_A) = \text{id}_{F(A)}$，因此 $g \circ f = \text{id}_A$。
5. **同理，$f \circ g = \text{id}_B$**
6. **结论：** $f$ 是 $A$ 和 $B$ 之间的同构箭头，且 $F(f) = u$。

**结论：** 满且忠实的函子不仅保留同构性，还能反映同构性，即在目标范畴中是同构的箭头，源范畴中必然也是同构的箭头。

### 3.3.11 推论：满且忠实函子反映同构性

**推论 3.3.11：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是满且忠实的函子。如果 $F(A) = F(B)$ 对于 $\mathcal{C}$ 中的对象 $A$ 和 $B$ 成立，则 $A$ 和 $B$ 在 $\mathcal{C}$ 中是同构的。

**证明：**
1. **应用命题 3.3.10：** 令 $u = \text{id}_{F(A)}: F(A) \rightarrow F(A)$。
2. **命题 3.3.10 保证：** 存在唯一的同构箭头 $f: A \rightarrow A$ 在 $\mathcal{C}$ 中，使得 $F(f) = \text{id}_{F(A)}$。
3. **当 $F(A) = F(B)$ 时：** $F(f): F(A) \rightarrow F(B)$ 是同构箭头 $\text{id}_{F(A)}$。
4. **因此，存在同构箭头 $f: A \rightarrow B$ 在 $\mathcal{C}$ 中，使得 $F(f) = u$，即 $F(f)$ 是 $\text{id}_{F(A)}$。
5. **结论：** $A$ 和 $B$ 在 $\mathcal{C}$ 中是同构的。

**结论：** 满且忠实的函子不仅反映同构性，还能通过函子的映射结果推导源范畴中对象的同构关系。

### 3.3.12 例子：满且忠实函子与同构性

**例子 3.3.12：** 考虑一个具体的满且忠实的函子 $F: \mathcal{C} \rightarrow \mathcal{D}$。

- **情况描述：**
  - 设 $F(A) = F(B)$ 对于对象 $A, B \in \mathcal{C}$。
  - 根据推论 3.3.11，存在同构箭头 $f: A \rightarrow B$ 使得 $F(f) = \text{id}_{F(A)}$。

- **具体示例：**
  - **半群范畴到集合范畴的底层函子 $U: \text{Sem} \rightarrow \text{Set}$：** 虽然 $U$ 是忠实的，但并不是满的，因此不满足推论 3.3.11 的条件。然而，若我们有一个满且忠实的函子 $F$，则可以应用此推论。

**进一步说明：**
- **满且忠实的函子在结构保留中的作用：** 这些函子在保持和反映源范畴结构方面具有重要作用，特别是在确认对象和箭头之间的同构关系时。

**结论：** 满且忠实的函子在确保源范畴和目标范畴之间结构的一致性方面起着关键作用，特别是在识别同构关系时。

---

## 总结

本节 **3.3 Types of Functors（函子的类型）** 深入探讨了函子的不同类型及其性质，包括同构函子、满函子、忠实函子、满且忠实函子等。通过具体的定义、例子和命题，您可以更清晰地理解这些函子的特性及其在范畴论中的重要性。

**关键点回顾：**

1. **同构函子：**
   - $F: \mathcal{C} \rightarrow \mathcal{D}$ 是同构函子当且仅当存在一个逆函子 $G$ 使得 $G \circ F = \text{id}_{\mathcal{C}}$ 且 $F \circ G = \text{id}_{\mathcal{D}}$。
   - 同构函子在对象和箭头上都是双射。

2. **忠实函子与满函子：**
   - **忠实函子（Faithful Functor）：** 在每个同类集合上，函子诱导的映射是单射的。
   - **满函子（Full Functor）：** 在每个同类集合上，函子诱导的映射是满射的。
   - **满且忠实函子（Fully Faithful Functor）：** 函子既是满的又是忠实的，保留和反映了源范畴的结构。

3. **保留性质的函子：**
   - 函子可以**保持**某些箭头的性质，如同构性、单射性等。
   - **保留同构性：** 所有函子都保留同构性，即同构箭头在目标范畴中仍然是同构箭头。

4. **反映性质的函子：**
   - **反映同构性：** 满且忠实的函子能够反映同构性，即如果目标范畴中的箭头是同构的，源范畴中的箭头也必须是同构的。

5. **具体例子：**
   - **底层函子 $U: \text{Mon} \rightarrow \text{Set}$：** 是忠实的但不满的，因为它保持箭头的区别性，但不覆盖所有可能的箭头。
   - **满且忠实函子：** 子范畴的包含函子通常是满且忠实的，能够反映源范畴中的同构关系。

**进一步学习建议：**

- **更深入的函子类型：** 探索更复杂的函子类型，如**左伴随函子**（left adjoint functors）和**右伴随函子**（right adjoint functors），了解它们在范畴论中的重要性和应用。
  
- **自然变换（Natural Transformations）：** 学习自然变换作为函子之间的“箭头”，理解范畴论中函子之间的关系和组合。

- **Yoneda 引理（Yoneda Lemma）：** 深入理解Yoneda引理及其在范畴论中的核心作用，尤其是在表示理论和同调代数中的应用。

通过对本节内容的深入学习，您将能够更全面地理解函子的多样性及其在不同范畴之间建立结构保持映射的能力。这不仅增强了对范畴论基础概念的掌握，也为进一步学习高级范畴论和其在数学及计算机科学中的应用打下了坚实的基础。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ----------------------------

好的，让我们继续详细解析您提供的章节 **3.3 Types of Functors（函子的类型）**，具体涵盖 **3.3.13** 和 **3.3.14** 小节。本节将探讨函子在保持和反映范畴中对象性质方面的特性，并通过一系列习题加深理解。

---

## 3.3 Types of Functors（函子的类型）

### 3.3.13 保持和反映对象性质的函子

**概念解释：**

函子不仅可以在箭头（态射）上保持或反映某些性质，还可以在对象（对象）上具有类似的特性。具体来说，函子可以**保持**或**反映**范畴中对象的某些性质。

**具体说明：**

- **保持性质（Preserving Properties）：** 如果一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 对于范畴 $\mathcal{C}$ 中具有某种性质的对象，在 $\mathcal{D}$ 中其像对象也具有相同的性质，则称 $F$ **保持**该性质。

- **反映性质（Reflecting Properties）：** 如果一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 对于 $\mathcal{D}$ 中具有某种性质的像对象，其源对象在 $\mathcal{C}$ 中也具有相同的性质，则称 $F$ **反映**该性质。

**例子说明：**

- **终端对象（Terminal Object）：**

  - **定义：** 在范畴 $\mathcal{C}$ 中，若对象 $T$ 对于所有对象 $A$，存在唯一的态射 $A \rightarrow T$，则 $T$ 是一个**终端对象**。
  
  - **例子：** 单子范畴 $\text{Mon}$ 中的终端对象是单元素单子，而集合范畴 $\text{Set}$ 中的终端对象也是单元素集合。
  
  - **保持与反映：**
    - **保持性：** 底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 将单子范畴中的终端对象映射为集合范畴中的终端对象。因此，$U$ **保持**终端对象。
    - **反映性：** 若 $U(M)$ 是集合范畴中的终端对象，则 $M$ 必须是单子范畴中的终端对象，因为单子必须至少有一个元素作为单位元。因此，$U$ 也**反映**终端对象。
  
- **初始对象（Initial Object）：**

  - **定义：** 在范畴 $\mathcal{C}$ 中，若对象 $I$ 对于所有对象 $A$，存在唯一的态射 $I \rightarrow A$，则 $I$ 是一个**初始对象**。
  
  - **例子：** 集合范畴 $\text{Set}$ 中的初始对象是空集。而单子范畴 $\text{Mon}$ 中没有初始对象，因为单子的底层集合至少需要一个元素作为单位元。
  
  - **保持与反映：**
    - **保持性：** 底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 不**保持**初始对象，因为 $\text{Mon}$ 中没有初始对象，而 $\text{Set}$ 中有空集。
    - **反映性：** 由于 $\text{Set}$ 中存在初始对象（空集），而 $\text{Mon}$ 中不存在，因此 $U$ **反映**初始对象，尽管这是一个平凡的反映（因为 $\text{Mon}$ 中没有初始对象，$U$ 无法将 $\text{Mon}$ 中的任何对象映射到 $\text{Set}$ 中的初始对象）。

**结论：**

函子在保持和反映对象性质方面具有重要作用。例如，底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 同时保持和反映终端对象，但仅反映初始对象。理解这些性质有助于分析函子在不同范畴间的行为及其对范畴结构的影响。

---

### 3.3.14 习题（Exercises）

以下是 **3.3.14** 小节中的习题，我们将逐一解析每个问题，提供解题思路和关键步骤。

#### 习题1：忠实函子在不同范畴中的含义

**题目：**

1. 函子在以下范畴之间是忠实的意味着什么？
   
   a. 它在单子确定的范畴之间。
   
   b. 它在偏序集确定的范畴之间。

**解答：**

**a. 单子范畴之间的忠实函子**

- **定义回顾：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是**忠实的**，如果对于每一对对象 $A, B \in \mathcal{C}$，诱导的映射
  $$
  \text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))
  $$
  是单射的。

- **在单子范畴中的解释：** 设 $\mathcal{C}$ 和 $\mathcal{D}$ 分别是单子范畴，忠实函子意味着：
  - 对于任意两个单子 $M, N$ 和两个单子同态 $f, g: M \rightarrow N$，若 $F(f) = F(g)$，则 $f = g$。
  - 换言之，函子 $F$ 能够区分不同的单子同态，不会将不同的同态映射到相同的箭头。

**b. 偏序集范畴之间的忠实函子**

- **定义回顾：** 在偏序集范畴中，箭头对应于单调映射。

- **解释：** 设 $\mathcal{C}$ 和 $\mathcal{D}$ 分别是偏序集范畴，忠实函子意味着：
  - 对于任意两个偏序集 $P, Q$ 和两个单调映射 $f, g: P \rightarrow Q$，若 $F(f) = F(g)$，则 $f = g$。
  - 换言之，函子 $F$ 保持单调映射的区别性，不会将不同的单调映射映射到相同的箭头。

**总结：**

忠实函子在不同范畴中的具体含义取决于这些范畴中的箭头类型。在单子范畴和偏序集范畴中，忠实函子分别保证了单子同态和单调映射的区别性。

---

#### 习题2：满函子在不同范畴中的含义

**题目：**

2. 对于与习题1相同的问题，讨论函子是**满**的意味着什么？

**解答：**

**a. 单子范畴之间的满函子**

- **定义回顾：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是**满**的，如果对于每一对对象 $A, B \in \mathcal{C}$，诱导的映射
  $$
  \text{Hom}_{\mathcal{C}}(A, B) \rightarrow \text{Hom}_{\mathcal{D}}(F(A), F(B))
  $$
  是满射的。

- **在单子范畴中的解释：** $F$ 是满的意味着：
  - 对于任何两个单子 $M, N$，以及任何单子同态 $h: F(M) \rightarrow F(N)$，存在一个单子同态 $f: M \rightarrow N$ 使得 $F(f) = h$。
  - 换言之，函子 $F$ 的像覆盖了 $\mathcal{D}$ 中所有可能的单子同态。

**b. 偏序集范畴之间的满函子**

- **定义回顾：** 在偏序集范畴中，箭头对应于单调映射。

- **解释：** $F$ 是满的意味着：
  - 对于任意两个偏序集 $P, Q$，以及任何单调映射 $h: F(P) \rightarrow F(Q)$，存在一个单调映射 $f: P \rightarrow Q$ 使得 $F(f) = h$。
  - 换言之，函子 $F$ 的像覆盖了 $\mathcal{D}$ 中所有可能的单调映射。

**总结：**

满函子保证了目标范畴中的所有箭头（单子同态或单调映射）都可以通过源范畴中的箭头映射得到。这在构建范畴间的“覆盖”关系时非常重要。

---

#### 习题3：底层函子从单子范畴到集合范畴是否满？

**题目：**

3. 底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 是满的吗？

**解答：**

**解答过程：**

- **定义回顾：** 底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 将每个单子映射到其底层集合，并将单子同态映射为对应的集合函数。

- **判断满性：** $U$ 是满的，当且仅当对于任何两个单子 $M, N$ 和任何集合函数 $f: U(M) \rightarrow U(N)$，如果 $f$ 是单子同态，则存在单子同态 $g: M \rightarrow N$ 使得 $U(g) = f$。

- **分析：**
  - **存在性问题：** 并非所有集合函数 $f: U(M) \rightarrow U(N)$ 都是单子同态。例如，$f$ 可能不保留单子运算。
  - **结论：** 因此，底层函子 $U$ **不是满的**，因为只有那些保留单子结构的集合函数才能通过 $U$ 被映射，而不是所有的集合函数都满足这一条件。

**总结：**

底层函子 $U: \text{Mon} \rightarrow \text{Set}$ 不是满的，因为它不能将所有的集合函数映射为单子同态。只有那些保留单子运算的函数才能被视为单子同态并被映射。

---

#### 习题4：自由单子函子是否忠实和满？

**题目：**

4. 自由单子函子 $F: \text{Set} \rightarrow \text{Mon}$ 是忠实的吗？是满的吗？

**解答：**

**解答过程：**

- **自由单子函子定义：** $F: \text{Set} \rightarrow \text{Mon}$ 将每个集合 $A$ 映射为其自由单子 $A^*$，即所有有限长度的字符串（包括空字符串）组成的单子，运算为字符串连接。对于每个函数 $f: A \rightarrow B$，$F(f): A^* \rightarrow B^*$ 定义为：
  $$
  F(f)(a_1a_2 \cdots a_n) = f(a_1)f(a_2) \cdots f(a_n)
  $$

- **忠实性判断：**
  - **定义回顾：** 函子是忠实的，当且仅当对于任何两个集合 $A, B$ 和两个不同的函数 $f, g: A \rightarrow B$，有 $F(f) \neq F(g)$。
  - **分析：** 如果 $f \neq g$，则存在 $a \in A$ 使得 $f(a) \neq g(a)$。因此，对于字符串 $a$（长度为1），$F(f)(a) = f(a) \neq g(a) = F(g)(a)$，即 $F(f) \neq F(g)$。
  - **结论：** 自由单子函子 $F$ 是**忠实的**。

- **满性判断：**
  - **定义回顾：** 函子是满的，当且仅当对于任何两个自由单子 $A^*, B^*$ 和任何单子同态 $h: A^* \rightarrow B^*$，存在一个函数 $f: A \rightarrow B$ 使得 $F(f) = h$。
  - **分析：**
    - **自由单子同态的性质：** 单子同态 $h: A^* \rightarrow B^*$ 完全由函数 $f: A \rightarrow B$ 决定，即 $h(a_1a_2 \cdots a_n) = f(a_1)f(a_2) \cdots f(a_n)$。
    - **存在性：** 对于每个单子同态 $h$，存在唯一的函数 $f: A \rightarrow B$ 使得 $F(f) = h$。
  - **结论：** 自由单子函子 $F$ 是**满的**。

**总结：**

自由单子函子 $F: \text{Set} \rightarrow \text{Mon}$ 同时是**忠实**和**满**的。这意味着它不仅能够区分不同的集合函数，还能覆盖所有可能的自由单子同态。

---

#### 习题5：幂集函子是否忠实和满？

**题目：**

5. 证明幂集函子是忠实的但不是满的。

**解答：**

**解答过程：**

- **幂集函子定义：** 幂集函子 $P: \text{Set}^{\text{op}} \rightarrow \text{Set}$ 定义如下：
  - **对象映射：** $P(S)$ 是集合 $S$ 的幂集，即所有子集的集合。
  - **箭头映射：** 对于每个函数 $f: A \rightarrow B$，$P(f): P(B) \rightarrow P(A)$ 定义为逆像函数：
    $$
    P(f)(C) = f^{-1}(C) = \{ a \in A \mid f(a) \in C \}
    $$

- **忠实性判断：**
  - **定义回顾：** 函子是忠实的，当且仅当对于任何两个函数 $f, g: A \rightarrow B$，若 $P(f) = P(g)$，则 $f = g$。
  - **分析：** 如果 $f \neq g$，则存在 $a \in A$ 使得 $f(a) \neq g(a)$。考虑 $C = \{ f(a) \}$，则 $P(f)(C) = \{ a \}$，而 $P(g)(C)$ 要么是空集（如果 $g(a) \notin C$），要么也是 $\{ a \}$（如果 $g(a) \in C$）。如果 $g(a) \notin C$，则 $P(f) \neq P(g)$。若 $g(a) \in C$，则 $f(a) = g(a)$，与 $f \neq g$ 矛盾。因此，$P(f) \neq P(g)$。
  - **结论：** 幂集函子 $P$ 是**忠实的**。

- **满性判断：**
  - **定义回顾：** 函子是满的，当且仅当对于任何两个集合 $A, B$，以及任何函数 $h: P(B) \rightarrow P(A)$，存在一个函数 $f: A \rightarrow B$ 使得 $P(f) = h$。
  - **分析：**
    - **存在性问题：** 幂集函子将每个函数 $f: A \rightarrow B$ 映射为逆像函数 $P(f): P(B) \rightarrow P(A)$。并非所有的函数 $h: P(B) \rightarrow P(A)$ 都是逆像函数。
    - **举例说明：** 设 $A = \{1\}$，$B = \{a, b\}$，考虑一个函数 $h: P(B) \rightarrow P(A)$，定义为 $h(\emptyset) = \emptyset$, $h(\{a\}) = \emptyset$, $h(\{b\}) = \{1\}$, $h(\{a, b\}) = \{1\}$。这个函数不是任何逆像函数 $P(f)$ 的形式，因为逆像函数要么将某个子集映射为所有元素的逆像，要么保持空集不变。
  - **结论：** 幂集函子 $P$ **不是满的**。

**总结：**

幂集函子 $P: \text{Set}^{\text{op}} \rightarrow \text{Set}$ 是**忠实的**，因为它能够区分不同的函数。然而，它**不是满的**，因为并非所有集合函数都是幂集函子的像。

---

#### 习题6：关系范畴 $\text{Rel}$ 与其自身的对偶范畴是否同构？

**题目：**

6. 证明关系范畴 $\text{Rel}$ 同构于其自身的对偶范畴。

**解答：**

**解答过程：**

- **关系范畴 $\text{Rel}$：**
  - **对象：** 任意集合。
  - **箭头：** 任意关系 $R \subseteq A \times B$。
  - **复合：** 对于关系 $R: A \rightarrow B$ 和 $S: B \rightarrow C$，复合 $S \circ R$ 定义为：
    $$
    S \circ R = \{ (a, c) \mid \exists b \in B, (a, b) \in R \text{ and } (b, c) \in S \}
    $$
  - **对偶范畴 $\text{Rel}^{\text{op}}$：** 保持对象不变，但箭头方向反转，即箭头从 $B$ 到 $A$ 的关系。

- **同构证明：**
  - **定义同构函子 $F: \text{Rel} \rightarrow \text{Rel}^{\text{op}}$：**
    - **对象映射：** 恒等映射，即 $F(A) = A$。
    - **箭头映射：** 对于关系 $R: A \rightarrow B$，定义 $F(R) = R^{\text{op}} \subseteq B \times A$，即逆关系。
  
  - **逆函子 $G: \text{Rel}^{\text{op}} \rightarrow \text{Rel}$：**
    - **对象映射：** 恒等映射，即 $G(B) = B$。
    - **箭头映射：** 对于关系 $S: B \rightarrow A$（在 $\text{Rel}^{\text{op}}$ 中），定义 $G(S) = S^{\text{op}} \subseteq A \times B$。
  
  - **验证同构条件：**
    - **$G \circ F = \text{id}_{\text{Rel}}$：**
      $$
      (G \circ F)(R) = G(F(R)) = G(R^{\text{op}}) = (R^{\text{op}})^{\text{op}} = R
      $$
    
    - **$F \circ G = \text{id}_{\text{Rel}^{\text{op}}}$：**
      $$
      (F \circ G)(S) = F(G(S)) = F(S^{\text{op}}) = (S^{\text{op}})^{\text{op}} = S
      $$
    
    - **结论：** 函子 $F$ 和 $G$ 互为逆函子，因此 $\text{Rel}$ 同构于其自身的对偶范畴 $\text{Rel}^{\text{op}}$。

**总结：**

关系范畴 $\text{Rel}$ 与其自身的对偶范畴 $\text{Rel}^{\text{op}}$ 是同构的。这表明在关系范畴中，关系的逆关系提供了对偶范畴中的箭头映射，从而实现了范畴之间的同构关系。

---

#### 习题7：群oid 同构于其自身的对偶范畴

**题目：**

7. 证明群oid（见习题11）同构于其自身的对偶范畴。

**解答：**

**解答过程：**

- **群oid 定义：** 群oid 是一种特殊的范畴，其中每个箭头都是同构的。即，对于每个箭头 $f: A \rightarrow B$，存在一个逆箭头 $f^{-1}: B \rightarrow A$，使得 $f \circ f^{-1} = \text{id}_B$ 和 $f^{-1} \circ f = \text{id}_A$。

- **对偶范畴：** 对于任意范畴 $\mathcal{C}$，其对偶范畴 $\mathcal{C}^{\text{op}}$ 具有相同的对象，但箭头方向相反。

- **证明群oid 同构于其自身的对偶范畴：**
  - **定义同构函子 $F: \mathcal{G} \rightarrow \mathcal{G}^{\text{op}}$：**
    - **对象映射：** 恒等映射，即 $F(A) = A$。
    - **箭头映射：** 对于箭头 $f: A \rightarrow B$，定义 $F(f) = f^{-1}: B \rightarrow A$。
  
  - **逆函子 $G: \mathcal{G}^{\text{op}} \rightarrow \mathcal{G}$：**
    - **对象映射：** 恒等映射，即 $G(B) = B$。
    - **箭头映射：** 对于箭头 $g: B \rightarrow A$（在 $\mathcal{G}^{\text{op}}$ 中），定义 $G(g) = g^{-1}: A \rightarrow B$。
  
  - **验证同构条件：**
    - **$G \circ F = \text{id}_{\mathcal{G}}$：**
      $$
      (G \circ F)(f) = G(F(f)) = G(f^{-1}) = (f^{-1})^{-1} = f
      $$
    
    - **$F \circ G = \text{id}_{\mathcal{G}^{\text{op}}}$：**
      $$
      (F \circ G)(g) = F(G(g)) = F(g^{-1}) = (g^{-1})^{-1} = g
      $$
    
    - **结论：** 函子 $F$ 和 $G$ 互为逆函子，因此群oid 同构于其自身的对偶范畴。

**总结：**

群oid 作为一种特殊的范畴，其中每个箭头都是同构的，因此其对偶范畴中的箭头可以通过取逆关系自然地映射回原范畴中的箭头。这使得群oid 同构于其自身的对偶范畴。

---

#### 习题8：在 $\text{Cat}$ 中，习题2.9.3的例子是单子范畴中的射影函子

**题目：**

8. 证明习题2.9.3中的例子在 $\text{Cat}$ 中是一个射影（epimorphism），即使在 $\text{Cat}$ 中单子范畴的射影不一定是满射。

**解答：**

**解答过程：**

- **背景知识：** 在范畴 $\text{Cat}$ 中，单子范畴 $\text{Mon}$ 可以视为一个子范畴。习题2.9.3中的例子涉及单子同态，且这些同态在 $\text{Cat}$ 中被视为范畴的箭头。

- **射影的定义：** 在范畴 $\mathcal{C}$ 中，射影（epimorphism）是指对于任意两个箭头 $g, h: D \rightarrow E$，若 $g \circ f = h \circ f$，则 $g = h$。

- **证明步骤：**
  1. **设 $F: \mathcal{C} \rightarrow \text{Cat}$ 是一个函子，涉及单子同态。**
  2. **具体化习题2.9.3的例子：** 设 $f: M \rightarrow N$ 是一个单子同态，并在 $\text{Cat}$ 中作为函子 $F(f)$ 的箭头。
  3. **验证 $F(f)$ 是射影：** 假设 $g, h: F(N) \rightarrow F(O)$ 满足 $g \circ F(f) = h \circ F(f)$，需要证明 $g = h$。
  4. **由于 $F$ 是一个函子，将单子同态映射为范畴中的函子。**
  5. **利用单子同态的性质，若 $g \circ f = h \circ f$ 在单子同态上成立，则 $g = h$，因为 $f$ 是射影。**
  
- **结论：** 因此，习题2.9.3中的例子在 $\text{Cat}$ 中是一个射影。

**总结：**

尽管在 $\text{Cat}$ 中，单子范畴的射影不一定是满射，但通过具体的例子分析，可以证明某些特定的单子同态在 $\text{Cat}$ 中仍然是射影。这展示了射影在不同范畴中的多样性和复杂性。

---

#### 习题9：每个函子都保持分裂单射和分裂射影

**题目：**

9. 证明每个函子保持**分裂单射**（split monos）和**分裂射影**（split epis）。

**解答：**

**解答过程：**

- **定义回顾：**
  - **分裂单射（Split Mono）：** 一个箭头 $f: A \rightarrow B$ 是分裂单射的，如果存在箭头 $g: B \rightarrow A$ 使得 $g \circ f = \text{id}_A$。
  - **分裂射影（Split Epi）：** 一个箭头 $f: A \rightarrow B$ 是分裂射影的，如果存在箭头 $g: B \rightarrow A$ 使得 $f \circ g = \text{id}_B$。

- **函子保持性质的定义：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ **保持**性质 $P$（如分裂单射和分裂射影），如果 $f$ 具有性质 $P$ 则 $F(f)$ 也具有性质 $P$。

- **证明步骤：**
  1. **保持分裂单射：**
     - 设 $f: A \rightarrow B$ 是分裂单射，即存在 $g: B \rightarrow A$ 使得 $g \circ f = \text{id}_A$。
     - 应用函子 $F$，得到：
       $$
       F(g) \circ F(f) = F(g \circ f) = F(\text{id}_A) = \text{id}_{F(A)}
       $$
     - 因此，$F(f)$ 也是分裂单射，具有左逆 $F(g)$。

  2. **保持分裂射影：**
     - 设 $f: A \rightarrow B$ 是分裂射影，即存在 $g: B \rightarrow A$ 使得 $f \circ g = \text{id}_B$。
     - 应用函子 $F$，得到：
       $$
       F(f) \circ F(g) = F(f \circ g) = F(\text{id}_B) = \text{id}_{F(B)}
       $$
     - 因此，$F(f)$ 也是分裂射影，具有右逆 $F(g)$。

- **结论：** 每个函子 $F$ 都保持分裂单射和分裂射影，因为函子保留箭头的复合和恒等箭头的性质。

**总结：**

通过验证函子对分裂单射和分裂射影的保持性，可以得出所有函子都保持这两种性质。这是因为函子保持箭头的复合和恒等箭头，从而确保了分裂单射和分裂射影的特性得以保留。

---

#### 习题10：底层函子对初始和终端对象的保持与反映

**题目：**

10. 

a. 底层函子从半群范畴 $\text{Sem}$ 到集合范畴 $\text{Set}$ 是否保持或反映初始对象？终端对象呢？

b. 对于从图范畴 $\text{Grf}$ 到集合范畴 $\text{Set}$ 的底层函子 $U: \text{Cat} \rightarrow \text{Grf}$，是否保持或反映初始对象？终端对象？

**解答：**

**a. 底层函子从半群范畴 $\text{Sem}$ 到集合范畴 $\text{Set}$**

- **初始对象：**
  - **半群范畴 $\text{Sem}$ 中的初始对象：** $\text{Sem}$ 中没有初始对象，因为没有一个半群能够唯一地映射到所有其他半群（没有空半群）。
  - **集合范畴 $\text{Set}$ 中的初始对象：** 空集 $\emptyset$。
  - **保持与反映：**
    - **保持性：** 因为 $\text{Sem}$ 中没有初始对象，底层函子无法保持初始对象。
    - **反映性：** 如果 $U(M)$ 是集合范畴中的初始对象 $\emptyset$，则 $M$ 必须是 $\text{Sem}$ 中的初始对象，但 $\text{Sem}$ 中没有初始对象。因此，底层函子**反映**初始对象，尽管这种反映是平凡的。

- **终端对象：**
  - **半群范畴 $\text{Sem}$ 中的终端对象：** 单元素半群。
  - **集合范畴 $\text{Set}$ 中的终端对象：** 单元素集合。
  - **保持与反映：**
    - **保持性：** 底层函子将 $\text{Sem}$ 中的单元素半群映射为 $\text{Set}$ 中的单元素集合，因此 $U$ **保持**终端对象。
    - **反映性：** 如果 $U(M)$ 是集合范畴中的终端对象（单元素集合），则 $M$ 必须是 $\text{Sem}$ 中的单元素半群，因此 $U$ **反映**终端对象。

**b. 底层函子从图范畴 $\text{Grf}$ 到集合范畴 $\text{Set}$ 的函子 $U: \text{Cat} \rightarrow \text{Grf}$**

- **初始对象：**
  - **图范畴 $\text{Grf}$ 中的初始对象：** 空图。
  - **类别范畴 $\text{Cat}$ 中的初始对象：** 空范畴。
  - **保持与反映：**
    - **保持性：** 空范畴映射为空图，满足保持初始对象。
    - **反映性：** 如果 $U(C)$ 是图范畴中的初始对象（空图），则 $C$ 必须是 $\text{Cat}$ 中的初始对象（空范畴）。因此，$U$ **反映**初始对象。

- **终端对象：**
  - **图范畴 $\text{Grf}$ 中的终端对象：** 单节点无箭头图。
  - **类别范畴 $\text{Cat}$ 中的终端对象：** 单对象单箭头范畴（只有恒等箭头）。
  - **保持与反映：**
    - **保持性：** 单对象单箭头范畴映射为单节点无箭头图，符合图范畴中终端对象的定义，因此 $U$ **保持**终端对象。
    - **反映性：** 如果 $U(C)$ 是图范畴中的终端对象，则 $C$ 必须是 $\text{Cat}$ 中的终端对象。因此，$U$ **反映**终端对象。

**总结：**

- **从 $\text{Sem}$ 到 $\text{Set}$ 的底层函子：** 保持并反映终端对象，但不保持初始对象，尽管它反映初始对象（因 $\text{Sem}$ 中无初始对象）。
- **从 $\text{Cat}$ 到 $\text{Grf}$ 的底层函子 $U$：** 同时保持并反映初始对象和终端对象。

---

#### 习题11：对于任意范畴 $\mathcal{C}$ 和对象 $A$，Hom函子是否保持终端对象？

**题目：**

11. 证明对于任意范畴 $\mathcal{C}$ 和对象 $A$ ，Hom函子 $\text{Hom}(A, -): \mathcal{C} \rightarrow \text{Set}$ 保持终端对象。

**解答：**

**解答过程：**

- **定义回顾：** Hom函子 $\text{Hom}(A, -): \mathcal{C} \rightarrow \text{Set}$ 定义为：
  - **对象映射：** 对于每个对象 $B \in \mathcal{C}$，有 $\text{Hom}(A, B)$。
  - **箭头映射：** 对于每个箭头 $f: B \rightarrow C$，有 $\text{Hom}(A, f): \text{Hom}(A, B) \rightarrow \text{Hom}(A, C)$，定义为 $g \mapsto f \circ g$。

- **终端对象定义：** 在集合范畴 $\text{Set}$ 中，终端对象是单元素集合 $\{*\}$。

- **证明步骤：**
  1. **设 $T$ 是 $\mathcal{C}$ 中的终端对象。**
  2. **Hom函子作用下的终端对象：**
     $$
     \text{Hom}(A, T)
     $$
     - **唯一性：** 由于 $T$ 是终端对象，对于任意对象 $A$，存在唯一的箭头 $A \rightarrow T$。
     - **集合结构：** 因此，$\text{Hom}(A, T)$ 是一个单元素集合。
  3. **结论：** $\text{Hom}(A, T)$ 是 $\text{Set}$ 中的终端对象。
  4. **保持性：** 因此，Hom函子 $\text{Hom}(A, -)$ 将 $\mathcal{C}$ 中的终端对象 $T$ 映射为 $\text{Set}$ 中的终端对象 $\{*\}$。

**总结：**

对于任意范畴 $\mathcal{C}$ 和对象 $A$，Hom函子 $\text{Hom}(A, -)$ **保持终端对象**，因为它将 $\mathcal{C}$ 中的终端对象映射为 $\text{Set}$ 中的单元素集合。

---

#### 习题12：切片范畴的等价性

**题目：**

12. 设 $\mathcal{C}$ 是一个范畴，箭头 $f: B \rightarrow A$ 属于 $\mathcal{C}$。证明切片范畴 $(\mathcal{C} / A) / f$ 同构于切片范畴 $\mathcal{C} / B$。即，“切片的切片是切片”。

**解答：**

**解答过程：**

- **定义回顾：**
  - **切片范畴 $\mathcal{C} / A$：** 对象是箭头 $g: C \rightarrow A$，箭头是满足 $h \circ g = g'$ 的箭头 $h: C \rightarrow C'$。
  - **切片的切片 $(\mathcal{C} / A) / f$：** 对象是箭头 $g: C \rightarrow A$ 以及箭头 $h: C \rightarrow B$ 满足 $f \circ h = g$。
  - **切片范畴 $\mathcal{C} / B$：** 对象是箭头 $k: D \rightarrow B$，箭头是满足 $l \circ k = k'$ 的箭头 $l: D \rightarrow D'$。

- **构造同构函子：**
  - **函子 $F: (\mathcal{C} / A) / f \rightarrow \mathcal{C} / B$：**
    - **对象映射：** 对象 $(g: C \rightarrow A, h: C \rightarrow B)$ 映射为箭头 $h: C \rightarrow B$。
    - **箭头映射：** 对于箭头 $\phi: (g: C \rightarrow A, h: C \rightarrow B) \rightarrow (g': C' \rightarrow A, h': C' \rightarrow B)$，满足 $g' \circ \phi = g$ 和 $h' \circ \phi = h$，映射为箭头 $\phi: C \rightarrow C'$ 在 $\mathcal{C} / B$ 中。
  
  - **逆函子 $G: \mathcal{C} / B \rightarrow (\mathcal{C} / A) / f$：**
    - **对象映射：** 对象 $k: D \rightarrow B$ 映射为 $(f \circ k: D \rightarrow A, k: D \rightarrow B)$。
    - **箭头映射：** 对于箭头 $l: D \rightarrow D'$ 在 $\mathcal{C} / B$，映射为箭头 $l: (f \circ k: D \rightarrow A, k: D \rightarrow B) \rightarrow (f \circ k': D' \rightarrow A, k': D' \rightarrow B)$，即 $l$ 自身。

- **验证函子性质：**
  1. **函子复合：**
     - **$G \circ F$：** 对象 $(g, h)$ 映射为 $h$，再映射为 $(f \circ h, h)$，由于 $f \circ h = g$，因此 $G \circ F$ 是恒等函子。
     - **$F \circ G$：** 对象 $k$ 映射为 $(f \circ k, k)$，再映射为 $k$，因此 $F \circ G$ 是恒等函子。
  
  2. **箭头保持：** $F$ 和 $G$ 保持箭头的复合和恒等性，因为它们直接映射箭头自身。

- **结论：** 函子 $F$ 和 $G$ 是互为逆函子的同构函子，因此切片范畴 $(\mathcal{C} / A) / f$ 同构于切片范畴 $\mathcal{C} / B$。

**总结：**

通过构造互为逆函子的同构函子，可以证明对于任意范畴 $\mathcal{C}$ 和箭头 $f: B \rightarrow A$，切片的切片 $(\mathcal{C} / A) / f$ 同构于切片范畴 $\mathcal{C} / B$。这体现了切片范畴的结构稳定性和层次性。

---

## 总结

本节 **3.3 Types of Functors（函子的类型）** 探讨了函子的多种类型及其在保持和反映范畴中对象和箭头性质方面的特性。通过具体的定义、例子和习题解析，您可以深入理解以下关键概念：

1. **忠实函子与满函子：**
   - **忠实函子（Faithful Functor）：** 保持箭头的区别性，确保不同的箭头在目标范畴中有不同的像。
   - **满函子（Full Functor）：** 覆盖目标范畴中所有可能的箭头，使每个目标箭头都是源范畴中某个箭头的像。
   - **满且忠实函子（Fully Faithful Functor）：** 同时满足忠实和满的性质，能够完美地反映源范畴与目标范畴之间的结构关系。

2. **保持与反映性质：**
   - **保持性：** 函子将源范畴中具有某种性质的对象或箭头映射为目标范畴中具有相同性质的对象或箭头。
   - **反映性：** 如果目标范畴中的像对象或箭头具有某种性质，则源范畴中的原对象或箭头也具有该性质。

3. **具体例子与应用：**
   - **底层函子（Underlying Functors）：** 例如，$U: \text{Mon} \rightarrow \text{Set}$ 是忠实的但不满的，展示了函子在不同范畴间如何保持或不保持性质。
   - **Hom函子（Hom Functors）：** $\text{Hom}(A, -)$ 函子保持终端对象，展示了函子在对象性质上的保持能力。
   - **关系范畴与群oid：** 通过具体例子，如 $\text{Rel}$ 与其对偶范畴的同构，和群oid 与其对偶范畴的同构，理解函子在不同结构间的映射特性。

4. **习题的作用：**
   - **巩固理解：** 通过习题，您可以实践如何应用函子的定义和性质，验证不同类型函子的特性。
   - **深化分析：** 习题涉及具体的函子构造和性质验证，帮助您更深入地理解函子在范畴论中的应用。

**进一步学习建议：**

- **自然变换（Natural Transformations）：** 探索函子之间的自然变换，理解函子间的关系和组合。
- **伴随函子（Adjoint Functors）：** 学习伴随函子的概念及其在范畴论中的重要性，特别是在各种数学结构间建立桥梁。
- **Yoneda 引理（Yoneda Lemma）：** 深入理解Yoneda引理，它是范畴论中的核心结果，揭示了函子与对象之间的深刻联系。
- **高阶范畴论（Higher Category Theory）：** 进一步研究2-范畴、∞-范畴等高级范畴结构，扩展对范畴论的理解和应用范围。

通过系统学习和练习，您将能够熟练掌握函子的多种类型及其在数学和计算机科学中的广泛应用。如果您在学习过程中遇到任何疑问或需要进一步的解释和例子，请随时提问！

### ---------------------------

好的，让我们继续详细解析您提供的章节 **3.4 Equivalences（等价性）**。本节将探讨**范畴等价**的概念，解释为什么等价性比范畴同构更为宽松且更符合范畴论的精神。我们将通过具体的定义、例子以及相关的命题来深入理解这一重要概念。

---

## 3.4 Equivalences（等价性）

在本节中，我们将定义**范畴等价**的概念。范畴等价是一种比要求范畴同构更为宽松的关系，允许两类在结构上“本质相同”但可能在具体表现上有所不同。理解这一概念需要先回顾如何将单子视为具有一个对象的范畴，以及函子在这一构造中的作用。

### 3.4.1 单子与单对象范畴（Monoids and One-Object Categories）

**概念解释：**

在**2.3.12节**中，我们为每个单子 $M$ 构造了一个小范畴 $C(M)$。这里，我们选择了 $C(M)$ 的唯一对象就是 $M$ 自身。虽然 $C(M)$ 中的元素现在被视为从 $M$ 到 $M$ 的箭头，但它们并不是集合上的函数。

**具体说明：**

- **单子对应的范畴 $C(M)$：**
  - **对象：** 只有一个对象，记为 $M$。
  - **箭头：** 单子 $M$ 的元素作为从 $M$ 到 $M$ 的箭头。即，每个 $m \in M$ 对应一个箭头 $m: M \rightarrow M$。
  - **复合与恒等：** 箭头的复合对应单子的运算，恒等箭头对应单子的单位元。

- **单子同态对应的函子 $C(h)$：**
  - 对于每个单子同态 $h: M \rightarrow N$，构造一个函子 $C(h): C(M) \rightarrow C(N)$：
    - **对象映射 $C(h)$ ：** 将 $C(M)$ 的唯一对象 $M$ 映射为 $C(N)$ 的唯一对象 $N$。
    - **箭头映射 $C(h)$ ：** 对于每个箭头 $m: M \rightarrow M$（即每个 $m \in M$），$C(h)(m) = h(m): N \rightarrow N$。

**范畴构造：**

- **函子 $C$：** 这构造过程实际上定义了一个函子 $C: \text{Mon} \rightarrow \text{Ooc}$，其中 $\text{Ooc}$ 是**单对象范畴**（one-object categories）的满子范畴。
- **逆向函子 $U$：** 还有一个函子 $U: \text{Ooc} \rightarrow \text{Mon}$，其定义如下：
  - **对象映射 $U$ ：** 对于一个具有一个对象的范畴 $C$，$U(C)$ 是 $C$ 中箭头集构成的单子，运算为范畴中的箭头复合。
  - **箭头映射 $U$ ：** 对于范畴 $C$ 中的函子 $F: C(M) \rightarrow C(N)$，$U(F)$ 是单子同态 $h: M \rightarrow N$ ，即 $F$ 在箭头上的作用。

**构造性质：**

- **非逆性：** 尽管 $C$ 和 $U$ 是函子，但它们并不是互为逆函子。具体来说：
  - $C \circ U \neq \text{id}_{\text{Ooc}}$：因为在构造 $C(M)$ 时选择了 $M$ 作为唯一对象，而 $U(C)$ 是一个单子，不一定等同于原来的范畴 $C$。
  - $U \circ C = \text{id}_{\text{Mon}}$：确实成立，因为 $U(C(M)) = M$。
- **构造的任意性：** 在构造 $C(M)$ 时，我们选择了单子 $M$ 自身作为唯一对象，但实际上也可以选择其他方式（如选择一个与 $M$ 无关的对象）来避免集合论中的自引用问题。

**结论：**

单子与单对象范畴之间的这种对应关系揭示了范畴同构与等价之间的区别。尽管 $C$ 和 $U$ 不是逆函子，但通过范畴等价的概念，我们可以更准确地描述它们之间的“本质相同”关系。

### 3.4.2 定义（Definition）

**定义 3.4.2：** 一个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是**范畴等价**（equivalence of categories）的，当且仅当存在以下条件：

- **E–1：** 存在一个函子 $G: \mathcal{D} \rightarrow \mathcal{C}$。
- **E–2：** 存在一个对象 $C$ 的同构箭头族 $u_C: C \rightarrow G(F(C))$，对于每个 $C \in \mathcal{C}$，满足对于任何箭头 $f: C \rightarrow C'$ 的关系：
  $$
  G(F(f)) = u_{C'} \circ f \circ u_C^{-1}
  $$
- **E–3：** 存在一个对象 $D$ 的同构箭头族 $v_D: D \rightarrow F(G(D))$，对于每个 $D \in \mathcal{D}$，满足对于任何箭头 $g: D \rightarrow D'$ 的关系：
  $$
  F(G(g)) = v_{D'} \circ g \circ v_D^{-1}
  $$

**说明：**

- **伪逆函子（Pseudo-inverse Functor）：** 当 $F$ 是等价函子时，$G$ 被称为 $F$ 的**伪逆函子**。
- **自然同构（Natural Isomorphism）：** $u$ 和 $v$ 是自然同构（natural isomorphism），即它们的箭头 $u_C$ 和 $v_D$ 组成了从恒等函子到 $G \circ F$ 和从 $F \circ G$ 到恒等函子的自然变换。
- **核心思想：** 函子 $F$ 不仅要“涵盖” $\mathcal{D}$ 中的对象，还要确保这些对象通过 $F$ 的像被 $G$ 回到 $\mathcal{C}$，并且这些映射是相互兼容的。

**结论：**

范畴等价的定义捕捉了两类在“行为”上本质相同但在具体实现上可能不同的关系。它比范畴同构更为宽松，因为不要求 $F$ 和 $G$ 是严格的逆函子，只需要它们在本质上能够互相“恢复”源范畴和目标范畴的结构。

### 3.4.3 例子（Example）

**例子 3.4.3：**

设 $C$ 是一个包含两个对象 $A$ 和 $B$，以及它们之间的箭头 $i: A \rightarrow B$ 和 $j: B \rightarrow A$，满足 $i$ 和 $j$ 是互为逆同构的箭头。具体构造如下：

```
    i: A → B
    j: B → A
```

即 $i \circ j = \text{id}_B$ 和 $j \circ i = \text{id}_A$。

设 $D = 1$ 是只有一个对象 $E$ 和它的恒等箭头的范畴。我们声称 $C$ 和 $D$ 是等价范畴。

**构造函子：**

- **函子 $F: C \rightarrow D$：**
  - **对象映射：** $F(A) = E$ 和 $F(B) = E$。
  - **箭头映射：** 所有箭头 $i: A \rightarrow B$ 和 $j: B \rightarrow A$ 都映射为 $\text{id}_E: E \rightarrow E$。

- **伪逆函子 $G: D \rightarrow C$：**
  - **对象映射：** $G(E) = A$。
  - **箭头映射：** $G(\text{id}_E) = \text{id}_A: A \rightarrow A$。

**构造同构箭头族：**

- **对于 $E \in D$：**
  - **$u_E: E \rightarrow G(F(E)) = G(E) = A$：** 由于 $D$ 中只有一个对象 $E$，定义 $u_E = \text{id}_A$。
  
- **对于 $A \in C$：**
  - **$u_A: A \rightarrow G(F(A)) = G(E) = A$：** 设 $u_A = \text{id}_A$。
  
- **对于 $B \in C$：**
  - **$u_B: B \rightarrow G(F(B)) = G(E) = A$：** 设 $u_B = j: B \rightarrow A$。

**验证等价性条件：**

1. **满性与忠实性：**
   - **$F$ 是满且忠实的：** 对于任意箭头 $f: C \rightarrow C'$ 和 $g: D \rightarrow D'$，由于 $D$ 中只有一个箭头 $\text{id}_E$，函子 $F$ 将所有箭头映射为 $\text{id}_E$，满足满且忠实的条件。

2. **同构箭头族的性质：**
   - **对于每个 $A \in C$：** 
     $$
     G(F(i)) = G(\text{id}_E) = \text{id}_A = j \circ i \circ \text{id}_A = u_B \circ i \circ u_A^{-1}
     $$
   - **类似地，其他箭头的性质也满足。**

**结论：**

通过构造函子 $F$ 和 $G$，并定义合适的同构箭头族 $u$ 和 $v$，我们证明了范畴 $C$ 和 $D$ 是等价的。具体来说，虽然 $C$ 有两个对象 $A$ 和 $B$，而 $D$ 只有一个对象 $E$，但通过等价函子 $F$ 和 $G$，我们可以在“行为”上将它们视为等价范畴。

---

## 总结

本节 **3.4 Equivalences（等价性）** 介绍了**范畴等价**的概念，强调了它比范畴同构更为宽松且更符合范畴论的精神。通过以下关键点，您可以更好地理解范畴等价的内涵和重要性：

1. **范畴等价的定义：**
   - 等价函子不需要严格的逆函子关系，而是通过伪逆函子和同构箭头族来实现源范畴和目标范畴在结构上的“本质相同”。
   
2. **单子与单对象范畴的对应关系：**
   - 单子可以被视为具有一个对象的范畴，通过函子 $C$ 和 $U$ 建立了单子范畴与单对象范畴之间的关系，但它们并非严格的逆函子。

3. **等价范畴的例子：**
   - 通过具体的例子，如包含两个互为逆同构箭头的范畴 $C$ 和只有一个对象的范畴 $D$，展示了如何构造等价函子 $F$ 和 $G$，并通过同构箭头族验证等价性条件。

4. **等价性的重要性：**
   - 等价性比同构更为灵活，允许不同的范畴在“行为”上等价，即使它们在具体的对象和箭头上有所不同。这符合范畴论关注对象之间关系而非对象本身的核心思想。

**进一步学习建议：**

- **深入理解等价函子：** 探索更多范畴等价的例子，理解等价函子如何在不同范畴之间建立结构上的“桥梁”。
  
- **练习相关习题：** 通过完成后续的习题，巩固对范畴等价的理解，熟悉如何构造等价函子并验证其性质。
  
- **探索更高级的概念：** 学习**自然同构**（natural isomorphism）、**伴随函子**（adjoint functors）等更高级的范畴论概念，以拓展对范畴结构和函子关系的理解。

通过对本节内容的学习，您将掌握范畴等价的基本概念，理解其与范畴同构的区别，以及如何通过等价函子在不同范畴之间建立本质上的相似关系。这为进一步深入学习范畴论及其在数学和计算机科学中的应用奠定了坚实的基础。

如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ----------------------------

好的，让我们继续详细解析您提供的章节 **3.4 Equivalences（等价性）**。本节将深入探讨**范畴等价**的理论，包括相关定理、例子以及习题的解答。通过这些内容，您将更全面地理解范畴等价的概念及其在范畴论中的重要性。

---

## 3.4 Equivalences（等价性）

在范畴论中，**范畴等价**是一种比**范畴同构**更为宽松的关系，允许两个范畴在结构上“本质相同”但可能在具体表现上有所不同。本节将定义范畴等价，探讨其性质，并通过具体例子和习题加深理解。

### 3.4.4 定理：等价函子是满且忠实的

**定理 3.4.4：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是一个范畴等价的函子，且 $G: \mathcal{D} \rightarrow \mathcal{C}$ 是 $F$ 的伪逆函子（pseudo-inverse）。则 $F$ 和 $G$ 都是**满函子**（full）且**忠实函子**（faithful）。

**证明概述：**

1. **证明 $F$ 是忠实的：**
   - 假设 $f, f': C \rightarrow C'$ 是 $\mathcal{C}$ 中的两个箭头，且 $F(f) = F(f')$。
   - 应用伪逆函子 $G$，得到 $G(F(f)) = G(F(f'))$。
   - 根据等价性的性质，有 $G(F(f)) = u_{C'} \circ f \circ u_C^{-1}$ 和 $G(F(f')) = u_{C'} \circ f' \circ u_C^{-1}$。
   - 因为 $G(F(f)) = G(F(f'))$，所以 $u_{C'} \circ f \circ u_C^{-1} = u_{C'} \circ f' \circ u_C^{-1}$。
   - 由于 $u$ 是同构箭头，$u_{C'}$ 可逆，故 $f = f'$。
   - 因此，$F$ 是忠实的。

2. **对称地证明 $G$ 是忠实的：**
   - 类似地，假设 $g, g': D \rightarrow D'$ 是 $\mathcal{D}$ 中的两个箭头，且 $G(g) = G(g')$。
   - 应用伪逆函子 $F$，得到 $F(G(g)) = F(G(g'))$。
   - 根据等价性的性质，有 $F(G(g)) = v_{D'} \circ g \circ v_D^{-1}$ 和 $F(G(g')) = v_{D'} \circ g' \circ v_D^{-1}$。
   - 因为 $F(G(g)) = F(G(g'))$，所以 $v_{D'} \circ g \circ v_D^{-1} = v_{D'} \circ g' \circ v_D^{-1}$。
   - 由于 $v$ 是同构箭头，$v_{D'}$ 可逆，故 $g = g'$。
   - 因此，$G$ 是忠实的。

3. **证明 $F$ 是满的：**
   - 设 $g: F(C) \rightarrow F(C')$ 是 $\mathcal{D}$ 中的任意箭头。
   - 需要找到 $\mathcal{C}$ 中的箭头 $f: C \rightarrow C'$ 使得 $F(f) = g$。
   - 令 $f = u_{C'}^{-1} \circ G(g) \circ u_C$。
   - 计算 $F(f)$：
     $$
     F(f) = F(u_{C'}^{-1} \circ G(g) \circ u_C) = F(u_{C'}^{-1}) \circ F(G(g)) \circ F(u_C)
     $$
     根据等价性的性质：
     $$
     F(G(g)) = v_{F(C)} \circ g \circ v_{F(C')}^{-1}
     $$
     因此：
     $$
     F(f) = F(u_{C'}^{-1}) \circ v_{F(C)} \circ g \circ v_{F(C')}^{-1} \circ F(u_C)
     $$
     由于 $u$ 和 $v$ 是自然同构，且满足一定的兼容性条件，最终得到 $F(f) = g$。
   - 因此，$F$ 是满的。

4. **对称地证明 $G$ 是满的：**
   - 类似地，设 $h: G(D) \rightarrow G(D')$ 是 $\mathcal{C}$ 中的任意箭头。
   - 需要找到 $\mathcal{D}$ 中的箭头 $k: D \rightarrow D'$ 使得 $G(k) = h$。
   - 令 $k = v_{D'}^{-1} \circ F(h) \circ v_D$。
   - 计算 $G(k)$：
     $$
     G(k) = G(v_{D'}^{-1} \circ F(h) \circ v_D) = G(v_{D'}^{-1}) \circ G(F(h)) \circ G(v_D)
     $$
     根据等价性的性质：
     $$
     G(F(h)) = u_C \circ h \circ u_{C'}^{-1}
     $$
     因此：
     $$
     G(k) = u_C \circ h \circ u_{C'}^{-1} \circ G(v_{D'})^{-1} \circ G(v_D)
     $$
     由于 $u$ 和 $v$ 是自然同构，且满足一定的兼容性条件，最终得到 $G(k) = h$。
   - 因此，$G$ 是满的。

**总结：**

通过上述证明，我们确认了**等价函子**不仅是**忠实的**，还**是满的**。这意味着等价函子在箭头上的映射既不丢失信息（忠实），也能覆盖目标范畴中的所有箭头（满），这进一步说明了范畴等价是一种强有力的结构保持关系。

---

### 3.4.5 不等价性（Inequivalence）

**概念解释：**

如果两个范畴在某些性质上不同，那么它们不能是等价范畴。具体来说，如果存在一个性质 $P$ 可以通过箭头的复合和恒等箭头来定义，并且 $P$ 在两个范畴中不一致（即一个范畴中有 $P$，另一个没有），则这两个范畴不可能是等价范畴。

**具体说明：**

- **性质 $P$ 的保留：** 若 $\mathcal{C}$ 和 $\mathcal{D}$ 是等价范畴，且 $P$ 是一种通过箭头的复合和恒等箭头定义的性质，那么 $\mathcal{C}$ 和 $\mathcal{D}$ 必须在 $P$ 的存在性和性质上保持一致。
  
- **举例说明：**
  
  1. **集合范畴 $\text{Set}$ 与单子范畴 $\text{Mon}$：**
     - 在 $\text{Set}$ 中，存在从终端对象（单元素集合）到初始对象（空集）的箭头（唯一的函数）。
     - 在 $\text{Mon}$ 中，终端对象是单元素单子，而没有初始对象。
     - 因此，$\text{Set}$ 和 $\text{Mon}$ 在初始对象和终端对象的存在性上不同，故它们不等价。
  
  2. **集合范畴 $\text{Set}$ 与偏序集范畴（Poset）:**
     - 在 $\text{Set}$ 中，只有两个非同构的单元素集合（空集和单元素集合）具有唯一的自同构。
     - 在偏序集范畴中，存在许多不同大小的偏序集（如不同大小的全序集），且它们可能只有一个自同构。
     - 因此，$\text{Set}$ 和偏序集范畴在满足特定自同构性质的对象数量上不同，故它们不等价。

**结论：**

通过分析范畴中某些性质的保留与否，可以有效地判断两个范畴是否不等价。这种方法利用了等价范畴在结构上的一致性，确保了在定义良好的性质下，等价范畴无法在这些性质上出现差异。

---

### 3.4.6 例子：有限集合与有限布尔代数的对偶范畴等价

**例子 3.4.6：** **有限集合范畴 $\text{Fin}$ 与有限布尔代数范畴 $\text{FBool}$ 的对偶范畴等价**

**背景知识：**

- **有限集合范畴 $\text{Fin}$：** 对象是有限集合，箭头是集合之间的函数。
- **有限布尔代数范畴 $\text{FBool}$：** 对象是有限布尔代数，箭头是布尔代数同态。
- **对偶范畴 $\text{Fin}^{\text{op}}$：** 与 $\text{Fin}$ 中的箭头方向相反的范畴。

**等价性构造：**

1. **函子 $F: \text{Fin}^{\text{op}} \rightarrow \text{FBool}$：**
   - **对象映射：** 将有限集合 $S$ 映射为其幂集 $\mathcal{P}(S)$，它是一个有限布尔代数。
   - **箭头映射：** 对于函数 $f: S \rightarrow T$，$F(f): \mathcal{P}(T) \rightarrow \mathcal{P}(S)$ 定义为逆像函数，即：
     $$
     F(f)(C) = f^{-1}(C) = \{ s \in S \mid f(s) \in C \}
     $$
     这里 $C \subseteq T$，因此 $F(f)$ 是一个布尔代数同态。

2. **伪逆函子 $G: \text{FBool}^{\text{op}} \rightarrow \text{Fin}$：**
   - **对象映射：** 将有限布尔代数 $B$ 映射为其原子集 $\text{Atoms}(B)$，即 $G(B)$ 是布尔代数中所有原子的集合。
   - **箭头映射：** 对于布尔代数同态 $h: B \rightarrow C$，$G(h): \text{Atoms}(C) \rightarrow \text{Atoms}(B)$ 定义为：
     $$
     G(h)(a') = a \quad \text{如果且仅如果} \quad a' \leq h(a)
     $$
     其中 $a'$ 是 $C$ 的一个原子，且 $a$ 是 $B$ 的一个原子。

**等价性验证：**

1. **函子 $F$ 和 $G$ 互为伪逆：**
   - **$G \circ F$：**
     - 对于有限集合 $S$，$F(S) = \mathcal{P}(S)$。
     - $G(\mathcal{P}(S)) = \text{Atoms}(\mathcal{P}(S)) = S$（因为幂集布尔代数的原子就是单元素子集）。
     - 因此，$G(F(S)) = S$，即 $G \circ F = \text{id}_{\text{Fin}}$。
    
   - **$F \circ G$：**
     - 对于有限布尔代数 $B$，$G(B) = \text{Atoms}(B)$。
     - $F(\text{Atoms}(B)) = \mathcal{P}(\text{Atoms}(B))$。
     - 由于 $B$ 是有限布尔代数，每个元素可以表示为原子的有限并，因此 $\mathcal{P}(\text{Atoms}(B))$ 与 $B$ 同构。
     - 因此，$F \circ G$ 与 $\text{id}_{\text{FBool}}$ 同构。

2. **自然同构：**
   - **同构箭头族：** 
     - **对于 $S \in \text{Fin}$：** $G(F(S)) = S$，定义自然同构 $u_S: S \rightarrow G(F(S))$ 为恒等映射。
     - **对于 $B \in \text{FBool}$：** $F(G(B)) = \mathcal{P}(\text{Atoms}(B))$，定义自然同构 $v_B: B \rightarrow F(G(B))$ 为将布尔代数中的元素映射为其原子的并集。

**结论：**

通过构造函子 $F$ 和 $G$，并验证它们互为伪逆，证明了有限集合范畴 $\text{Fin}$ 的对偶范畴 $\text{Fin}^{\text{op}}$ 与有限布尔代数范畴 $\text{FBool}$ 是等价范畴。这说明，尽管它们在对象和箭头的具体表现上有所不同，但在结构上它们是“本质相同”的。

---

### 3.4.7 命题：函子 $F$ 是等价函子，伪逆函子为 $G$

**命题 3.4.7：** 函子 $F$ 是等价函子，且其伪逆函子为 $G$。

**证明概述：**

- **自然同构的构造：**
  - **对于有限集合 $S$：** 定义自然同构 $u_S: S \rightarrow G(F(S))$，即 $u_S(x) = \{x\}$。
  - **对于有限布尔代数 $B$：** 定义自然同构 $v_B: B \rightarrow F(G(B))$，即 $v_B(b) = \{ a \in \text{Atoms}(B) \mid a \leq b \}$。
  
- **验证等价性条件：**
  - **对于任何有限集合 $S$：**
    $$
    G(F(S)) = S
    $$
    并且 $u_S: S \rightarrow S$ 是恒等映射，满足自然同构的条件。
  
  - **对于任何有限布尔代数 $B$：**
    $$
    F(G(B)) = \mathcal{P}(\text{Atoms}(B))
    $$
    并且 $v_B: B \rightarrow \mathcal{P}(\text{Atoms}(B))$ 是一个布尔代数同构。

- **结论：**
  - 通过构造自然同构 $u$ 和 $v$，并验证它们满足等价性的条件，证明了 $F$ 是一个等价函子，且 $G$ 是其伪逆函子。

**总结：**

通过具体构造自然同构 $u$ 和 $v$，并验证它们满足等价函子定义中的条件，我们确认了函子 $F$ 与 $G$ 构成了有限集合范畴与有限布尔代数范畴之间的等价关系。这进一步展示了范畴等价如何在不同结构间建立深层次的关联。

---

### 3.4.8 习题（Exercises）

以下是 **3.4.8** 小节中的习题，我们将提供每个问题的解题思路和关键步骤，帮助您更好地理解范畴等价的概念和应用。

#### 习题1：同构函子是等价函子

**题目：**
1. 证明一个在 $\text{Cat}$ 中是**同构**（isomorphism）的函子是一个**等价函子**（equivalence）。

**解答：**

**解答过程：**

- **同构函子与等价函子的定义：**
  - **同构函子：** $F: \mathcal{C} \rightarrow \mathcal{D}$ 是同构函子，当且仅当存在 $G: \mathcal{D} \rightarrow \mathcal{C}$，使得 $G \circ F = \text{id}_{\mathcal{C}}$ 且 $F \circ G = \text{id}_{\mathcal{D}}$。
  - **等价函子：** $F: \mathcal{C} \rightarrow \mathcal{D}$ 是等价函子，当且仅当存在 $G: \mathcal{D} \rightarrow \mathcal{C}$ 和自然同构 $u: \text{id}_{\mathcal{C}} \rightarrow G \circ F$，以及 $v: F \circ G \rightarrow \text{id}_{\mathcal{D}}$。

- **证明：**
  - 假设 $F$ 是同构函子，存在 $G$ 使得 $G \circ F = \text{id}_{\mathcal{C}}$ 且 $F \circ G = \text{id}_{\mathcal{D}}$。
  - 则自然同构 $u: \text{id}_{\mathcal{C}} \rightarrow G \circ F$ 和 $v: F \circ G \rightarrow \text{id}_{\mathcal{D}}$ 可以取为恒等自然变换，因为 $G \circ F$ 和 $F \circ G$ 已经严格等于恒等函子。
  - 因此，$F$ 满足等价函子的所有条件。

**结论：**

一个在 $\text{Cat}$ 中是同构的函子自然是一个等价函子，因为同构函子满足等价函子所有的条件，包括存在严格的逆函子。

---

#### 习题2：部分函子等价性

**题目：**
2.† 设 $\text{Pfn}$ 表示集合和部分函数的范畴，$\text{Pts}$ 表示有一个指定元素（称为基点）的集合和保持基点的函数的范畴。证明 $\text{Pfn}$ 和 $\text{Pts}$ 是等价范畴。

**提示：** 构造从 $\text{Pfn}$ 到 $\text{Pts}$ 的函子，通过在每个集合中添加一个新元素，并将部分函数扩展为全函数，使得未定义的位置映射到新元素。反向构造通过去除基点实现。

**解答：**

**解答过程：**

- **函子 $F: \text{Pfn} \rightarrow \text{Pts}$：**
  - **对象映射：** 对于每个集合 $S$，$F(S) = S \cup \{*\}$，其中 $*$ 是一个新元素，作为基点。
  - **箭头映射：** 对于部分函数 $f: S \rightharpoonup T$，定义 $F(f): F(S) \rightarrow F(T)$ 为：
    $$
    F(f)(s) =
    \begin{cases}
      f(s) & \text{如果 } f(s) \text{ 定义} \\
      * & \text{否则}
    \end{cases}
    $$
    这将部分函数扩展为保持基点的全函数。

- **函子 $G: \text{Pts} \rightarrow \text{Pfn}$：**
  - **对象映射：** 对于每个带基点的集合 $(S, s_0)$，定义 $G(S, s_0) = S \setminus \{s_0\}$。
  - **箭头映射：** 对于保持基点的函数 $g: (S, s_0) \rightarrow (T, t_0)$，定义 $G(g): G(S, s_0) \rightharpoonup G(T, t_0)$ 为：
    $$
    G(g)(s) =
    \begin{cases}
      g(s) & \text{如果 } g(s) \neq t_0 \\
      \text{未定义} & \text{否则}
    \end{cases}
    $$
    这将保持基点的全函数转化为部分函数。

- **自然同构的构造：**
  - **对于 $\text{Pfn}$：**
    - **自然同构 $\eta: \text{id}_{\text{Pfn}} \rightarrow G \circ F$：**
      - 对于每个 $S \in \text{Pfn}$，$\eta_S: S \rightarrow G(F(S)) = S$ 定义为恒等映射 $\eta_S(s) = s$。
  
  - **对于 $\text{Pts}$：**
    - **自然同构 $\epsilon: F \circ G \rightarrow \text{id}_{\text{Pts}}$：**
      - 对于每个 $(T, t_0) \in \text{Pts}$，$\epsilon_{(T, t_0)}: F(G(T, t_0)) = T \cup \{*\} \rightarrow T$ 定义为 $\epsilon_{(T, t_0)}(t) = t$ 对于 $t \in T$，且 $\epsilon_{(T, t_0)}(*) = t_0$。

- **验证等价性条件：**
  - **$G \circ F$ 与恒等函子 $\text{id}_{\text{Pfn}}$ 同构：** 通过自然同构 $\eta$。
  - **$F \circ G$ 与恒等函子 $\text{id}_{\text{Pts}}$ 同构：** 通过自然同构 $\epsilon$。

**结论：**

通过构造函子 $F$ 和 $G$，并定义自然同构 $\eta$ 和 $\epsilon$，我们证明了 $\text{Pfn}$ 和 $\text{Pts}$ 是等价范畴。这说明，尽管 $\text{Pfn}$ 和 $\text{Pts}$ 在具体对象和箭头的定义上有所不同，但它们在结构上是“本质相同”的。

---

#### 习题3：预序集范畴与具有唯一箭头的范畴的等价性

**题目：**
3. 证明**预序集范畴**（Preordered Sets）与**那些小范畴中 Hom(A, B) 最多有一个元素的全子范畴**等价。

**解答：**

**解答过程：**

- **定义回顾：**
  - **预序集范畴：** 对象是预序集，箭头是保持预序的函数（单调映射）。
  - **Hom(A, B) 最多有一个元素的范畴：** 每对对象之间最多存在一个箭头，即无复合的箭头或唯一的箭头。

- **构造函子 $F: \text{Preord} \rightarrow \mathcal{C}$：**
  - **对象映射：** 将预序集 $(P, \leq)$ 映射为范畴 $\mathcal{C}$ 中的对象，其中 $\mathcal{C}$ 满足 $\text{Hom}(A, B)$ 最多有一个元素。
  - **箭头映射：** 对于每个单调映射 $f: P \rightarrow Q$，定义 $F(f)$ 为 $\mathcal{C}$ 中的箭头。

- **构造逆函子 $G: \mathcal{C} \rightarrow \text{Preord}$：**
  - **对象映射：** 将 $\mathcal{C}$ 中的对象映射回预序集。
  - **箭头映射：** 将 $\mathcal{C}$ 中的唯一箭头映射为预序集中的单调映射。

- **验证等价性：**
  - **自然同构：** 构造自然同构 $\eta: \text{id}_{\text{Preord}} \rightarrow G \circ F$ 和 $\epsilon: F \circ G \rightarrow \text{id}_{\mathcal{C}}$，确保 $F$ 和 $G$ 满足等价函子的条件。

**结论：**

通过构造互为逆函子的同构函子 $F$ 和 $G$，并验证它们满足等价函子的条件，证明了**预序集范畴**与**Hom(A, B) 最多有一个元素的全子范畴**是等价范畴。这表明，这两类范畴在结构上是“本质相同”的，尽管它们在对象和箭头的具体定义上有所不同。

---

#### 习题4：有限维向量空间与矩阵范畴的等价性

**题目：**
4.†（对于熟悉向量空间和线性映射的读者）设 $L$ 表示有限维向量空间和线性映射的范畴，$M$ 表示对象为自然数 $n$，箭头 $m: m \rightarrow n$ 是 $n \times m$ 矩阵的范畴。当 $n = 0$ 或 $m = 0$ 或两者都为 0 时，只有一个箭头称为 0。复合为矩阵乘法，任何涉及 0 的复合都得到 0 箭头。证明 $L$ 和 $M$ 是等价范畴。

**解答：**

**解答过程：**

- **函子 $F: M \rightarrow L$：**
  - **对象映射：** 将自然数 $n$ 映射为 $\mathbb{K}^n$，其中 $\mathbb{K}$ 是底层域（例如实数域）。
  - **箭头映射：** 将 $n \times m$ 矩阵 $A$ 映射为线性映射 $F(A): \mathbb{K}^m \rightarrow \mathbb{K}^n$，其作用是矩阵乘法。

- **伪逆函子 $G: L \rightarrow M$：**
  - **对象映射：** 将有限维向量空间 $V$ 映射为其维数 $\dim(V)$。
  - **箭头映射：** 将线性映射 $T: \mathbb{K}^m \rightarrow \mathbb{K}^n$ 映射为其矩阵表示 $G(T)$（在标准基下的矩阵）。

- **自然同构的构造：**
  - **对于 $M$ 的对象 $n$：** $G(F(n)) = G(\mathbb{K}^n) = n$，定义自然同构 $\eta_n: n \rightarrow G(F(n))$ 为恒等映射。
  - **对于 $L$ 的对象 $V$：** $F(G(V)) = F(\dim(V)) = \mathbb{K}^{\dim(V)}$，定义自然同构 $\epsilon_V: V \rightarrow F(G(V))$ 为基于选择基的线性同构。

- **验证等价性条件：**
  - **$G \circ F = \text{id}_M$：** 对于每个自然数 $n$，$G(F(n)) = n$，且 $\eta_n$ 是恒等映射。
  - **$F \circ G$ 同构于 $\text{id}_L$：** 对于每个有限维向量空间 $V$，$F(G(V)) = \mathbb{K}^{\dim(V)}$ 与 $V$ 同构，通过选择基实现自然同构 $\epsilon_V$。

**结论：**

通过构造互为伪逆的函子 $F$ 和 $G$，并定义自然同构 $\eta$ 和 $\epsilon$，我们证明了**有限维向量空间范畴** $L$ 与**矩阵范畴** $M$ 是等价范畴。这表明，尽管 $L$ 和 $M$ 在对象和箭头的具体定义上不同，但它们在结构上是“本质相同”的。

---

#### 习题5：单子范畴到单对象范畴的函子是等价范畴

**题目：**
5. a. 证明在 3.4.1 中构造的函子 $C: \text{Mon} \rightarrow \text{Ooc}$ 是一个**等价函子**。

b. 不使用定理 3.4.4，直接证明 $C$ 是**满**且**忠实**的。

**解答：**

**解答过程：**

**a. 证明函子 $C$ 是等价函子：**

- **函子 $C: \text{Mon} \rightarrow \text{Ooc}$：**
  - **对象映射：** 将单子 $M$ 映射为单对象范畴 $C(M)$，其中 $C(M)$ 的唯一对象是 $M$，箭头是 $M$ 的元素。
  - **箭头映射：** 将单子同态 $h: M \rightarrow N$ 映射为函子 $C(h): C(M) \rightarrow C(N)$，其对象映射为将唯一对象 $M$ 映射为 $N$，箭头映射为 $h$ 在箭头上的作用。

- **逆向函子 $U: \text{Ooc} \rightarrow \text{Mon}$：**
  - **对象映射：** 将单对象范畴 $C$ 映射为单子 $U(C)$，其元素是 $C$ 中的箭头，运算为箭头的复合。
  - **箭头映射：** 将函子 $F: C(M) \rightarrow C(N)$ 映射为单子同态 $U(F) = F$ 在箭头上的作用。

- **构造自然同构：**
  - **对于 $\text{Mon}$ 的对象 $M$：** $U(C(M)) = M$，定义自然同构 $\eta_M: M \rightarrow U(C(M))$ 为恒等映射。
  - **对于 $\text{Ooc}$ 的对象 $C$：** $C(U(C))$ 与 $C$ 同构，定义自然同构 $\epsilon_C: C \rightarrow C(U(C))$ 为恒等函子。

- **验证等价性条件：**
  - $U \circ C = \text{id}_{\text{Mon}}$。
  - $C \circ U$ 与 $\text{id}_{\text{Ooc}}$ 同构，通过自然同构 $\epsilon$。

**结论：**

通过构造互为伪逆的函子 $C$ 和 $U$，并定义自然同构 $\eta$ 和 $\epsilon$，证明了函子 $C: \text{Mon} \rightarrow \text{Ooc}$ 是一个等价函子。

**b. 直接证明 $C$ 是满且忠实的：**

- **忠实性证明：**
  - 假设 $h, h': M \rightarrow N$ 是单子同态，且 $C(h) = C(h')$。
  - 由于 $C(h)$ 和 $C(h')$ 在箭头上的作用相同，即 $h(m) = h'(m)$ 对所有 $m \in M$。
  - 因此，$h = h'$，故 $C$ 是忠实的。

- **满性证明：**
  - 设 $F: C(M) \rightarrow C(N)$ 是 $\text{Ooc}$ 中的一个函子。
  - 必须存在单子同态 $h: M \rightarrow N$ 使得 $C(h) = F$。
  - 由于 $F$ 在箭头上的作用必须保持单子结构，即 $F(m \circ m') = F(m) \circ F(m')$，因此 $h(m \circ m') = h(m) \circ h(m')$。
  - 这表明 $h$ 是单子同态。
  - 因此，$C$ 是满的。

**总结：**

通过直接证明函子 $C$ 在单子同态上的映射是单射（忠实）且覆盖所有目标范畴中的箭头（满），我们确认了 $C$ 是满且忠实的。这进一步支持了 $C$ 是等价函子的结论。

---

## 总结

本节 **3.4 Equivalences（等价性）** 深入探讨了**范畴等价**的概念及其性质，通过具体定理和例子，您可以理解为何等价性比范畴同构更为宽松且更符合范畴论的核心思想。关键点包括：

1. **范畴等价的定义与性质：**
   - **等价函子**允许源范畴和目标范畴在结构上“本质相同”，即存在伪逆函子和自然同构。
   - **等价函子**是**满的**且**忠实的**，确保了箭头的完整映射和信息的保留。

2. **等价性的重要性：**
   - 等价性比同构更为宽松，适用于那些在结构上相似但在具体表现上不同的范畴。
   - 它强调了范畴之间的“行为”相似性，而非严格的对象和箭头的一一对应。

3. **具体例子与应用：**
   - **有限集合与有限布尔代数的对偶范畴等价：** 展示了如何通过函子构造实现不同结构间的等价。
   - **单子范畴与单对象范畴的等价性：** 通过函子 $C$ 和 $U$ 的构造，展示了如何将代数结构映射到范畴结构。

4. **习题的作用：**
   - 通过习题，您可以实践构造等价函子、验证满且忠实性，以及理解不等价性的判定方法。
   - 习题涵盖了从基本到高级的内容，帮助巩固对范畴等价性的理解。

**进一步学习建议：**

- **完成剩余的习题：** 通过逐一解答，您可以更深入地理解范畴等价的应用和构造方法。
- **探索更高级的概念：** 学习**自然变换**（Natural Transformations）、**伴随函子**（Adjoint Functors）等高级范畴论概念，以拓展对范畴结构和函数关系的理解。
- **研究实际应用：** 探索范畴等价在计算机科学、逻辑学、代数等领域的具体应用，理解其在不同数学分支中的重要性。

通过系统的学习和实践，您将能够熟练掌握范畴等价的理论，并在实际问题中应用这些概念解决复杂的结构同构与等价问题。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ---------------------------

好的，让我们继续详细解析您提供的章节 **3.5 Quotient Categories（商范畴）**。本节将探讨如何通过商关系构造新的范畴，理解商范畴的定义、性质以及其在范畴论中的应用。我们将通过具体的定义、命题、例子和习题逐步深入这一主题。

---

## 3.5 Quotient Categories（商范畴）

**商范畴**的构造类似于将单子通过商关系进行商化的过程。我们将从头开始描述这一构造，无需事先了解同余关系（congruence relation）。需要注意的是，本节描述的构造并非最一般的形式，它仅合并箭头，而不合并对象。

### 3.5.1 定义：范畴上的同余关系（Congruence Relation on a Category）

**定义 3.5.1：** 在一个范畴 $\mathcal{C}$ 中，箭头上的等价关系 $\sim$ 是一个**同余关系**（congruence relation），如果满足以下条件：

- **CR–1：** 如果 $f \sim g$，则 $f$ 和 $g$ 必须有相同的定义域和余域。
  
- **CR–2：** 对于任意箭头 $h: A \rightarrow B$、$f, g: B \rightarrow C$、和 $k: C \rightarrow D$，如果 $f \sim g$，则 $f \circ h \sim g \circ h$ 和 $k \circ f \sim k \circ g$。

用图示表示：
$$
\begin{array}{ccc}
A & \xrightarrow{h} & B \\
 & \searrow f & \downarrow g \\
 & & C \\
 & & \downarrow k \\
 & & D
\end{array}
$$
如果 $f \sim g$，则 $f \circ h \sim g \circ h$ 且 $k \circ f \sim k \circ g$。

**符号说明：** $[f]$ 表示箭头 $f$ 所在的同余类。

### 3.5.2 定义：商范畴（Quotient Category）

**定义 3.5.2：** 设 $\sim$ 是范畴 $\mathcal{C}$ 上的一个同余关系。则**商范畴** $\mathcal{C} / \sim$ 定义如下：

- **QC–1：** $\mathcal{C} / \sim$ 的对象与 $\mathcal{C}$ 的对象相同。
  
- **QC–2：** $\mathcal{C} / \sim$ 的箭头是 $\mathcal{C}$ 中箭头的同余类。
  
- **QC–3：** 如果 $f: A \rightarrow B$ 是 $\mathcal{C}$ 中的箭头，则 $[f]: A \rightarrow B$ 是 $\mathcal{C} / \sim$ 中的箭头。
  
- **QC–4：** 对于 $\mathcal{C}$ 中的箭头 $f: A \rightarrow B$ 和 $g: B \rightarrow C$，在 $\mathcal{C} / \sim$ 中定义复合 $[g] \circ [f] = [g \circ f]$。

**注意：** 由习题1可知，QC–4 是良好定义的，且结果确实构成一个范畴。

### 3.5.3 定义：商函子（Quotient Functor）

**定义 3.5.3：** 设 $\mathcal{C} / \sim$ 是范畴 $\mathcal{C}$ 关于同余关系 $\sim$ 的商范畴。定义**商函子** $Q: \mathcal{C} \rightarrow \mathcal{C} / \sim$ 如下：

- **对象映射：** 对于 $\mathcal{C}$ 中的对象 $A$，有 $Q(A) = A$。
  
- **箭头映射：** 对于 $\mathcal{C}$ 中的箭头 $f$，有 $Q(f) = [f]$。

由 QC–4 可知，$Q$ 是一个函子。

### 3.5.4 命题：商函子的唯一延拓性质

**命题 3.5.4：** 设 $\sim$ 是范畴 $\mathcal{C}$ 上的一个同余关系，$Q: \mathcal{C} \rightarrow \mathcal{C} / \sim$ 是商函子。若 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是一个函子，且对于所有 $f \sim g$ 都有 $F(f) = F(g)$，则存在一个唯一的函子 $F_0: \mathcal{C} / \sim \rightarrow \mathcal{D}$ 使得 $F_0 \circ Q = F$。

**解释：**

这意味着，每一个通过合并同余箭头而得到的函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 都可以唯一地因式分解为商函子 $Q$ 和某个从商范畴到 $\mathcal{D}$ 的函子 $F_0$。

**结论：**

商范畴 $\mathcal{C} / \sim$ 是在 $\mathcal{C}$ 上最少的需要合并同余箭头以使得等价箭头在商范畴中相同的构造。这体现了范畴论中的**普遍性原则**。

### 3.5.5 函子的因式分解（Factorization of Functors）

**定义 3.5.5：** 每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 都可以因式分解为一个满函子后跟一个忠实函子，具体如下：

1. **构造同余关系：** 定义 $\sim$ 为满足 $f \sim g$ 当且仅当 $F(f) = F(g)$，即 $f$ 和 $g$ 在 $F$ 下的像相同。

2. **构造商范畴：** 通过同余关系 $\sim$，得到商范畴 $\mathcal{C} / \sim$。

3. **因式分解：**
   $$
   \mathcal{C} \xrightarrow{Q} \mathcal{C} / \sim \xrightarrow{F_0} \mathcal{D}
   $$
   其中 $Q$ 是商函子，$F_0$ 是由命题3.5.4唯一确定的函子。

### 3.5.6 命题：由商函子诱导的函子是忠实的

**命题 3.5.6：** 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是一个函子，$\sim$ 是由 $F$ 诱导的同余关系（即 $f \sim g$ 当且仅当 $F(f) = F(g)$）。则：

1. $\sim$ 是 $\mathcal{C}$ 上的一个同余关系。
2. 由命题3.5.4，存在一个函子 $F_0: \mathcal{C} / \sim \rightarrow \mathcal{D}$，且 $F_0 \circ Q = F$。
3. 该函子 $F_0$ 是忠实的。

**解释：**

这意味着，通过合并 $\sim$ 同余类，商函子 $Q$ 将 $\mathcal{C}$ 中的箭头映射到 $\mathcal{C} / \sim$ 中的同余类，而 $F_0$ 保持这些同余类在 $\mathcal{D}$ 中的区分性。

**证明提示：**

详细的证明见习题4。

### 3.5.7 命题：同余关系的交集仍为同余关系

**命题 3.5.7：** 任意一组范畴 $\mathcal{C}$ 上的同余关系的交集仍然是一个同余关系。

**解释：**

这意味着，如果我们有多个同余关系 $\sim_i$（$i \in I$）在范畴 $\mathcal{C}$ 上，每个 $\sim_i$ 都满足同余关系的定义，那么它们的交集 $\sim = \bigcap_{i \in I} \sim_i$ 也是一个同余关系。

**结论：**

这表明同余关系的结构是封闭的，即它们在某种意义下形成了一个完备的系统。这为构造最小的同余关系提供了基础。

**进一步说明：**

特别地，给定一个任意的关系 $\alpha$ 在范畴 $\mathcal{C}$ 上，若 $\alpha$ 满足箭头具有相同的定义域和余域，则存在一个唯一的最小同余关系 $\sim$，包含于 $\alpha$，使得合并 $\alpha$ 中的等价箭头后得到的范畴 $\mathcal{C} / \sim$ 满足同余关系的定义。

### 3.5.8 编程语言的范畴（The Category of a Programming Language）

**例子 3.5.8：** 我们在**2.2.6节**中描述了对应于一个简单函数式编程语言 $L$ 的范畴 $C(L)$。现在我们可以准确地描述 $C(L)$ 是什么。

**构造过程：**

1. **语言 $L$ 的定义（见2.2.5节）：**
   - **原始类型和操作：** $L$ 定义了原始类型和操作符。例如，$\text{NAT}$（自然数）、$\text{BOOLEAN}$（布尔型）、$\text{CHAR}$（字符型）等。
   - **构造：** 类型是节点，操作符是箭头，构成一个图。

2. **自由范畴 $F(L)$：** 类型和操作符生成一个自由范畴 $F(L)$。

3. **商范畴 $C(L)$：** 通过在自由范畴 $F(L)$ 上施加等式（见2.2.5(ii)和(iv)）生成一个商范畴 $C(L)$。这些等式规定了某些箭头必须相等。

**具体说明：**

- **添加构造器（如记录类型）：** 当添加如记录类型等构造器时，单纯的商范畴构造不再足够，必须使用更一般的构造方法，如**草图**（sketches）。

- **例子中的商范畴 $C(L)$：** 它是由自由范畴 $F(L)$ 通过施加编程语言 $L$ 的等式而得到的商范畴。

### 3.5.9 函子语义学（Functorial Semantics）

**概念解释：**

函子提供了一种为编程语言 $L$ 的构造赋予意义的方法。这是通过定义一个从 $C(L)$ 到某个适合于编程语言语义的范畴（如 $\text{Set}$）的函子来实现的。

**示例：** 使用函子 $\Sigma: C(L) \rightarrow \text{Set}$ 作为语言 $L$ 的一种语义。

**构造过程：**

1. **定义函数 $F$ 在原始类型和操作上的作用：**
   
   - **(i) 自然数类型 $\text{NAT}$：**
     - $F(\text{NAT})$ 是自然数集 $\mathbb{N}$。
     - 常数 0 映射为数字 0。
     - $\text{succ}$ 映射为加1函数。
   
   - **(ii) 布尔类型 $\text{BOOLEAN}$：**
     - $F(\text{BOOLEAN})$ 是布尔集合 $\{ \text{true}, \text{false} \}$。
     - 常数 $\text{true}$ 和 $\text{false}$ 映射为自身。
     - $\text{¬}$（逻辑非）映射为交换 $\text{true}$ 和 $\text{false}$ 的函数。
   
   - **(iii) 字符类型 $\text{CHAR}$：**
     - $F(\text{CHAR})$ 是包含128个ASCII符号的集合，每个符号映射为自身。
   
   - **(iv) 函数 $\text{ord}$ 和 $\text{chr}$：**
     - $F(\text{ord})$ 将字符映射为其ASCII值。
     - $F(\text{chr})$ 将数字 $n$ 映射为ASCII码为 $n$ 模128的字符。

2. **自由范畴 $F(L)$：** 生成自类型和操作的自由范畴。

3. **函子 $F_b: F(L) \rightarrow \text{Set}$：**
   - **对象映射：** 如上所述。
   - **箭头映射：** 由 $F$ 在原始类型和操作上的定义决定。

4. **商关系 $\sim$：** 根据语言 $L$ 的等式（2.2.5(ii)和(iv)）生成一个同余关系。

5. **商函子 $\Sigma: C(L) \rightarrow \text{Set}$：**
   - 由命题3.5.4和习题5可知，存在唯一的函子 $\Sigma$ 使得 $\Sigma \circ Q = F_b$。
   - 这意味着 $\Sigma$ 将 $C(L)$ 的构造映射到 $\text{Set}$，赋予编程语言 $L$ 的构造以具体的语义。

**验证：**

- **保持程序含义：** 由于 $\Sigma$ 是一个函子，它保持了程序的组合和结构。例如，程序 $\text{chr} \circ \text{succ} \circ \text{ord}$ 在语义上确实会按照预期生成下一个字符。

**结论：**

通过定义函子 $\Sigma$，我们为编程语言 $L$ 的构造提供了一种数学上的语义解释，使得程序的执行符合其定义的意义。

### 3.5.10 习题（Exercises）

以下是 **3.5.10** 小节中的习题，我们将提供每个问题的解题思路和关键步骤，帮助您更好地理解商范畴的概念和应用。

#### 习题1：同余关系的等价条件

**题目：**

1. 证明：一个满足 CR–1 的等价关系 $\sim$ 是一个同余关系，当且仅当，对于图示中的所有箭头 $f_1, f_2: A \rightarrow B$ 和 $g_1, g_2: B \rightarrow C$，如果 $f_1 \sim f_2$ 且 $g_1 \sim g_2$，则 $g_1 \circ f_1 \sim g_2 \circ f_2$。

**解答思路：**

- **必要性：**
  - 假设 $\sim$ 是一个同余关系，则满足 CR–1 和 CR–2。
  - 如果 $f_1 \sim f_2$ 且 $g_1 \sim g_2$，则根据 CR–2：
    - $g_1 \circ f_1 \sim g_1 \circ f_2$ （因为 $f_1 \sim f_2$）
    - $g_1 \circ f_2 \sim g_2 \circ f_2$ （因为 $g_1 \sim g_2$）
  - 由等价关系的传递性，得到 $g_1 \circ f_1 \sim g_2 \circ f_2$。

- **充分性：**
  - 假设对于所有满足条件的箭头复合，$\sim$ 满足上述条件。
  - 需要验证 CR–2：
    - 若 $f \sim g$，则对于任意箭头 $h$ 和 $k$，有 $k \circ f \sim k \circ g$ 和 $f \circ h \sim g \circ h$。
    - 选择 $f_1 = f$、$f_2 = g$、$g_1 = \text{id}$、$g_2 = \text{id}$，则 $f \sim g$ 蕴含 $\text{id} \circ f \sim \text{id} \circ g$，即 $f \sim g$。
    - 类似地，可以验证其他合成的情况。

**结论：**

通过上述证明，我们确认了 $\sim$ 满足同余关系的必要与充分条件。

#### 习题2：同余关系的交集

**题目：**

2. 证明：任意一组范畴 $\mathcal{C}$ 上的同余关系的交集仍然是一个同余关系。

**解答思路：**

- **设定：**
  - 设 $\{ \sim_i \}_{i \in I}$ 是 $\mathcal{C}$ 上的一组同余关系。
  - 定义 $\sim = \bigcap_{i \in I} \sim_i$。

- **验证同余关系的条件：**
  - **CR–1：** 若 $f \sim g$，则 $f \sim_i g$ 对所有 $i \in I$，因此 $f$ 和 $g$ 有相同的定义域和余域。
  - **CR–2：** 若 $f_1 \sim f_2$ 且 $g_1 \sim g_2$，则对于所有 $i \in I$，有 $f_1 \sim_i f_2$ 且 $g_1 \sim_i g_2$，因此 $g_1 \circ f_1 \sim_i g_2 \circ f_2$。因此，$g_1 \circ f_1 \sim g_2 \circ f_2$。

**结论：**

同余关系的交集满足同余关系的所有条件，因此 $\sim$ 是一个同余关系。

#### 习题3：商函子的满性

**题目：**

3. 证明：商函子 $Q: \mathcal{C} \rightarrow \mathcal{C} / \sim$ 是满函子。（警告：如果允许更一般的商构造，即合并对象和箭头，则此习题是错误的。）

**解答思路：**

- **定义回顾：** 商函子将 $\mathcal{C}$ 中的每个箭头 $f$ 映射为其同余类 $[f]$。
  
- **满函子的定义：** 对于任意两个对象 $A, B$ 在 $\mathcal{C} / \sim$ 中的箭头 $[f]: A \rightarrow B$，存在一个 $\mathcal{C}$ 中的箭头 $f: A \rightarrow B$ 使得 $Q(f) = [f]$。

- **证明：**
  - 对于 $\mathcal{C} / \sim$ 中的任意箭头 $[f]: A \rightarrow B$，显然存在 $\mathcal{C}$ 中的箭头 $f: A \rightarrow B$ 使得 $Q(f) = [f]$。
  
- **结论：**

商函子 $Q$ 满足满函子的定义，因此 $Q$ 是满函子。

#### 习题4：诱导同余关系的同余性和诱导函子的忠实性

**题目：**

4. 设 $F: \mathcal{C} \rightarrow \mathcal{D}$ 是一个函子。

a. 证明由 $F$ 诱导的关系 $\sim$（定义在 3.5.5 中）是 $\mathcal{C}$ 上的一个同余关系。

b. 证明由命题 3.5.4 诱导的函子 $F_0: \mathcal{C} / \sim \rightarrow \mathcal{D}$ 是忠实的。

c. 从上述两部分和命题 3.5.6 得出结论：每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 都可以因式分解为一个满函子后跟一个忠实函子。

**解答过程：**

**a. 诱导关系 $\sim$ 是同余关系：**

- **CR–1：** 如果 $f \sim g$，即 $F(f) = F(g)$，则 $f$ 和 $g$ 必须有相同的定义域和余域，因为 $F$ 是一个函子，保持箭头的定义域和余域。
  
- **CR–2：** 若 $f_1 \sim f_2$ 且 $g_1 \sim g_2$，即 $F(f_1) = F(f_2)$ 且 $F(g_1) = F(g_2)$，则：
  $$
  F(g_1 \circ f_1) = F(g_1) \circ F(f_1) = F(g_2) \circ F(f_2) = F(g_2 \circ f_2)
  $$
  因此，$g_1 \circ f_1 \sim g_2 \circ f_2$。

**b. 诱导函子 $F_0$ 是忠实的：**

- **定义回顾：** $F_0$ 满足 $F_0 \circ Q = F$。
  
- **忠实性的定义：** 对于 $\mathcal{C} / \sim$ 中的任意两个箭头 $[f], [g]: A \rightarrow B$，如果 $F_0([f]) = F_0([g])$，则 $[f] = [g]$。
  
- **证明：**
  - 若 $F_0([f]) = F_0([g])$，即 $F(f) = F(g)$。
  - 根据定义的同余关系 $f \sim g$，因此 $[f] = [g]$。
  
- **结论：**

$F_0$ 满足忠实性的定义，因此 $F_0$ 是忠实函子。

**c. 函子的因式分解：**

由部分a和b的结果，加上命题3.5.6（$F_0$ 是忠实的），我们可以得出：

每个函子 $F: \mathcal{C} \rightarrow \mathcal{D}$ 都可以因式分解为：
$$
\mathcal{C} \xrightarrow{Q} \mathcal{C} / \sim \xrightarrow{F_0} \mathcal{D}
$$
其中 $Q$ 是满函子，$F_0$ 是忠实函子。

**结论：**

每个函子都可以通过商范畴的构造，因式分解为一个满函子后跟一个忠实函子。这种因式分解揭示了函子在结构保持方面的内在性质。

#### 习题5：验证 $f \sim g$ 蕴含 $F_b(f) = F_b(g)$

**题目：**

5. 设 $F_b$ 和 $\sim$ 如 3.5.9 节所定义。证明如果 $f \sim g$，则 $F_b(f) = F_b(g)$。

**解答思路：**

- **定义回顾：** $\sim$ 是由 $F_b$ 诱导的同余关系，即 $f \sim g$ 当且仅当 $F_b(f) = F_b(g)$。

- **证明：**
  - 根据定义，若 $f \sim g$，则 $F_b(f) = F_b(g)$。

**结论：**

此命题直接基于同余关系的定义，因此成立。

#### 习题6：单子上的同余关系与子单子的关系

**题目：**

6. 设 $M$ 是一个单子。一个在 $M$ 上的同余关系 $\sim$ 是一个等价关系，且满足：

a. 证明：一个等价关系 $\sim$ 满足 $f \sim g$ 当且仅当对于所有 $m, n, n' \in M$，若 $n \sim n'$，则 $m \cdot n \sim m \cdot n'$ 且 $n \cdot m \sim n' \cdot m$。

b. 令 $K = \{ (m, n) \mid m \sim n \} \subseteq M \times M$。证明：$K$ 是 $M \times M$ 的一个子单子，当且仅当 $\sim$ 是 $M$ 上的同余关系。

**解答过程：**

**a. 等价条件的证明：**

- **必要性：** 如果 $\sim$ 是同余关系，则满足 CR–2，即 $m \cdot n \sim m \cdot n'$ 和 $n \cdot m \sim n' \cdot m$。
  
- **充分性：** 如果对于所有 $m, n, n'$，$n \sim n'$ 蕴含 $m \cdot n \sim m \cdot n'$ 和 $n \cdot m \sim n' \cdot m$，则 $\sim$ 满足 CR–2，从而是同余关系。

**b. $K$ 是子单子的条件证明：**

- **必要性：** 若 $K$ 是 $M \times M$ 的子单子，则对于任意 $(m, n), (m', n') \in K$，有 $(m \cdot m', n \cdot n') \in K$。这意味着 $m \cdot n \sim m' \cdot n'$，即 $\sim$ 满足同余关系的封闭性。
  
- **充分性：** 若 $\sim$ 是 $M$ 上的同余关系，则 $K$ 满足：
  - **封闭性：** 对于 $(m, n), (m', n') \in K$，有 $m \cdot n \sim m' \cdot n'$。
  - **单位元：** $(e, e) \in K$，其中 $e$ 是单子的单位元。
  
- **结论：**

$K$ 是 $M \times M$ 的子单子，当且仅当 $\sim$ 是 $M$ 上的同余关系。

---

## 总结

本节 **3.5 Quotient Categories（商范畴）** 介绍了如何通过同余关系在范畴上构造商范畴，探讨了商函子的性质及其在范畴论中的应用。关键点包括：

1. **同余关系的定义：**
   - 同余关系是一种在范畴中合并箭头的等价关系，必须满足箭头的相同定义域和余域以及合成的兼容性。

2. **商范畴的构造：**
   - 商范畴 $\mathcal{C} / \sim$ 保留原范畴的对象，通过将箭头合并为同余类构造新的箭头，且保持复合的定义。

3. **商函子的性质：**
   - 商函子 $Q: \mathcal{C} \rightarrow \mathcal{C} / \sim$ 是一个满函子，能够将 $\mathcal{C}$ 中的箭头映射为商范畴中的同余类。
   - 诱导函子 $F_0: \mathcal{C} / \sim \rightarrow \mathcal{D}$ 是忠实的，保证了商范畴中的箭头在目标范畴中的唯一性。

4. **函子的因式分解：**
   - 每个函子都可以因式分解为一个满函子后跟一个忠实函子，通过商范畴的构造实现。

5. **应用示例：**
   - **编程语言的范畴：** 通过商范畴的构造，定义编程语言的范畴 $C(L)$，并通过函子赋予其语义。
   - **有限集合与有限布尔代数的对偶范畴等价：** 通过具体的函子构造，实现了不同结构之间的等价关系。

6. **习题的作用：**
   - 通过习题，您可以深入理解同余关系的性质、商范畴的构造方法以及函子因式分解的具体应用。

**进一步学习建议：**

- **完成习题：** 通过解答上述习题，巩固对商范畴和函子因式分解的理解。
  
- **探索更复杂的构造：** 学习如何在更一般的情况下构造商范畴，包括合并对象的情况，理解草图（sketches）在这类构造中的作用。
  
- **研究函子语义学：** 深入了解如何通过函子为编程语言等系统赋予数学上的语义，理解函子在模型论和计算机科学中的应用。

通过系统学习和练习，您将能够熟练掌握商范畴的构造与性质，理解其在范畴论中的重要作用，并将这些概念应用于实际的数学和计算机科学问题中。如果您对这些内容有任何疑问，或需要进一步的解释和例子，请随时提问！

### ----------------------------



### ---------------------------



### ----------------------------