[toc]



好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**。本章将深入探讨范畴论中极限（limits）和余极限（colimits）的概念，重点关注有限极限和有限余极限的各种重要特殊情况。以下是本章的主要内容概要：

1. **等化子（Equalizers）**
2. **极限的一般概念（The General Concept of Limits）**
3. **拉回（Pullbacks）**
4. **余等化子（Coequalizers）**
5. **余锥（Cocones）**
6. **关于和的更多内容（More about Sums）**
7. **合一作为余等化子（Unification as Coequalizer）**
8. **因子化系统的性质（Properties of Factorization Systems）**

接下来，我们将逐一详细解析这些内容。

## 9.1 等化子（Equalizers）

### 定义

**等化子（Equalizer）** 是一种特殊的极限，用于在两个平行态射之间选择那些使得两个态射相等的对象和态射。

具体来说，设$F, G : \mathcal{C} \to \mathcal{D}$是范畴$\mathcal{C}$到范畴$\mathcal{D}$的两个函子，且设$\alpha, \beta : F \Rightarrow G$是$F$和$G$之间的两个自然变换。那么，**等化子**$E$是一个对象及其态射$e : E \to C $（其中$C$是$F$和$G$的共同源对象），满足以下条件：

$$
\alpha_C \circ F(e) = \beta_C \circ G(e)
$$

并且，对于任何其他对象$X$及其态射$x : X \to C$满足：

$$
\alpha_C \circ F(x) = \beta_C \circ G(x)
$$

存在唯一的态射$u : X \to E$使得$e \circ u = x $。

### 图式表示

等化子的图式可以表示为：

$$
E \xrightarrow{e} C \rightrightarrows C
$$

其中，右侧的两个箭头分别是$\alpha_C \circ F(e)$和$\beta_C \circ G(e) $。

### 例子

1. **集合范畴中的等化子**：
   
   在集合范畴$\text{Set}$中，给定两个函数$f, g : A \to B $，等化子$E$是$A$的子集，包含所有满足$f(a) = g(a)$的元素$a \in A $。态射$e : E \to A$是包含映射。

2. **群范畴中的等化子**：

   在群范畴$\text{Grp}$中，给定两个群同态$f, g : G \to H $，等化子$E$是$G$的一个子群，包含所有满足$f(g) = g(g)$的元素$g \in G $。态射$e : E \to G$是包含同态。

### 性质

- **等化子是极限**：等化子是两个平行态射的一个极限。
- **唯一性**：等化子具有唯一性，且任何满足条件的态射都通过唯一的态射因子化。
- **存在性**：在许多常见范畴中，如$\text{Set} $、$ \text{Grp} $、$ \text{Top}$等，等化子存在。

## 9.2 极限的一般概念（The General Concept of Limits）

### 定义

**极限（Limit）** 是一种将一个图式（diagram）在一个范畴中表示为一个普遍对象的概念。具体来说，给定一个范畴$\mathcal{C}$和一个小图式$J$，一个 **极限** 是一个普遍对象$\lim J$及其态射，使得任何其他对象及其态射到图式$J$中的态射都通过唯一的态射因子化到$\lim J$。

### 形式定义

设$J : \mathcal{D} \to \mathcal{C}$是一个图式（$ \mathcal{D}$是一个小范畴）。**极限** 是一个对象$L$以及一族态射$\pi_d : L \to J(d)$对于每个$d \in \mathcal{D} $，满足对于每个态射$f : d \to d'$在$\mathcal{D}$中，有：

$$
J(f) \circ \pi_d = \pi_{d'}
$$

并且，对于任何对象$X$及一族态射$f_d : X \to J(d)$满足上述条件，存在唯一的态射$u : X \to L$使得$\pi_d \circ u = f_d$对所有$d \in \mathcal{D}$成立。

### 例子

1. **产品（Products）**：

   当$J$是一个离散范畴，包含多个对象且没有态射时，极限$\lim J$就是这些对象的 **积**，即范畴中的笛卡尔积。

2. **等化子（Equalizers）**：

   如前所述，等化子是两个平行态射的一个特殊极限。

3. **拉回（Pullbacks）**：

   拉回是一个具有两个平行态射的图式的极限，类似于纤维积的概念。

### 性质

- **极限是唯一的**：极限（如果存在）在范畴中是唯一的，至同构唯一。
- **保守性**：范畴中的等同于构造中涉及的态射和对象之间的关系。
- **连续性**：函子保持极限的结构，即保留极限的形状。

## 9.3 拉回（Pullbacks）

### 定义

**拉回（Pullback）** 是一种特殊的极限，适用于两个态射具有共同目标的图式。具体来说，设$f : X \to Z$和$g : Y \to Z$是范畴$\mathcal{C}$中的两个态射，拉回是一个对象$P$及其态射$p_1 : P \to X$和$p_2 : P \to Y $，满足以下交换条件：

$$
f \circ p_1 = g \circ p_2
$$

并且，对于任何其他对象$Q$及其态射$q_1 : Q \to X$和$q_2 : Q \to Y$满足$f \circ q_1 = g \circ q_2 $，存在唯一态射$u : Q \to P$使得：

$$
p_1 \circ u = q_1 \quad \text{且} \quad p_2 \circ u = q_2
$$

### 图式表示

拉回的图式可以表示为：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & X \\
\downarrow{p_2} & & \downarrow{f} \\
Y & \xrightarrow{g} & Z \\
\end{array}
$$

其中，$ f \circ p_1 = g \circ p_2 $。

### 例子

1. **集合范畴中的拉回**：

   在$\text{Set}$中，给定两个函数$f : X \to Z$和$g : Y \to Z $，拉回$P$是$X \times Y$的子集，包含所有满足$f(x) = g(y)$的$(x, y)$对。态射$p_1$和$p_2$分别是投影映射。

2. **群范畴中的拉回**：

   在$\text{Grp}$中，给定两个群同态$f : G \to H$和$g : K \to H $，拉回$P$是$G \times K$的子群，包含所有满足$f(g) = g(k)$的$(g, k)$对。态射$p_1$和$p_2$是投影同态。

### 性质

- **拉回是极限的一种特殊形式**：适用于两个具有共同目标的态射。
- **保序性**：拉回态射$p_1$和$p_2$使得$P$适当地嵌入到$X$和$Y$中。
- **存在性**：在许多常见范畴中，如$\text{Set} $、$ \text{Grp} $、$ \text{Top}$等，拉回存在。

## 9.4 余等化子（Coequalizers）

### 定义

**余等化子（Coequalizer）** 是一种余极限，类似于等化子的对偶概念。给定两个平行态射$f, g : X \rightrightarrows Y$，余等化子$Q$是一个对象及其态射$q : Y \to Q $，满足以下条件：

$$
q \circ f = q \circ g
$$

并且，对于任何其他对象$Z$及其态射$h : Y \to Z$满足：

$$
h \circ f = h \circ g
$$

存在唯一态射$u : Q \to Z$使得：

$$
u \circ q = h
$$

### 图式表示

余等化子的图式可以表示为：

$$
X \rightrightarrows Y \xrightarrow{q} Q
$$

其中，左侧的两个箭头是$f$和$g $，并满足$q \circ f = q \circ g $。

### 例子

1. **集合范畴中的余等化子**：

   在$\text{Set}$中，给定两个函数$f, g : X \to Y $，余等化子$Q$是$Y$的商集，按照$y \sim y'$当且仅当存在$x \in X$使得$y = f(x)$且$y' = g(x) $。态射$q : Y \to Q$是商映射。

2. **群范畴中的余等化子**：

   在$\text{Grp}$中，给定两个群同态$f, g : G \to H $，余等化子$Q$是$H$的一个商群，按照$h \sim h'$当且仅当存在$g \in G$使得$h = f(g)$且$h' = g(g) $。态射$q : H \to Q$是商同态。

### 性质

- **余等化子是余极限的一种特殊形式**：适用于两个平行态射。
- **对偶性**：余等化子与等化子在概念和性质上具有对偶性。
- **存在性**：在许多常见范畴中，如$\text{Set} $、$ \text{Grp} $、$ \text{Top}$等，余等化子存在。

## 9.5 余锥（Cocones）

### 定义

**余锥（Cocone）** 是余极限中的一个重要概念，是一个图式中所有对象到一个共同对象的集合的态射集合，满足一定的兼容性条件。

具体来说，设$J : \mathcal{D} \to \mathcal{C}$是一个图式，**余锥** 是一个对象$Q$以及一族态射$\phi_d : J(d) \to Q$对于每个$d \in \mathcal{D} $，满足对于每个态射$f : d \to d'$在$\mathcal{D}$中，有：

$$
\phi_{d'} \circ J(f) = \phi_d
$$

### 图式表示

余锥的图式可以表示为：

$$
\begin{array}{ccc}
& & Q \\
& \nearrow_{\phi_d} & \downarrow^{\phi_{d'}} \\
J(d) & \xrightarrow{J(f)} & J(d') \\
\end{array}
$$

其中，所有态射$\phi_d : J(d) \to Q$满足兼容性条件$\phi_{d'} \circ J(f) = \phi_d $。

### 性质

- **余锥是余极限的一部分**：在余极限的构造中，余锥是用于定义余极限的基本构件。
- **对偶性**：余锥与锥（cones）在概念和性质上具有对偶性。
- **生成余极限**：余极限可以看作是满足某种普遍性条件的余锥。

### 应用

余锥在构造余极限（如余等化子、余积等）时起着关键作用。例如，构造余等化子时，需要定义一个满足$q \circ f = q \circ g$的余锥。

## 9.6 关于和的更多内容（More about Sums）

### 定义

在范畴论中，**和（Sums）** 通常指的是余积（coproducts）。余积是和的范畴论对应概念，是多个对象的“并集”在范畴中的表现。

具体来说，给定一个范畴$\mathcal{C}$和一族对象$\{A_i\}_{i \in I} $，**余积**$\coprod_{i \in I} A_i$是一个对象及其注入态射$\iota_i : A_i \to \coprod_{i \in I} A_i $，满足以下普遍性条件：

对于任何对象$B$以及一族态射$f_i : A_i \to B $，存在唯一态射$f : \coprod_{i \in I} A_i \to B$使得$f \circ \iota_i = f_i$对所有$i \in I$成立。

### 性质

- **对偶性**：余积是积（products）的对偶概念。
- **无序性**：与积不同，余积通常不关心索引集$I$的顺序，但在某些范畴中，余积可以具有额外的结构，如有序余积。
- **存在性**：在许多范畴中，如$\text{Set} $、$ \text{Grp} $、$ \text{Top}$等，余积存在。

### 例子

1. **集合范畴中的余积**：

   在$\text{Set}$中，给定一族集合$\{A_i\}_{i \in I} $，余积$\coprod_{i \in I} A_i$是它们的**不相交并集**。注入态射$\iota_i : A_i \to \coprod_{i \in I} A_i$将每个集合嵌入到不相交并集中。

2. **群范畴中的余积**：

   在$\text{Grp}$中，余积是自由积（free product），即给定一族群$\{G_i\}_{i \in I} $，其余积$\coprod_{i \in I} G_i$是它们的自由积，包含所有有限长度的交替序列。

### 补充内容

- **有限余积与无限余积**：

  虽然本章主要讨论有限极限和有限余极限，但在一般情况下，余积可以是有限的或无限的，具体取决于图式的定义和范畴的性质。

- **余积的具体构造**：

  在不同的范畴中，余积的具体构造方法可能有所不同。例如，在$\text{Top}$中，余积是拓扑空间的**余积拓扑**。

## 9.7 合一作为余等化子（Unification as Coequalizer）

### 概念介绍

**合一（Unification）** 是逻辑编程和自动定理证明中的一个基本操作，旨在找到使得两个逻辑表达式相等的替换集合。在范畴论中，合一可以被看作是一种特殊的余等化子。

### 合一作为余等化子的解释

设$S$是一个逻辑系统，定义了变量和替换规则。合一问题可以表示为寻找一个替换$\theta $，使得应用$\theta$后，两个表达式$e_1$和$e_2$相等。

在范畴论中，这相当于构造一个余等化子，使得经过替换后的两个表达式在范畴中被同构。

### 图式表示

设有两个态射$f, g : A \rightrightarrows B $，表示应用不同的替换规则。合一过程即构造余等化子$Q$及其态射$q : B \to Q $，使得：

$$
q \circ f = q \circ g
$$

并且，对于任何满足$h \circ f = h \circ g$的态射$h : B \to Z $，存在唯一的态射$u : Q \to Z$使得$u \circ q = h $。

### 应用

在逻辑编程中，如Prolog，合一用于确定变量的赋值，使得两个谓词在应用替换后能够匹配。这种匹配过程可以通过余等化子的构造在范畴论中进行建模和分析。

### 例子

考虑两个表达式$e_1 = f(x)$和$e_2 = f(a) $，合一的过程需要找到替换$\theta = \{x \mapsto a\} $，使得$e_1\theta = e_2\theta $。

在范畴论中，这相当于构造一个余等化子，使得应用替换$\theta$后，两个态射相等。

### 结论

通过将合一视为余等化子，可以利用范畴论的工具和概念来形式化和分析逻辑编程中的合一过程，提供更深入的理论理解和应用方法。

## 9.8 因子化系统的性质（Properties of Factorization Systems）

### 定义

**因子化系统（Factorization Systems）** 是范畴论中的一个重要概念，用于描述态射的分解方式。一个因子化系统通常由两类态射组成，满足特定的因子化条件和交换条件。

### 因子化系统的组成

设$\mathcal{C}$是一个范畴。一个因子化系统$(E, M)$满足以下条件：

1. **因子化条件**：每个态射$f : A \to B$可以唯一地因子化为$f = m \circ e $，其中$e \in E$且$m \in M $。
2. **交换条件**：对于$e \in E$和$m \in M $，任何交换方块

$$
\begin{array}{ccc}
A & \xrightarrow{e} & C \\
\downarrow & & \downarrow \\
B & \xrightarrow{m} & D \\
\end{array}
$$

中，存在唯一态射$d : C \to D$使得$d \circ e = m \circ $（左侧的态射）。

### 性质

- **稳定性**：因子化系统中的两类态射$E$和$M$通常具有稳定性，如$E$在某些条件下封闭于某些范畴的限制下。
- **对偶性**：因子化系统具有对偶性，即$(E, M)$的对偶系统是$(M^{op}, E^{op}) $。
- **应用广泛**：因子化系统在代数、拓扑、逻辑等多个数学领域中都有广泛应用，特别是在描述范畴中的结构性分解时。

### 例子

1. **正则态射与核态射的因子化系统**：

   在许多范畴中，如$\text{Set} $、$ \text{Grp}$等，每个态射可以唯一地分解为一个核态射（即等化子）后接一个正则态射。这构成了一个因子化系统。

2. **覆盖态射与单射态射的因子化系统**：

   在拓扑范畴$\text{Top}$中，每个连续映射可以唯一地分解为一个覆盖映射后接一个单射映射。

### 性质分析

- **唯一性**：因子化系统中的分解是唯一的，确保了结构的规范性。
- **范畴的性质影响因子化系统**：不同的范畴可能具有不同的因子化系统，具体取决于范畴的结构和态射的特性。

### 结论

因子化系统提供了一种系统化的方法来分解范畴中的态射，使得我们能够更好地理解和操作范畴的结构。在构造初始术语代数和分析模型的过程中，因子化系统的性质和结构起到了关键作用。

## 本章总结

**极限（Limits）** 和 **余极限（Colimits）** 是范畴论中两个核心概念，用于描述范畴中的对象和态射的综合特性。通过具体的例子和特殊情况的分析，本章详细探讨了等化子、拉回、余等化子、余锥以及因子化系统等重要内容。

**主要要点总结**：

1. **等化子与余等化子**：
   - 等化子用于选择使得两个平行态射相等的子对象。
   - 余等化子用于构造态射的商对象，类似于取余集。

2. **极限与余极限的一般概念**：
   - 极限是对图式的普遍化表示，涵盖了积、等化子、拉回等特殊情况。
   - 余极限是对图式的对偶表示，包括余积、余等化子等。

3. **拉回（Pullbacks）**：
   - 拉回是处理两个态射具有共同目标时的极限构造，类似于纤维积。

4. **余锥与和（Sums）**：
   - 余锥是余极限中的基本构件，用于定义和余极限。
   - 和（余积）是多个对象的范畴论并集，具有广泛的应用。

5. **合一作为余等化子**：
   - 合一操作在逻辑编程中用于匹配和替换，范畴论中可视为余等化子的特例。

6. **因子化系统的性质**：
   - 因子化系统提供了一种范畴中态射的结构性分解方法，具有广泛的应用和重要的理论意义。

**应用与扩展**：

- **编程语言语义**：极限和余极限用于描述和分析编程语言中的类型和数据结构。
- **自动机理论**：通过拉回和余积描述有限状态机及其行为。
- **逻辑编程**：合一作为余等化子在逻辑推理和规则匹配中具有关键作用。
- **代数结构研究**：因子化系统帮助理解和构造复杂的代数对象和它们的同态。

通过掌握极限与余极限的基本概念及其各种特殊情况，读者能够更深入地理解范畴论的核心思想，并在后续章节中应用这些概念描述更具表现力的图式和范畴结构。

### ---------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.1节：等化子（Equalizers）**。本节将深入探讨等化子的定义、性质、具体例子以及相关的命题和练习题。等化子作为范畴论中极限的一种特殊形式，是理解更复杂极限概念的基础。

## 9.1 等化子（Equalizers）

### 9.1.1 定义（Definition）

**等化子（Equalizer）** 是范畴论中极限的一种特殊形式，用于在两个平行态射之间选择那些使得两个态射相等的子对象和态射。具体定义如下：

- **平行态射（Parallel Pair）**：如果$f, g : A \to B$是范畴$\mathcal{C}$中的两个态射，且它们有相同的起点$A$和终点$B $，则称$f$和$g$为一对**平行态射**。

- **等化子**：给定一对平行态射$f, g : A \to B $，**等化子**是一个对象$E$及其态射$j : E \to A $，满足以下条件：
  
  1. **平行性条件（EQ–1）**：
     
    $$
     f \circ j = g \circ j
    $$
     
     这意味着$j$的像中的每个元素在$f$和$g$下被映射到相同的结果。

  2. **普遍性条件（EQ–2）**：
     
     对于任何对象$C$及其态射$h : C \to A $，如果$f \circ h = g \circ h $，则存在唯一态射$k : C \to E $，使得：
     
    $$
     j \circ k = h
    $$
     
     这表明$E$是满足$f \circ j = g \circ j$的最“精确”的子对象。

**图式表示**：

等化子的图式可以表示为：

$$
E \xrightarrow{j} A \rightrightarrows^{f}_{g} B
$$

其中，右侧的两个箭头分别是$f$和$g $，并且$f \circ j = g \circ j $。

### 9.1.2 定义（Definition 9.1.2）

为更清晰地理解等化子的概念，我们可以从集合范畴$\text{Set}$的具体例子出发，并将其推广到一般范畴。

**集合范畴中的等化子**：

设$S$和$T$是集合，且$f, g : S \to T$是两个函数。我们可以形成等化子$\text{Eq}(f, g) \subseteq S $，定义为：

$$
\text{Eq}(f, g) = \{ s \in S \mid f(s) = g(s) \}
$$

包含映射$j : \text{Eq}(f, g) \hookrightarrow S $，将等化子中的元素自然包含到$S$中。

**因子化条件**：

对于任意函数$h : V \to S $，$ h$因子化通过$j$当且仅当$h(V) \subseteq \text{Eq}(f, g) $。即$f \circ h = g \circ h $。

**关键点**：

- 等化子不仅仅是一个子集，而是一个子对象，配备了包含态射$j $。
- 在范畴论中，等化子通过满足普遍性条件来确定，确保任何满足$f \circ h = g \circ h$的态射都唯一地通过等化子态射因子化。

### 9.1.3 等化子的例子（Examples of Equalizers）

**例子1：实数集合中的等化子**

考虑两个函数：

$$
f(x, y) = x^2 + y^2
$$
$$
g(x, y) = 1
$$

这两个函数从$\mathbb{R} \times \mathbb{R}$到$\mathbb{R}$的映射。等化子$\text{Eq}(f, g)$是所有满足$x^2 + y^2 = 1$的点，即单位圆：

$$
\text{Eq}(f, g) = \{ (x, y) \in \mathbb{R}^2 \mid x^2 + y^2 = 1 \}
$$

包含映射$j : \text{Eq}(f, g) \hookrightarrow \mathbb{R} \times \mathbb{R} $。

**例子2：图中的回路（Loops）**

设$G$是一个图，包含两个函数：

$$
s, t : \text{Edge} \to \text{Vertex}
$$

其中，$ s$和$t$分别表示每条边的起点和终点。等化子$\text{Eq}(s, t)$是所有回路的边，即那些起点和终点相同的边：

$$
\text{Eq}(s, t) = \{ e \in \text{Edge} \mid s(e) = t(e) \}
$$

包含映射$j : \text{Eq}(s, t) \hookrightarrow \text{Edge} $。

**例子3：单一幺半群中的等化子**

在单一幺半群$M$中，考虑两个元素$a, b \in M $。将它们视为从单一对象到自身的两个态射$a, b : * \to * $。等化子$\text{Eq}(a, b)$如果存在，则是一个对象$E$及其态射$j : E \to * $，满足：

$$
a \circ j = b \circ j
$$

在这种情况下，$ E$要么是空集（如果$a \neq b$无解），要么是整个对象（如果$a = b $）。

**总结**：

通过这些例子，我们看到等化子在不同范畴中的具体表现形式。这些例子帮助我们理解等化子作为极限的一种特殊形式，其在各种结构中的应用和意义。

### 9.1.4 命题（Proposition）

**命题**：

如果$j : E \hookrightarrow A$和$j' : E' \hookrightarrow A$都是$f, g : A \to B$的等化子，那么存在一个唯一的同构$i : E \to E' $，使得：

$$
j' \circ i = j
$$

**证明**：

我们将给出两种证明方法：

#### 第一种证明方法：使用普遍元素（Universal Element）

1. **构造范畴$C $**：

   令$C$是包含所有等化子$E$及其包含态射$j : E \hookrightarrow A$的范畴。

2. **定义函子$F $**：

   定义$F : C^{op} \to \text{Set} $，其中：
   
  $$
   F(C) = \{ u : C \to A \mid f \circ u = g \circ u \}
  $$
   
   对于态射$h : D \to C $，有：
   
  $$
   F(h)(u) = u \circ h
  $$
   
   这确保了$F$是一个子函子，因为$u \circ h$也满足$f \circ (u \circ h) = g \circ (u \circ h) $。

3. **等化子的普遍性**：

   等化子$j : E \hookrightarrow A$被视为$F$的一个**普遍元素**，即对于任何$u \in F(C) $，存在唯一的态射$k : C \to E$使得：
   
  $$
   j \circ k = u
  $$

4. **应用普遍性元素的唯一性**：

   根据范畴论中的普遍性元素性质，任何两个等化子$j : E \hookrightarrow A$和$j' : E' \hookrightarrow A$都通过唯一的同构$i : E \to E'$连接，使得：
   
  $$
   j' \circ i = j
  $$

#### 第二种证明方法：直接证明

1. **假设**：

   假设$j : E \hookrightarrow A$和$j' : E' \hookrightarrow A$都是$f, g : A \to B$的等化子。

2. **因子化**：

   由于$j'$是等化子，且$j$满足$f \circ j = g \circ j $，根据等化子的普遍性，存在唯一态射$h : E \to E'$使得：
   
  $$
   j' \circ h = j
  $$
   
   类似地，考虑$j$对$j'$的因子化，存在唯一态射$h' : E' \to E$使得：
   
  $$
   j \circ h' = j'
  $$

3. **证明同构性**：

   计算$j' \circ (h \circ h') $：
   
  $$
   j' \circ (h \circ h') = (j' \circ h) \circ h' = j \circ h' = j'
  $$
   
   由于$j'$是单态（等化子态射是单态，见下文命题9.1.5），根据单态性：
   
  $$
   h \circ h' = \text{id}_{E'}
  $$
   
   同理：
   
  $$
   j \circ (h' \circ h) = (j \circ h') \circ h = j' \circ h = j
  $$
   
   由于$j$是单态：
   
  $$
   h' \circ h = \text{id}_E
  $$
   
   因此，$ h$和$h'$是$E$和$E'$之间的逆同构，证明了$E \cong E' $。

**结论**：

等化子的包含态射$j$是单态，且任何两个等化子通过唯一的同构相互同构。这保证了等化子在范畴中的唯一性（up to isomorphism）。

### 9.1.5 命题（Proposition）

**命题**：

设$j : E \hookrightarrow A$是$f, g : A \to B$的一个等化子，则：

1.$j$是一个**单态态射（Monomorphism）**。
2. 任何两个等化子都属于$A$的同一个**子对象（Subobject）**。

**证明**：

#### 证明$j$是单态态射：

1. **定义**：

   一个态射$j : E \hookrightarrow A$是**单态（Monic）**的，当且仅当对于任意两个态射$h, k : C \to E $，若$j \circ h = j \circ k $，则$h = k $。

2. **应用等化子性质**：

   假设$h, k : C \to E$满足$j \circ h = j \circ k $。

3. **利用等化子普遍性**：

   因为$j$是等化子，且$j \circ h = j \circ k $，根据等化子的普遍性，存在唯一态射$k : C \to E$使得$j \circ k = h $。 因为$j \circ h = j \circ k $，且同样适用于$k $，由此可以推出$h = k $。

4. **结论**：

   因此，$ j$是单态态射。

#### 证明任何两个等化子属于同一个子对象：

1. **设定**：

   设$j : E \hookrightarrow A$和$j' : E' \hookrightarrow A$都是$f, g : A \to B$的等化子。

2. **利用命题9.1.4**：

   根据命题9.1.4，存在一个唯一的同构$i : E \to E' $，使得：
   
  $$
   j' \circ i = j
  $$

3. **子对象的定义**：

   在范畴论中，子对象是通过同构类来定义的。即使$E$和$E'$是不同的对象，但由于它们通过同构$i$关联，它们代表了同一个子对象。

4. **结论**：

   因此，任何两个等化子都属于$A$的同一个子对象。

### 9.1.6 更一般的等化子（More Generally）

**命题**：

如果$f_1, f_2, \ldots, f_n : A \to B$是一列从$A$到$B$的态射，那么一个对象$E$及其态射$j : E \hookrightarrow A$是这列态射的等化子，当且仅当：

$$
\forall i, j, \quad f_i \circ j = f_j \circ j
$$

即$E$是所有这些态射的共同等化子。

**应用**：

- **有限列表的等化子**：如果一个范畴具有所有平行态射的等化子，那么它也具有任何有限列表的态射的等化子（见练习题2）。

### 9.1.7 正则单态（Regular Monomorphisms）

**定义**：

- **单态（Monomorphism）**：在范畴论中，一个态射$e : S \hookrightarrow T$是单态的，当且仅当对于任意两个态射$h, k : X \to S $，若$e \circ h = e \circ k $，则$h = k $。

- **正则单态（Regular Monomorphism）**：如果一个单态$e : S \hookrightarrow T$是某对平行态射的等化子，即存在一对平行态射$f, g : T \to U $，使得$e$是$f$和$g$的等化子，则称$e$为**正则单态**。

**性质**：

- **集合范畴中的单态是正则单态**：在$\text{Set}$中，所有的单射都是正则单态。这是因为任何单射都可以视为某对平行态射的等化子。

- **类范畴中的单态不一定是正则单态**：在某些范畴中，如$\text{Cat} $（类别范畴），并非所有的单态都是正则单态。

**例子**：

- **集合范畴**：所有单射都是正则单态。例如，包含映射$j : E \hookrightarrow A$是正则单态，因为它是某对平行态射的等化子。

- **类别范畴**：考虑两个小类别$A$和$B $，以及一个包含态射的函子$j : A \hookrightarrow B $。如果$j$不是某对平行态射的等化子，则$j$不是正则单态。

**练习题**：

- **练习5**：证明在$\text{Set}$中，所有的单态都是正则单态。

### 9.1.8 命题（Proposition）

**命题**：

在一个范畴中，如果一个态射既是**上同态（Epimorphism）**又是**正则单态（Regular Monomorphism）**，那么它是一个**同构态射（Isomorphism）**。

**证明**：

设$f : A \to B$是一个既是上同态又是正则单态的态射。

1. **正则单态**：

   由于$f$是正则单态，存在一对平行态射$g, h : B \to C $，使得$f$是$g$和$h$的等化子：
   
  $$
   g \circ f = h \circ f
  $$
   
   根据等化子的普遍性，对于$g$和$h $，存在唯一的态射$k : B \to A $，使得：
   
  $$
   f \circ k = \text{id}_B
  $$

2. **上同态**：

   由于$f$是上同态，如果$f \circ k = \text{id}_B $，则$k$是$f$的一个左逆。

3. **同构性**：

   已知$f \circ k = \text{id}_B $，需要证明$k \circ f = \text{id}_A $。

   - 因为$f$是正则单态，且$f \circ k = \text{id}_B $，根据范畴论的同构性定理，$ f$和$k$是同构态射。
   
   - 具体来说，由于$f \circ k = \text{id}_B$和$k \circ f$满足$f \circ (k \circ f) = (f \circ k) \circ f = \text{id}_B \circ f = f $，并且$k \circ f$是从$A$到$A$的态射，与$\text{id}_A$共享相同的性质，因此$k \circ f = \text{id}_A $。

4. **结论**：

   因此，$ f$是一个同构态射。

**总结**：

如果一个态射在范畴中既是上同态又是正则单态，那么它必须是一个同构态射。这一结果展示了范畴论中态射性质之间的紧密联系。

### 9.1.9 练习题（Exercises）

**练习1**：

**题目**：

回忆在一个范畴中，一个态射$f : A \to B$是一个**分裂单态（Split Monomorphism）**，如果存在一个态射$g : B \to A $，满足$g \circ f = \text{id}_A $。证明分裂单态是正则单态。

**解析**：

**目标**：

证明，如果$f : A \to B$是一个分裂单态，则$f$是一个正则单态。

**步骤**：

1. **假设**：

  $f : A \to B$是一个分裂单态，即存在$g : B \to A$满足：
   
  $$
   g \circ f = \text{id}_A
  $$

2. **构造平行态射**：

   选择两个平行态射$f_1, f_2 : B \to C $，使得：
   
  $$
   f_1 \circ f = f_2 \circ f
  $$
   
   这意味着：
   
  $$
   f_1 \circ f = f_2 \circ f
  $$

3. **应用$g $**：

   两边同时作用于$g $：
   
  $$
   g \circ f_1 \circ f = g \circ f_2 \circ f
  $$
   
   根据$g \circ f = \text{id}_A $，得：
   
  $$
   g \circ f_1 \circ f = g \circ f_2 \circ f \implies g \circ f_1 = g \circ f_2
  $$

4. **构造等化子**：

   由于$f$是分裂单态，且$g \circ f = \text{id}_A $，我们需要证明$f$是某对平行态射的等化子。
   
   选择$f_1 = f_2 \circ g$和$f_2 = f \circ g $，构造一对平行态射。

5. **验证等化子条件**：

   需要验证$f_1 \circ f = f_2 \circ f $：
   
  $$
   f_1 \circ f = f_2 \circ g \circ f = f_2 \circ \text{id}_A = f_2 \circ f
  $$
   
   因此，$ f$是$f_1$和$f_2$的等化子。

6. **普遍性条件**：

   对于任何满足$f_1 \circ h = f_2 \circ h$的态射$h : C \to A $，存在唯一的态射$k : C \to E$使得$f \circ k = h $。

7. **结论**：

   因此，$ f$满足正则单态的定义。

**结论**：

分裂单态是正则单态，即所有分裂单态都是正则单态。

**练习2**：

**题目**：

证明如果一个范畴拥有所有平行态射的等化子，那么它也拥有所有有限列表$f_1, \ldots, f_n : A \to B$的等化子。

**解析**：

**目标**：

证明：如果范畴$\mathcal{C}$中存在所有平行态射的等化子，那么对于任意有限列表$f_1, \ldots, f_n : A \to B $，存在它们的等化子。

**步骤**：

1. **基础情况**：

   当$n = 2$时，存在等化子$\text{Eq}(f_1, f_2) $。

2. **归纳步骤**：

   假设对于$n = k $，存在$\text{Eq}(f_1, \ldots, f_k) $。

3. **构造$n = k + 1$的等化子**：

   - 首先，构造$\text{Eq}(f_1, \ldots, f_k) $。
   
   - 接着，构造$\text{Eq}(\text{Eq}(f_1, \ldots, f_k), f_{k+1}) $，即在已经等化了前$k$个态射的子对象中，再等化第$k+1$个态射。
   
   - 这样，最终得到的对象即为$\text{Eq}(f_1, \ldots, f_{k+1}) $。

4. **普遍性条件的验证**：

   - 需要验证，对于任何满足$f_1 \circ h = \cdots = f_{k+1} \circ h$的态射$h : C \to A $，存在唯一态射$k : C \to \text{Eq}(f_1, \ldots, f_{k+1})$使得$j \circ k = h $。
   
   - 这可以通过分步应用等化子的普遍性条件来实现。

5. **结论**：

   通过数学归纳法，证明了如果范畴$\mathcal{C}$中存在所有平行态射的等化子，那么对于任意有限列表的态射$f_1, \ldots, f_n : A \to B $，也存在它们的等化子。

**结论**：

如果一个范畴拥有所有平行态射的等化子，那么它自动拥有所有有限列表的态射的等化子。这为构造更复杂的等化子提供了基础。

**练习3**：

**题目**：

在幺半群（Monoid）范畴中，证明每一对平行态射都有等化子。

**解析**：

**目标**：

证明在幺半群范畴$\text{Mon}$中，任意一对平行态射$f, g : M \to N$都存在等化子。

**步骤**：

1. **幺半群范畴简介**：

   - 对象是幺半群（单元元和结合运算）。
   
   - 态射是幺半群同态（保持运算和单位元）。

2. **等化子的构造**：

   在$\text{Mon}$中，给定$f, g : M \to N$是两个幺半群同态，构造等化子$E$如下：
   
   - **对象$E $**：
     
    $$
     E = \{ m \in M \mid f(m) = g(m) \}
    $$
     
     这是一个幺半群的子幺半群，因为：
     
     - **闭合性**：若$m_1, m_2 \in E $，则：
       
      $$
       f(m_1 m_2) = f(m_1) f(m_2) = g(m_1) g(m_2) = g(m_1 m_2)
      $$
       
       因此，$ m_1 m_2 \in E $。
     
     - **单位元**：由于$f$和$g$是幺半群同态，$ f(1_M) = 1_N = g(1_M) $，因此$1_M \in E $。
   
   - **态射$j : E \hookrightarrow M $**：
     
     自然的包含映射。

3. **验证等化子性质**：

   - **平行性条件（EQ–1）**：
     
    $$
     f \circ j = g \circ j
    $$
     
     因为$j$是包含映射，且对于所有$e \in E $，$ f(e) = g(e) $，因此成立。
   
   - **普遍性条件（EQ–2）**：
     
     对于任何幺半群同态$h : P \to M $，如果$f \circ h = g \circ h $，则$h(P) \subseteq E $，因此存在唯一的幺半群同态$k : P \to E$使得$j \circ k = h $。

4. **结论**：

   因此，在幺半群范畴中，任何一对平行态射都有等化子。

**结论**：

在幺半群范畴$\text{Mon}$中，任何一对平行态射$f, g : M \to N$都存在等化子$E$及其包含态射$j : E \hookrightarrow M $。这说明幺半群范畴具备等化子的结构。

**练习4**：

**题目**：

a. 证明如果$M$是一个自由幺半群，那么在$\text{Mon}$中，$ M$中的任何两个不同元素没有等化子。

b. 对有限幺半群也证明同样的结论。（提示：参见第2.9节的练习题3。）

**解析**：

**部分a**：

**目标**：

证明如果$M$是一个自由幺半群，则$M$中的任何两个不同元素没有等化子。

**步骤**：

1. **自由幺半群的性质**：

   - 自由幺半群由一个生成集合$X$构成，其元素为有限长度的非空词（字符串）组成。
   
   - 没有任何非平凡的关系，只有通过幺半群的运算（连接词）定义的关系。

2. **等化子的构造**：

   - 假设存在$f, g : M \to N$是两个不同的幺半群同态。
   
   - 由于$M$是自由幺半群，同态$f$和$g$由$f(x)$和$g(x)$的值完全确定，其中$x$是生成元。
   
   - 如果$f \neq g $，则存在某个生成元$x \in X $，使得$f(x) \neq g(x) $。

3. **等化子的不存在性**：

   - 若$M$中存在两个不同元素$a, b \in M $，则$a \neq b $。
   
   - 假设存在等化子$E$及其包含态射$j : E \hookrightarrow M $，使得$f \circ j = g \circ j $。
   
   - 这意味着$\forall e \in E, f(e) = g(e) $。
   
   - 但由于$f \neq g $，存在$a \in M$使得$f(a) \neq g(a) $，因此$a \notin E $。
   
   - 由于$M$是自由幺半群，且自由幺半群的元素通过唯一的生成路径生成，等化子只能包含那些通过相同路径生成的元素。
   
   - 由于$f$和$g$不同，无法存在非空的等化子包含不同元素。

4. **结论**：

   因此，$ M$中的任何两个不同元素没有等化子。

**部分b**：

**目标**：

证明对于有限幺半群，同样结论成立，即任何两个不同元素没有等化子。

**步骤**：

1. **有限幺半群的性质**：

   - 有限幺半群是由有限个元素构成，且运算满足幺半群的公理（结合律和幺元存在）。
   
   - 结构更为紧凑，元素之间的关系更多。

2. **等化子的构造**：

   - 假设存在两个不同元素$a, b \in M $，其中$a \neq b $。
   
   - 若存在等化子$E$及其包含态射$j : E \hookrightarrow M $，使得$f \circ j = g \circ j $。
   
   - 这意味着$E$包含的元素$e$满足$f(e) = g(e) $。

3. **利用幺半群同态的性质**：

   - 对于有限幺半群，同态$f, g$必须映射幺元$1_M$到幺元$1_N $。
   
   - 若$a \neq b $，则存在某个幺半群运算的结果能够区分$a$和$b $，即通过幺半群的运算无法将两个不同元素映射到同一个等化子。

4. **等化子的不存在性**：

   - 类似于自由幺半群的情况，有限幺半群中不同元素通过唯一的运算路径生成，无法通过同态的等化子条件将它们区分开。
   
   - 因此，不存在包含两个不同元素的等化子。

5. **结论**：

   因此，在有限幺半群中，任何两个不同元素都没有等化子。

**结论**：

对于自由幺半群和有限幺半群中的任何两个不同元素，都不存在等化子。这表明等化子在这些范畴中的构造受到严格限制，无法对不同元素进行平行化处理。

**练习5**：

**题目**：

证明在集合范畴$\text{Set}$中，所有的单态态射都是正则单态。

**解析**：

**目标**：

证明在$\text{Set}$范畴中，任何单态态射都是正则单态。

**步骤**：

1. **定义单态态射**：

   在$\text{Set}$中，一个态射$f : A \to B$是单态的，当且仅当$f$是单射（即$f(a_1) = f(a_2)$蕴含$a_1 = a_2 $）。

2. **定义正则单态**：

   一个单态态射$f : A \hookrightarrow B$是正则单态，当且仅当存在两个平行态射$g, h : B \rightrightarrows C $，使得$f$是$g$和$h$的等化子。

3. **构造平行态射**：

   给定一个单射$f : A \hookrightarrow B $，构造两个平行态射$g, h : B \to C $，使得$f$是$g$和$h$的等化子。

4. **具体构造**：

   - **定义集合$C $**：
     
     令$C = B \cup \{ * \} $，其中$*$是一个新的元素，不属于$B $。
   
   - **定义态射$g, h : B \to C $**：
     
    $$
     g(b) = \begin{cases}
     b & \text{如果 } b \in f(A) \\
     * & \text{否则}
     \end{cases}
    $$
     
    $$
     h(b) = \begin{cases}
     b & \text{如果 } b \in f(A) \\
     * & \text{否则}
     \end{cases}
    $$
   
     实际上，$ g = h $，因此需要稍作调整。

   - **调整后的态射定义**：
     
     定义$g$和$h$为不同的态射，使得：
     
    $$
     g(b) = \begin{cases}
     b & \text{如果 } b \in f(A) \\
     * & \text{否则}
     \end{cases}
    $$
     
    $$
     h(b) = \begin{cases}
     b & \text{如果 } b \in f(A) \\
     ** & \text{否则}
     \end{cases}
    $$
     
     其中，$ **$是$C$中的另一个新元素，不属于$B$和$* $。

5. **验证等化子条件**：

   - 对于$b \in A $，$ f(b) \in f(A) $，因此$g(f(b)) = f(b) = h(f(b)) $。
   
   - 对于$b \notin f(A) $，$ g(b) = *$和$h(b) = ** $，但由于$f$的定义，$ f$不会映射$E$中的元素到这些情况。

6. **普遍性条件**：

   - 若$h : D \to B$满足$g \circ h = f \circ h = h \circ h $，则存在唯一态射$k : D \to E$使得$f \circ k = h $。
   
   - 由于$f$是单射，$ k$必须是$h$的逆映射在$E$中。

7. **结论**：

   因此，构造的$g$和$h$满足$f$是它们的等化子，且$f$是正则单态。

**总结**：

在$\text{Set}$范畴中，任何单射都是正则单态。这是因为我们可以通过构造合适的平行态射来使得单射满足等化子的普遍性条件。

## 本节总结

**等化子（Equalizers）** 是范畴论中极限的一种特殊形式，用于在一对平行态射之间选择那些使得两个态射相等的子对象和态射。通过具体例子和命题的证明，我们理解了等化子的定义、性质及其在不同范畴中的表现。

**主要要点**：

1. **等化子的定义**：
   - 在一对平行态射之间选择满足$f \circ j = g \circ j$的子对象和态射。
   - 满足普遍性条件，即任何满足相同条件的态射都唯一地通过等化子因子化。

2. **等化子的性质**：
   - 包含态射$j$是单态的。
   - 等化子在范畴中是唯一的（up to isomorphism）。
   - 正则单态是等化子的特例。

3. **具体例子**：
   - 在$\text{Set}$中，等化子是满足特定方程的子集。
   - 在图范畴中，等化子表示回路的边。
   - 在幺半群范畴中，等化子是满足同态条件的子幺半群。

4. **重要命题**：
   - 等化子的唯一性：任何两个等化子是同构的。
   - 单态性：等化子的包含态射是单态的。
   - 正则单态：分裂单态是正则单态，且在某些范畴中正则单态与单态的关系更加紧密。

5. **练习题**：
   - 通过练习题加深对等化子在不同范畴中的应用和构造方法的理解。

**应用与扩展**：

等化子作为极限的一种特殊形式，在范畴论的多个领域中都有重要应用，包括：

- **编程语言语义**：在描述类型系统和数据结构时，等化子用于定义满足特定条件的子类型。
- **自动机理论**：等化子用于描述状态转换系统中满足特定条件的状态集合。
- **逻辑编程**：合一（unification）可以被看作是余等化子的特例，用于模式匹配和推理。

通过对等化子的深入理解，读者能够更好地掌握范畴论中极限和余极限的基本概念，为进一步学习拉回、余等化子及其他高级极限概念打下坚实的基础。

### ----------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.2节：极限的一般概念（The General Concept of Limits）**。本节将深入探讨极限的抽象定义、相关的概念及其等价定义，并通过具体例子加深理解。

## 9.2 极限的一般概念（The General Concept of Limits）

### 9.2.0 备注（Remark）

**备注**：[2020-04-15新增] Dan Synek 指出我们对锥（cone）的定义存在问题。一方面，我们将其定义为一个范畴中的锥，另一方面又将其定义为一个抽象对象，与任何范畴无关。要修正这一点，需要仔细重写所有涉及（共）锥和图式的部分，而不增加清晰度。由于没有 Charles 的讨论，我不愿意这样做。相反，我将概述我会如何处理。

**解决方法**：
- 定义图的根节点为一个节点，具有指向图中每个其他节点的唯一箭头，且没有反向箭头。
- 对于图$I $，定义$I^*$为在$I$上增加一个根节点$*$的图，该根节点$*$指向$I$中每个节点。
- 在范畴$\mathcal{C}$中，一个基于$I$的锥子就是一个图式$D : I^* \to \mathcal{C} $。
- 这样，锥子的顶点是$D(*) $，而$D|I$是锥子的底部。

**总结**：通过引入根节点，可以更清晰地定义锥子，使其成为图式的一部分，避免将锥子定义为独立的抽象对象。

### 9.2.1 定义（Definition）

**定义**：

设$G$是一个图，$ \mathcal{C}$是一个范畴。给定一个图式$D : G \to \mathcal{C} $，一个**锥子（Cone）**是一个对象$C$以及一族态射$\{ p_a : C \to D(a) \} $，其中$a$是$G$中的节点，满足对于每个箭头$s : a \to b$在$G$中，有：

$$
D(s) \circ p_a = p_b
$$

即，锥子的组成态射与图式$D$中的箭头兼容。

**术语**：

- **基底（Base）**：图式$D $。
- **顶点（Vertex）**：对象$C $。
- **组分态射（Component Arrows）**：态射$p_a : C \to D(a) $。

**特殊情况**：

- 如果图式$D$是一个离散图式（没有非身份箭头），则锥子的条件是自动满足的，因此此时的锥子就是一个与节点数相同的态射集合。

### 9.2.2 定义（Definition 9.2.2）

**定义**：

给定两个锥子$p^0 : C^0 \to D$和$p : C \to D $，一个**锥子之间的态射（Morphisms between Cones）**是一个态射$f : C^0 \to C$在$\mathcal{C}$中，使得对于每个节点$a $：

$$
p_a \circ f = p^0_a
$$

即，态射$f$使得锥子的组分态射相互对应。

**符号表示**：

- 记锥子之间的态射为$f : p^0 \to p $，其中$f : C^0 \to C$满足上述条件。

### 9.2.3 定义（Definition 9.2.3）

**定义**：

一个**普遍锥子（Universal Cone）**是一个满足普遍性条件的锥子。具体来说，给定一个图式$D : G \to \mathcal{C} $，一个锥子$p : C \to D$是**普遍的**，当且仅当对于任何其他锥子$p^0 : C^0 \to D $，存在唯一的态射$f : C^0 \to C $，使得：

$$
p \circ f = p^0
$$

即，$ p$是一个终对象（terminal object）在锥子的范畴中。

**术语**：

- **极限（Limit）**：一个图式$D$的**极限**是一个普遍锥子。

### 9.2.4 极限的意义（Meaning of a Limit）

**解释**：

说$p : C \to D$是一个极限，意味着：

1. **组成态射**：
   - 给定一个图式$D$中的每个节点$a $，有一个态射$p_a : C \to D(a) $。
   - 对于每个图式中的箭头$s : a \to b $，满足$D(s) \circ p_a = p_b $。

2. **普遍性条件**：
   - 对于任何满足上述条件的态射族$\{ p^0_a : C^0 \to D(a) \} $，存在唯一态射$f : C^0 \to C $，使得$p \circ f = p^0 $。
   - 这意味着$C$是唯一（唯一 up to unique isomorphism）的对象，通过$p$能够唯一地接收所有满足条件的态射族。

**总结**：

极限通过满足上述条件，提供了一种“最佳匹配”的方式，将图式$D$中的所有对象和箭头综合到一个单一对象$C$中。

### 9.2.5 例子（Examples）

**例子1：有限离散图式中的积（Products in Finite Discrete Diagrams）**

当图式$D$是一个有限离散图式时，即图式中没有非身份箭头，那么极限$C$就是这些对象的**积**。

**解释**：

- **积的定义**：给定一族对象$\{ A_i \}_{i \in I}$在范畴$\mathcal{C}$中，其积$\prod_{i \in I} A_i$是一个对象$C$以及一族投影态射$\pi_i : C \to A_i $，满足对于任何对象$D$及一族态射$f_i : D \to A_i $，存在唯一态射$f : D \to C$使得$\pi_i \circ f = f_i$对所有$i \in I$成立。

- **关联**：当图式$D$是一个离散图式时，极限$C$满足积的定义。因此，积是离散图式的一个极限。

**例子2：等化子（Equalizers）**

等化子也是一种极限。设$f, g : A \to B$是一对平行态射，其等化子$j : E \hookrightarrow A$满足$f \circ j = g \circ j $，并且对任何满足$f \circ h = g \circ h$的态射$h : C \to A $，存在唯一态射$k : C \to E$使得$j \circ k = h $。

**例子3：拉回（Pullbacks）**

拉回是处理两个具有共同目标的态射的极限。设$f : X \to Z$和$g : Y \to Z$是两个态射，拉回$P$及其态射$p_1 : P \to X$和$p_2 : P \to Y$满足$f \circ p_1 = g \circ p_2 $，并且对任何满足此条件的态射族，存在唯一态射因子化。

**总结**：

通过这些例子，我们看到极限不仅仅是积和等化子的统一概念，还包括了其他许多重要的范畴结构，如拉回。这些极限的具体实例展示了极限在不同范畴中的多样性和广泛应用。

### 9.2.6 极限的等价定义（Equivalent Definitions of Limits）

**定义1：极限作为终对象（Terminal Object in Cone Category）**

给定一个图式$D : G \to \mathcal{C} $，定义一个新的范畴$\text{Cone}(D) $，其中：

- **对象**：$ \text{Cone}(D)$的对象是所有的**公锥（Commutative Cones）**$\{ p_a : C \to D(a) \} $。
- **态射**：两个锥子$\{ p_a : C \to D(a) \}$和$\{ q_a : C' \to D(a) \}$之间的态射是$f : C \to C'$满足$p_a = q_a \circ f$对所有$a$成立。

在这个范畴中，**极限** 就是一个**终对象（Terminal Object）**。即，极限锥子是这样的一个锥子，任何其他锥子都有唯一态射因子化到它。

**定义2：极限作为普遍元素（Universal Element of Functor）**

给定一个图式$D : G \to \mathcal{C} $，定义一个函子$\text{Cone}(-, D) : \mathcal{C}^{op} \to \text{Set} $，其中：

- **对象映射**：对任意对象$C $，$ \text{Cone}(C, D)$是所有的**公锥**$\{ p_a : C \to D(a) \}$的集合。
- **态射映射**：对任意态射$f : C' \to C $，$ \text{Cone}(f, D)$将公锥$\{ p_a : C \to D(a) \}$映射为$\{ p_a \circ f : C' \to D(a) \} $。

**普遍元素**：

一个**普遍元素**$p \in \text{Cone}(C, D)$满足，对于任意对象$C'$及其元素$p' \in \text{Cone}(C', D) $，存在唯一态射$f : C' \to C$使得$p \circ f = p' $。

**关联**：

这个普遍元素$p$就是一个**极限锥子**。因此，极限的存在等价于函子$\text{Cone}(-, D)$有一个普遍元素。

**总结**：

通过这两种等价的定义，我们可以从不同的角度理解极限：作为锥子的终对象，或作为函子中的普遍元素。这些等价定义为极限的存在性和唯一性提供了不同的理论基础和证明方法。

### 9.2.7 定理（Theorem）

**定理**：

对于范畴$\mathcal{C}$中的一个图式$D $，以下三者是等价的：

1.$D$的一个极限。
2.$\text{Cone}(D)$的一个终对象。
3.$\text{Cone}(-, D)$函子中的一个普遍元素。

**证明**：

- **(i) ⇔ (ii)**：根据定义，极限是$\text{Cone}(D)$的终对象。
- **(ii) ⇔ (iii)**：终对象与函子中的普遍元素是等价的概念。

**总结**：

这个定理确认了极限的不同等价定义之间的关系，强调了极限在范畴论中作为普遍结构的核心地位。

### 9.2.8 定理（Theorem）

**定理**：

设$D$是一个图式，且$p : C \to D$和$p' : C' \to D$都是$D$的极限，那么存在一个唯一的同构态射$i : C \to C' $，使得：

$$
p' \circ i = p
$$

**证明**：

1. **设定**：
   
  $p : C \to D$和$p' : C' \to D$都是$D$的极限锥子。

2. **构造态射$i $**：

   由于$p'$是极限锥子，对于极限锥子$p $，存在唯一态射$i : C \to C'$使得：

  $$
   p' \circ i = p
  $$

3. **构造态射$i' $**：

   同理，存在唯一态射$i' : C' \to C$使得：

  $$
   p \circ i' = p'
  $$

4. **证明$i$和$i'$是逆同构**：

   - 考虑$p' \circ (i \circ i') = p \circ i' = p' $。
   - 因为$i \circ i'$满足$p' \circ (i \circ i') = p' $，而$p'$是终对象，所以$i \circ i' = \text{id}_{C'} $。
   
   - 同样地，考虑$p \circ (i' \circ i) = p' \circ i = p $。
   - 因为$p$是终对象，所以$i' \circ i = \text{id}_C $。

5. **结论**：

  $i$和$i'$是$C$和$C'$之间的逆同构，因此$C \cong C' $。

**总结**：

任何两个极限锥子在范畴中是唯一同构的，这保证了极限在范畴中的唯一性（up to unique isomorphism）。

### 9.2.9 定义（Definition）

**定义**：

- **完全范畴（Complete Category）**：如果一个范畴$\mathcal{C}$中的每一个图式都有极限，则称$\mathcal{C}$是**完全的**（complete）。
  
- **有限完全范畴（Finitely Complete Category）**：如果一个范畴$\mathcal{C}$中的每一个有限图式（即其图的节点和箭头数都是有限的）都有极限，则称$\mathcal{C}$是**有限完全的**（finitely complete）。

**总结**：

这些定义帮助我们理解范畴中极限存在性的广泛程度，特别是对有限图式和一般图式的极限的存在性。

### 9.2.10 定理（Theorem）

**定理**：

设$\mathcal{C}$是一个范畴，满足以下条件：

1. **积的存在性**：任意集合（或有限集合）的对象对有积。
2. **等化子的存在性**：任意一对平行态射有等化子。

那么，$ \mathcal{C}$中的任意图式（或任意有限图式）都有极限。

**证明概述**：

证明过程通过数学归纳法，利用积和等化子的存在性，逐步构造复杂图式的极限。具体证明细节留给练习题3。

**结论**：

这个定理提供了一个实用的判定标准，说明如果一个范畴中积和等化子都存在，那么该范畴中所有（或所有有限）图式的极限也存在。这极大地简化了验证范畴是否具有极限结构的过程。

### 9.2.11 推论（Corollary）

**推论**：

设$\mathcal{C}$是一个范畴，满足以下条件：

1. **终对象的存在性**：$ \mathcal{C}$有一个终对象。
2. **积的存在性**：任意两个对象有积。
3. **等化子的存在性**：任意一对平行态射有等化子。

则，$ \mathcal{C}$是**有限完全的**，即任意有限图式都有极限。

**证明**：

根据定理9.2.10，如果$\mathcal{C}$中每对对象有积，并且每对平行态射有等化子，则$\mathcal{C}$中的所有有限图式都有极限。由于终对象是空积的一个特例，因此推论成立。

**总结**：

这个推论为我们提供了一个具体的条件集，用于判断一个范畴是否是有限完全的。通过检查终对象、积和等化子的存在性，可以快速确定范畴中有限图式的极限存在性。

### 9.2.12 定义（Definition）

**定义**：

- **保留极限的函子（Functors that Preserve Limits）**：设$F : \mathcal{C} \to \mathcal{D}$是一个函子。如果对于任何图式$D : G \to \mathcal{C} $，$ F$将$D$的极限锥子映射为$F(D)$的极限锥子，则称$F$**保留极限**。

- **保留有限极限的函子（Functors that Preserve Finite Limits）**：如果$F$保留所有有限图式的极限，则称$F$**保留有限极限**。

**总结**：

这些定义说明了函子如何在不同范畴间传递极限结构，确保极限的形状和普遍性在映射后仍然保持不变。

**补充结论**：

根据推论9.2.11，若一个函子$F : \mathcal{C} \to \mathcal{D}$保留终对象、积和等化子，则$F$保留所有有限极限。

### 9.2.13 练习题（Exercises）

**练习1**：

**题目**：

证明图式（9.1）是一个极限锥子，当且仅当$e$是$f$和$g$的等化子。

**图式（9.1）**：

$$
\begin{array}{ccc}
& & E \\
& \swarrow^{e} & \downarrow^{u} \\
A & \rightrightarrows^{f}_{g} & B \\
\end{array}
$$

其中，$ u = f \circ e = g \circ e $。

**解析**：

**目标**：

证明$e : E \hookrightarrow A$是$f$和$g$的等化子，当且仅当图式（9.1）是一个极限锥子。

**证明步骤**：

1. **必要性（$ e$是等化子 ⇒ 图式是极限锥子）**：

   - **等化子条件**：
     -$f \circ e = g \circ e $
     - 对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一$k : C \to E$使得$e \circ k = h $
   
   - **极限锥子条件**：
     -$e$是极限锥子的组成态射，即满足$f \circ e = g \circ e $
     - 对于任何满足$f \circ h = g \circ h$的锥子$h $，存在唯一态射$k : C \to E$使得$e \circ k = h $
   
   - **结论**：
     - 等化子的定义正好满足极限锥子的条件，因此$e$是极限锥子。

2. **充分性（图式是极限锥子 ⇒$e$是等化子）**：

   - **极限锥子条件**：
     -$f \circ e = g \circ e $
     - 对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一$k : C \to E$使得$e \circ k = h $
   
   - **等化子条件**：
     -$f \circ e = g \circ e $
     - 对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一$k : C \to E$使得$e \circ k = h $
   
   - **结论**：
     - 极限锥子的定义正好符合等化子的定义，因此$e$是等化子。

**结论**：

图式（9.1）是极限锥子，当且仅当$e$是$f$和$g$的等化子。

**练习2**：

**题目**：

设$f : S \to T$是一个集合函数。构造$\text{Set}$中以下图式的极限。在 (c) 中，箭头是指向终对象的唯一函数。

**图式**：

a.
$$
S \to T \\
f \quad f
$$

b.
$$
S \times 1 \rightrightarrows S
$$

c.
$$
S \times 1 \to S \\
\downarrow & \\
1 \to
$$

**解析**：

**a. 构造积的等化子**

图式描述的是两个平行态射$f, f : S \to T $。

- **等化子**：所有$s \in S$满足$f(s) = f(s) $，即$S$本身。
- **包含映射**：恒等映射$\text{id}_S : S \to S $。

- **极限**：$ S$和$\text{id}_S $，即$S$自身。

**结论**：极限是$S$自身，态射是恒等映射。

**b. 拉回的构造**

图式描述的是$S \times 1 \rightrightarrows S $，其中两个箭头分别是$\text{proj}_1$和恒等映射。

- **解释**：
  -$S \times 1$是$S$的积。
  - 两个箭头：$ \text{proj}_1 : S \times 1 \to S$和$f \circ \text{proj}_2 : S \times 1 \to S $，其中$\text{proj}_2$是投影到$1$的映射，$ f \circ \text{proj}_2$是常数函数。

- **等化子**：满足$\text{proj}_1 = f \circ \text{proj}_2$的所有元素$(s, 1) \in S \times 1 $。

- **具体构造**：$ \text{Eq}(\text{proj}_1, f \circ \text{proj}_2)$是$S$中所有满足$s = f(1)$的$s \in S$的子集。

- **极限**：单元素集$\{ f(1) \} $，包含映射。

**结论**：极限是$\{ f(1) \} $，包含映射$j : \{ f(1) \} \hookrightarrow S $。

**c. 与终对象相关的构造**

图式描述的是$S \times 1 \to S$及其到终对象的唯一函数。

- **解释**：
  -$S \times 1 \to S$是投影映射$\text{proj}_1 $。
  - 终对象是一个单元素集$1 $，所有函数都指向该元素。

- **等化子**：满足$\text{proj}_1 = \text{唯一函数} $。

- **具体构造**：唯一函数将$S \times 1$的每个元素映射到终对象的唯一元素。

- **极限**：终对象$1 $，包含映射$\text{proj}_1$是$\text{proj}_1 : 1 \to S $。

**结论**：极限是终对象$1 $，包含映射为终态射。

**总结**：

通过这些练习，我们巩固了积、等化子和终对象在范畴$\text{Set}$中的具体极限构造方法。

**练习3**：

**题目**：

在这个练习中，范畴$\mathcal{C}$满足以下条件：

- 每个对象集（或有限对象集）有积。
- 每对平行态射有等化子。

目的是证明定理9.2.10。

**a. 特殊图式的等化子**

**题目**：

设$I$是一个图，可能有任意集合的节点，但只有一个非身份箭头$a : j \to k $。证明对于任何图式$D : I \to \mathcal{C} $，等化子$E \hookrightarrow Y$的构造是$D$的极限。

**解析**：

1. **图式描述**：
   
   - 节点：$ j, k $。
   - 箭头：唯一的非身份箭头$a : j \to k $。

2. **极限构造**：

   - **积**：先构造$Y = \prod_{i \in I} D(i) $，即$D(j) \times D(k) $。
   - **等化子**：构造$E$为满足$D(a) \circ p_j = p_k$的子对象。
   
   - **具体映射**：
     -$p_j : Y \to D(j)$和$p_k : Y \to D(k)$是投影映射。
     - 等化子$E$满足$D(a) \circ p_j = p_k $，即$D(a)(x_j) = x_k $。

3. **验证极限条件**：

   - **平行性条件**：显然满足$D(a) \circ p_j = p_k $。
   - **普遍性条件**：对于任何满足条件的态射族$\{ p^0_j, p^0_k \} $，存在唯一态射因子化到$E $。

**结论**：

因此，等化子$E \hookrightarrow Y$是$D$的极限。

**b. 两个非身份箭头的图式**

**题目**：

设$I$有两个非身份箭头$a : j \to k$和$b : l \to m $（不假设箭头的独立性）。设$r = [D(a) \circ \text{proj}_j, D(b) \circ \text{proj}_l] : Y \to D(k) \times D(m)$和$s = [\text{proj}_k, \text{proj}_m] : Y \to D(k) \times D(m) $。证明如果$E \hookrightarrow Y$是$r$和$s$的等化子，则$E$是$D$的极限。

**解析**：

1. **图式描述**：
   
   - 节点：$ j, k, l, m $。
   - 箭头：$ a : j \to k $，$ b : l \to m $。

2. **极限构造**：

   - **积**：构造$Y = D(j) \times D(l) $。
   - **等化子**：构造$E$满足$D(a) \circ \text{proj}_j = \text{proj}_k$和$D(b) \circ \text{proj}_l = \text{proj}_m $。

3. **验证极限条件**：

   - **平行性条件**：满足$r \circ j = s \circ j $。
   - **普遍性条件**：任何满足条件的态射族可以唯一地因子化到$E $。

**结论**：

因此，等化子$E \hookrightarrow Y$是$D$的极限。

**c. 任意图式的极限构造**

**题目**：

设$I$是任意图，$ D : I \to \mathcal{C}$是一个图式。设$A = \prod_{i \in I} D(i)$和$B = \prod_{\text{arrows } a \in I} D(\text{target}(a)) $。定义态射$r : A \to B$满足$\text{proj}_a \circ r = D(a) \circ \text{proj}_{\text{source}(a)}$和$s : A \to B$满足$\text{proj}_a \circ s = \text{proj}_{\text{target}(a)} $。设$E \hookrightarrow A$是$r$和$s$的等化子，证明$E$是$D$的极限。

**解析**：

1. **图式描述**：
   
   - 节点：$ I$中的所有节点。
   - 箭头：$ I$中的所有箭头$a : j \to k $。

2. **极限构造**：

   - **积**：$ A = \prod_{i \in I} D(i)$是所有$D(i)$的积。
   - **等化子**：$ E$满足所有箭头$a : j \to k$的条件$D(a) \circ \text{proj}_j = \text{proj}_k $。

3. **验证极限条件**：

   - **平行性条件**：对于每个箭头$a $，满足$D(a) \circ \text{proj}_j = \text{proj}_k $。
   - **普遍性条件**：任何满足相同条件的态射族都唯一地因子化到$E $。

**结论**：

因此，等化子$E \hookrightarrow A$是图式$D$的极限。

**总结**：

通过这些练习题，我们深入理解了积和等化子如何结合构造任意图式的极限。这展示了极限的构造方法如何依赖于范畴中积和等化子的存在性。

## 本节总结

**极限（Limits）** 是范畴论中一个核心概念，提供了一种统一的方式来综合和协调一个图式中的所有对象和态射。通过具体的定义、等价定义以及丰富的例子和练习，我们对极限的理解更加深入。

**主要要点**：

1. **锥子（Cone）**：
   - 一个锥子是一个对象以及一族满足兼容条件的态射。
   - 锥子的普遍性决定了它是否为极限。

2. **极限的定义**：
   - 极限是一个普遍锥子，满足普遍性条件。
   - 极限可以通过终对象的方式定义，也可以通过普遍元素的方式定义。

3. **等化子（Equalizers）**：
   - 等化子是极限的一种特殊形式，专门处理两对平行态射的相等条件。
   - 等化子的唯一性和单态性是其重要性质。

4. **极限的等价定义**：
   - 极限作为终对象在锥子范畴中。
   - 极限作为普遍元素在函子范畴中。

5. **极限的构造条件**：
   - 如果一个范畴中有所有积和等化子，那么它拥有所有有限图式的极限。
   - 推论说明了终对象、积和等化子的存在性如何确保有限极限的存在。

6. **保留极限的函子**：
   - 保留极限的函子在保持图式结构和极限普遍性方面起着关键作用。
   - 通过保留终对象、积和等化子，可以确保函子保留所有有限极限。

**应用与扩展**：

- **编程语言语义**：极限用于描述和分析复杂数据结构和类型系统，确保它们满足特定的条件和性质。
- **自动机理论**：通过极限构造，可以描述有限状态机的行为和状态转移。
- **逻辑编程**：合一操作可以被视为余等化子的特例，用于模式匹配和规则推理。
- **代数结构研究**：极限帮助理解和构造复杂代数对象，如环、模、范畴等的限制和扩展。

通过掌握极限的一般概念及其构造方法，读者能够在范畴论的框架下更深入地理解和应用极限与余极限的基本原理，为后续章节中更复杂的图式和范畴结构分析打下坚实的理论基础。

### ---------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.3节：拉回（Pullbacks）**。本节将深入探讨拉回的定义、性质、具体例子以及相关的命题和练习题。拉回作为一种重要的有限极限，在范畴论中具有广泛的应用，尤其在描述对象间的“纤维积”关系时尤为关键。

## 9.3 拉回（Pullbacks）

### 引言

拉回是有限极限中的一种重要类型，广泛应用于各种范畴中，如集合范畴（Set）、群范畴（Grp）、拓扑范畴（Top）等。它能够描述两个态射在共同目标下的“最紧密”结合，类似于集合论中的纤维积。

### 9.3.1 例子（Example）

**例子1：集合范畴中的拉回**

设$f : S \to T$和$g : U \to T$是集合范畴$\text{Set}$中的两个函数，则它们的拉回$P$及其态射$p_1 : P \to S$和$p_2 : P \to U$可以通过以下方式构造：

$$
P = \{ (s, u) \in S \times U \mid f(s) = g(u) \}
$$

态射定义为：

$$
p_1(s, u) = s \quad \text{和} \quad p_2(s, u) = u
$$

这样构造的$P$是$S \times U$的一个子集，满足$f(s) = g(u) $。拉回图式如下：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & S \\
\downarrow{p_2} & & \downarrow{f} \\
U & \xrightarrow{g} & T \\
\end{array}
$$

**性质**：

-$P$是$S \times U$的子集。
-$p_1$和$p_2$是投影映射。
- 该图式满足拉回的定义条件。

**例子2：函数的逆像作为拉回**

考虑一个函数$g : S \to T$和集合$A \subseteq T $，定义包含映射$i : A \hookrightarrow T$和逆像$g^{-1}(A) = \{ x \in S \mid g(x) \in A \} $，包含映射$j : g^{-1}(A) \hookrightarrow S$以及限制映射$h : g^{-1}(A) \to A $（即$h(x) = g(x) $）。则拉回图式为：

$$
\begin{array}{ccc}
g^{-1}(A) & \xrightarrow{j} & S \\
\downarrow{h} & & \downarrow{g} \\
A & \xrightarrow{i} & T \\
\end{array}
$$

这个图式也是一个拉回，因为：

$$
g \circ j = i \circ h
$$

**解释**：

- 拉回在这里表示$g^{-1}(A)$是满足$g(x) \in A$的元素集合。
- 这展示了拉回如何用于描述逆像的结构。

**术语解释**：

- **纤维积（Fiber Product）**：拉回的另一种称呼，强调了在共同目标下的“纤维”结构。
- **包含映射（Inclusion Map）**：将子集自然嵌入到其母集中的映射。

**备注**：

尽管例子1和例子2都展示了拉回的构造，但它们的具体构造方法不同，例子2中的逆像不是例子1中拉回的特殊情况。

### 9.3.2 定理（Theorem）

**定理9.3.3**：

对于任何一个箭头$f : A \to B$在范畴$\mathcal{C}$中，以下三个条件是等价的：

1. **(a)$f$是单态（Monic）**。
2. **(b) 图式**
   
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \end{array}
  $$
   
   是一个极限锥子。
3. **(c) 存在一个对象$P$和一个箭头$g : P \to A $，使得图式**
   
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   
   是一个极限锥子。
   

**解释**：

- **单态**：一个箭头$f$在范畴中是单态的，当且仅当对于任何对象$C$和箭头$h_1, h_2 : C \to A $，若$f \circ h_1 = f \circ h_2 $，则$h_1 = h_2 $。
- **极限锥子**：图式中的$P$和箭头$p_1, p_2$构成的图式满足拉回的条件。

**证明**（略，见练习题2）

### 9.3.3 命题（Proposition）

**命题9.3.4**：

在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**解释**：

- 这意味着，拉回中的一个箭头保留了单态的性质。
- 具体来说，如果$f$在拉回图式中是单态的，那么从拉回对象$P$到$B$的箭头$p_2 : P \to B$也必须是单态的。

**结论**：

- “拉回的单态保持单态”。
- 这为理解拉回如何影响态射的性质提供了有力的工具。

**证明**（略，见练习题3）

### 9.3.4 练习题（Exercises）

**练习1**：

**题目**：

证明图式（9.4）是一个拉回图式。

**图式（9.4）**：

$$
\begin{array}{ccc}
S & \xrightarrow{f} & T \\
g \downarrow & & \downarrow{i} \\
g^{-1}(A) & \xrightarrow{j} & A \\
\end{array}
$$

其中，$ g^{-1}(A) = \{ x \in S \mid g(x) \in A \} $，$ j$是包含映射，$ h$是$g$在$g^{-1}(A)$上的限制映射。

**解析**：

**目标**：

证明图式（9.4）是一个拉回图式，即$g^{-1}(A)$及其态射满足拉回的定义条件。

**证明步骤**：

1. **构造拉回对象**：

  $P = g^{-1}(A) $，满足$f \circ j = i \circ h $。

2. **验证拉回条件**：

   - **平行性条件**：$f \circ j = i \circ h $。
   - **普遍性条件**：对于任何对象$C$及其态射$k : C \to S $，若$i \circ l = f \circ k $，则存在唯一的态射$m : C \to P$使得$j \circ m = k $。

3. **结论**：

   因此，图式（9.4）满足拉回的定义条件，故其是一个拉回图式。

**练习2**：

**题目**：

证明定理9.3.3。

**定理9.3.3重述**：

对于任何一个箭头$f : A \to B$在范畴$\mathcal{C}$中，$ f$是单态，当且仅当图式

$$
\begin{array}{ccc}
A & \rightrightarrows^{f}_{f} & B \\
\end{array}
$$

是一个极限锥子。

**证明**：

**必要性（$ f$是单态 ⇒ 图式是极限锥子）**：

1. **假设**：

  $f$是单态的。

2. **构造拉回**：

   构造图式：

  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \end{array}
  $$

3. **验证极限条件**：

   - **平行性条件**：显然$f \circ \text{id}_A = f \circ \text{id}_A $。
   - **普遍性条件**：对于任何图式$D : G \to \mathcal{C}$满足图式中的条件，存在唯一的态射因子化。

4. **结论**：

   因此，图式是一个极限锥子。

**充分性（图式是极限锥子 ⇒$f$是单态）**：

1. **假设**：

   图式是极限锥子。

2. **验证单态性**：

   对于任意两个态射$h_1, h_2 : C \to A $，若$f \circ h_1 = f \circ h_2 $，则存在唯一的态射$k : C \to A$使得$\text{id}_A \circ k = h_i $。

   - 因为图式是极限锥子，且$f \circ h_1 = f \circ h_2 $，根据普遍性条件，存在唯一的$k$使得$h_1 = h_2 $。

3. **结论**：

   因此，$ f$是单态的。

**总结**：

$ f$是单态的当且仅当图式$A \rightrightarrows^{f}_{f} B$是一个极限锥子。

**练习3**：

**题目**：

证明命题9.3.4。

**命题9.3.4重述**：

在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

其中，$ f \circ p_1 = g \circ p_2 $。

**证明**：

**目标**：

证明如果$f$是单态的，那么$p_2 : P \to B$也是单态的。

**证明步骤**：

1. **假设**：

  $f$是单态的。

2. **验证$p_2$是单态的**：

   - 设有两个态射$h_1, h_2 : Q \to P $，满足$p_2 \circ h_1 = p_2 \circ h_2 $。
   
   - 需要证明$h_1 = h_2 $。
   
3. **利用平行性条件**：

   - 由于$f \circ p_1 = g \circ p_2 $，有：
   
    $$
     f \circ p_1 \circ h_1 = g \circ p_2 \circ h_1 = g \circ p_2 \circ h_2 = f \circ p_1 \circ h_2
    $$
   
   - 因为$f$是单态的，得：
   
    $$
     p_1 \circ h_1 = p_1 \circ h_2
    $$
   
4. **结合$p_2$的假设**：

   - 现在有：
   
    $$
     p_1 \circ h_1 = p_1 \circ h_2 \quad \text{和} \quad p_2 \circ h_1 = p_2 \circ h_2
    $$
   
5. **利用拉回的普遍性**：

   - 由于$P$是拉回对象，满足$f \circ p_1 = g \circ p_2 $，因此存在唯一的态射$k : Q \to P$使得$p_1 \circ k = p_1 \circ h_i$和$p_2 \circ k = p_2 \circ h_i $。
   
   - 由于$p_1 \circ h_1 = p_1 \circ h_2$和$p_2 \circ h_1 = p_2 \circ h_2 $，根据普遍性条件，得$h_1 = h_2 $。
   
6. **结论**：

   因此，$ p_2$是单态的。

**总结**：

拉回中的一个箭头$p_2$保持了原箭头$f$的单态性。

### 9.3.5 弱最小前置条件作为拉回（Weakest Precondition as Pullback）

**引言**：

在程序验证中，常常需要为程序片段附加前置条件和后置条件。一个广泛使用的方法是确定每个后置条件的“最弱前置条件”（weakest precondition），即在保证程序片段执行后满足后置条件所需的最小条件。

**例子**：

考虑以下程序片段：

```
1. {X < 3}         // 前置条件
2. X := X + 1;     // 程序片段
3. {X < 24}        // 后置条件
```

- **前置条件**：在执行程序片段之前，变量$X$满足$X < 3 $。
- **后置条件**：在执行程序片段之后，变量$X$满足$X < 24 $。

**最弱前置条件**：

对于给定的后置条件$\{X < 24\} $，最弱前置条件是$\{X < 23\} $，因为在$X < 23$的情况下，执行$X := X + 1$后，必然有$X < 24 $。

**范畴论解释**：

将这个过程放入范畴论的框架中，可以通过拉回来描述最弱前置条件。

1. **定义**：

   -$D$是输入集合，$ E$是输出集合。
   - 程序片段被视为一个态射$f : D \to E $。

2. **条件与子对象**：

   - 任何条件$C$在集合$X$上可以被视为其子集$X_0 = \{ x \in X \mid x \text{ 满足 } C \} $。
   - 后置条件$S \subseteq E $。

3. **最弱前置条件**：

   - 最弱前置条件是$f^{-1}(S) = \{ x \in D \mid f(x) \in S \} $。
   - 这是$D$的一个子对象，通过包含映射$j : f^{-1}(S) \hookrightarrow D $。
   - 拉回图式为：

    $$
     \begin{array}{ccc}
     f^{-1}(S) & \xrightarrow{j} & D \\
     \downarrow{h} & & \downarrow{f} \\
     S & \xrightarrow{i} & E \\
     \end{array}
    $$

     其中，$ h$是$f$在$f^{-1}(S)$上的限制映射。

**实例**：

- 对于程序片段$X := X + 1 $，后置条件$S = \{ X \mid X < 24 \} $，最弱前置条件是$f^{-1}(S) = \{ X \mid X + 1 < 24 \} = \{ X \mid X < 23 \} $。

**总结**：

通过将最弱前置条件视为拉回，可以利用范畴论的工具来形式化和分析程序验证中的条件推导过程。这为程序语义的形式化提供了强有力的理论支持。

### 9.3.6 重新审视构造所有有限极限（Constructing All Finite Limits Revisited）

**引言**：

推论9.2.11描述了一类极限的存在性如何保证所有有限极限的存在。类似的构造方法也适用于拉回。

**命题9.3.7**：

**命题**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**解释**：

- **终对象**：一个终对象是没有任何非平凡态射指向它的对象。
- **拉回**：如前所述，是处理两个具有共同目标的态射的极限。

**证明**（略，见练习题6）

**结论**：

具有终对象和所有拉回的范畴必然具有所有有限极限。这为构造复杂图式的极限提供了基础条件。

### 9.3.7 练习题（Exercises）

**练习4**：

**题目**：

证明如果图式（9.3）是在任何具有积的范畴中一个拉回，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**图式（9.3）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & S \\
\downarrow{p_2} & & \downarrow{f} \\
U & \xrightarrow{g} & T \\
\end{array}
$$

**解析**：

**目标**：

证明在任何具有积的范畴中，如果图式（9.3）是一个拉回图式，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**证明步骤**：

1. **构造积**：

   - 在范畴$\mathcal{C}$中，$ S \times U$是$S$和$U$的积。
   - 态射$\langle p_1, p_2 \rangle$是从拉回对象$P$到积对象$S \times U$的箭头。

2. **验证单态性**：

   - 假设有两个态射$h_1, h_2 : Q \to P $，满足$\langle p_1, p_2 \rangle \circ h_1 = \langle p_1, p_2 \rangle \circ h_2 $。
   - 这意味着：

    $$
     p_1 \circ h_1 = p_1 \circ h_2 \quad \text{和} \quad p_2 \circ h_1 = p_2 \circ h_2
    $$

3. **利用拉回的普遍性条件**：

   - 由于$P$是拉回对象，满足$f \circ p_1 = g \circ p_2 $，对于满足上述条件的态射$h_1$和$h_2 $，根据普遍性条件，存在唯一的态射因子化到$P $。
   
   - 由于$p_1 \circ h_1 = p_1 \circ h_2$和$p_2 \circ h_1 = p_2 \circ h_2 $，得$h_1 = h_2 $。

4. **结论**：

   因此，态射$\langle p_1, p_2 \rangle$是单态的。

**总结**：

拉回中的态射到积对象的自然箭头是单态的，这反映了拉回对象在积对象中的“唯一性”特性。

**练习5**：

**题目**：

证明等化子可以通过积和拉回来构造。（提示：先在集合范畴中操作，然后推广到一般范畴。）

**解析**：

**目标**：

证明在一个具有积和拉回的范畴中，等化子可以通过积和拉回来构造。

**证明步骤**：

1. **设定**：

   - 给定一对平行态射$f, g : A \to B $。
   
2. **构造积**：

   - 构造积$A \times A$及其投影态射$\pi_1, \pi_2 : A \times A \to A $。
   
3. **构造拉回**：

   - 构造拉回对象$P$及其态射$p_1, p_2 : P \to A $，使得：
   
    $$
     f \circ p_1 = g \circ p_2
    $$
   
4. **定义等化子**：

   - 定义等化子$E$及其包含态射$j : E \hookrightarrow A$使得：
   
    $$
     f \circ j = g \circ j
    $$
   
5. **验证普遍性条件**：

   - 对于任何满足$f \circ h = g \circ h$的态射$h : C \to A $，存在唯一态射$k : C \to E$使得$j \circ k = h $。
   
6. **结论**：

   因此，等化子可以通过积和拉回来构造。

**总结**：

通过利用积和拉回，可以在具有这些结构的范畴中构造等化子。这展示了极限构造中的模块化和组合性。

**练习6**：

**题目**：

证明命题9.3.7。

**命题9.3.7重述**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明**（概要）：

1. **利用终对象和拉回构造有限极限**：
   
   - 通过逐步构造，利用终对象作为初始条件，再通过拉回来逐步构造更复杂的有限图式的极限。
   
2. **数学归纳法**：

   - 基础情况：终对象和二元积（通过拉回）满足有限极限的基础条件。
   
   - 归纳步骤：假设对于有限图式$G$的极限已构造完毕，添加一个箭头或节点后，利用拉回来继续构造新的极限。
   
3. **结论**：

   因此，具有终对象和所有拉回的范畴必然具有所有有限极限。

**总结**：

具有终对象和所有拉回的范畴能够通过组合这些结构来构造所有有限极限，这为理解范畴的极限结构提供了重要的构造方法。

### 9.3.8 练习题（Exercises）

**练习6**：

**题目**：

证明命题9.3.7。

**命题9.3.7重述**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明**：

**目标**：

证明如果一个范畴$\mathcal{C}$具有终对象和所有拉回，那么$\mathcal{C}$具有所有有限极限。

**证明步骤**：

1. **基础情况**：

   - **终对象**：有限极限中的空积（0-极限）即为终对象。
   
   - **二元积和拉回**：通过拉回来构造二元积。
   
2. **数学归纳法**：

   - **假设**：假设对于任何包含$n$个箭头的有限图式，其极限存在。
   
   - **归纳步骤**：对于包含$n + 1$个箭头的有限图式，通过将其拆分为一个包含$n$个箭头的子图式和一个新箭头，利用拉回来构造新的极限。
   
3. **构造方法**：

   - 使用拉回来“合并”新的箭头与已构造的极限。
   
4. **普遍性条件**：

   - 通过拉回的普遍性条件，确保新构造的极限满足所有条件。
   
5. **结论**：

   因此，通过数学归纳法，所有有限图式的极限在范畴$\mathcal{C}$中都存在。

**总结**：

通过使用终对象和拉回，能够系统地构造任何有限图式的极限，证明了命题9.3.7的正确性。

**练习7**：

**题目**：

证明在集合范畴$\text{Set}$中，如果图式（9.2）中的箭头$f$是上同态（Epimorphism），那么$p_2$也是上同态。

**解析**：

**目标**：

证明在$\text{Set}$范畴中，如果$f : A \to B$是上同态（即满射），那么拉回图式中的$p_2 : P \to A$也是上同态的。

**证明步骤**：

1. **设定**：

   -$f : A \to B$是满射。
   - 构造拉回对象$P = \{ (a, c) \in A \times C \mid f(a) = g(c) \} $。
   -$p_2 : P \to C$是投影映射。

2. **验证$p_2$是满射**：

   - 对于任意$c \in C $，因为$f$是满射，存在$a \in A$使得$f(a) = g(c) $。
   
   - 因此，$ (a, c) \in P $，且$p_2(a, c) = c $。
   
   - 这表明对于任意$c \in C $，存在$p \in P$使得$p_2(p) = c $。
   
3. **结论**：

   因此，$ p_2$是满射，即上同态。

**总结**：

在集合范畴中，拉回图式中的投影态射$p_2$保持了原箭头$f$的上同态性。

**练习8**：

**题目**：

给出一个范畴，其中存在一个上同态，其拉回沿至少一个箭头不是上同态的。

**解析**：

**目标**：

构造一个范畴，其中存在一个上同态$f $，使得沿某个箭头的拉回不是上同态。

**构造方法**：

1. **选择范畴**：

   - 考虑类别$\text{Cat} $（小类别的范畴）。

2. **定义箭头**：

   - 设$A$和$B$是两个对象，定义一个箭头$f : A \to B $，使其是一个上同态（即在$\text{Cat}$中的函子是上同态）。
   
   - 选择一个特定的函子$f $，例如一个满函子但不是自然同构的函子。

3. **构造拉回**：

   - 选择一个箭头$g : C \to B $，并构造拉回$P $。
   
   - 验证$p_2 : P \to C$是否是上同态。

4. **验证非上同态**：

   - 通过具体例子，证明$p_2$不是满射。

**具体例子**：

- 选择$\mathcal{C} = \text{Cat} $，定义$f : \mathbf{1} \to \mathbf{2} $，其中$\mathbf{1}$是单对象单态射类别，$ \mathbf{2}$是两个对象一个箭头的类别。
  
- 选择$g : \mathbf{1} \to \mathbf{2}$为另一个箭头，构造拉回。
  
- 验证$p_2$不是上同态。

**结论**：

通过构造特定的范畴和箭头，可以得到拉回中的态射不保持上同态性的例子。

**总结**：

此练习展示了在某些范畴中，拉回不一定保持上同态性的性质，强调了拉回行为在不同范畴中的多样性。

**练习9**：

**题目**：

证明在任何范畴中，拉回一个分裂上同态（split epimorphism）仍然是一个分裂上同态。

**解析**：

**目标**：

证明如果$f : A \to B$是一个分裂上同态（即存在$g : B \to A$使得$f \circ g = \text{id}_B $），那么拉回图式中的$p_2 : P \to C$也是分裂上同态。

**证明步骤**：

1. **设定**：

   -$f : A \to B$是分裂上同态，存在$g : B \to A $，满足$f \circ g = \text{id}_B $。
   
   - 构造拉回$P$及其态射$p_1 : P \to A$和$p_2 : P \to C $，满足$f \circ p_1 = g \circ p_2 $。

2. **构造右逆**：

   - 构造一个态射$h : C \to P $，使得$p_2 \circ h = \text{id}_C $。
   
   - 设$h(c) = (g(g(c)), c) $，其中$g(c)$是$B$中的元素（因为$p_2(h(c)) = c $）。
   
3. **验证**：

   - 计算$p_2 \circ h = \text{id}_C $。
   
   - 计算$p_1 \circ h = g(g(c)) = g \circ \text{id}_B (c) = g(c) $。

4. **结论**：

   因此，$ p_2$具有右逆$h $，即$p_2 \circ h = \text{id}_C $，故$p_2$是分裂上同态。

**总结**：

拉回一个分裂上同态的箭头仍然是分裂上同态，这表明拉回在某些范畴结构中保留了分裂上同态的性质。

**练习10**：

**题目**：

证明如果下面的左右两个方块都是拉回图式，那么外部的矩形也是拉回图式。这对最弱前置条件有何意义？

$$
\begin{array}{ccc}
A & \xrightarrow{f} & B \\
\downarrow{g} & & \downarrow{h} \\
C & \xrightarrow{k} & D \\
\end{array}
\quad \text{和} \quad
\begin{array}{ccc}
B & \xrightarrow{h} & D \\
\downarrow{h} & & \downarrow{h} \\
E & \xrightarrow{l} & F \\
\end{array}
$$

**解析**：

**目标**：

证明如果两个内部方块都是拉回图式，那么整个外部矩形也是拉回图式，并解释其对最弱前置条件的意义。

**证明步骤**：

1. **设定**：

   - 假设内部的两个方块都是拉回图式。
   
2. **验证外部矩形**：

   - 通过组合内部拉回的性质，验证外部矩形满足拉回的定义条件。
   
   - 需要验证所有条件的满足，包括平行性和普遍性条件。
   
3. **应用拉回的稳定性**：

   - 使用拉回的稳定性性质，说明组合后的拉回结构依然满足拉回的定义。
   
4. **结论**：

   因此，外部的矩形也是拉回图式。

**对最弱前置条件的意义**：

- **最弱前置条件的传递性**：通过组合拉回，可以确保在程序验证中，复杂条件的最弱前置条件仍然可以通过组合简单条件的最弱前置条件来确定。
  
- **模块化验证**：使得程序片段的验证可以模块化进行，每个子模块通过拉回来确定其最弱前置条件，最终组合得到整体的最弱前置条件。

**总结**：

通过证明拉回的组合性，可以更高效地处理复杂的程序验证问题，确保条件的传递性和模块化。

## 本节总结

**拉回（Pullbacks）** 是范畴论中一种重要的有限极限，能够描述两个态射在共同目标下的紧密结合。通过具体例子和命题的证明，我们理解了拉回的构造方法及其在保持态射性质（如单态性）中的重要作用。

**主要要点**：

1. **拉回的定义**：
   - 拉回是处理两个具有共同目标的态射的极限。
   - 它由一个对象$P$及其态射$p_1, p_2$构成，满足$f \circ p_1 = g \circ p_2 $。

2. **具体例子**：
   - 在$\text{Set}$中，拉回对象是满足特定关系的积子集。
   - 函数的逆像也是拉回的一个特例，用于描述条件的最弱前置条件。

3. **命题与定理**：
   - 拉回中的态射可以保持原箭头的性质，如单态性。
   - 拉回的组合性确保了复杂图式的拉回构造。

4. **应用**：
   - **程序验证**：通过拉回构造最弱前置条件，确保程序的正确性。
   - **范畴结构分析**：理解和构造复杂对象间的关系。

5. **练习题**：
   - 通过练习题加深对拉回构造和性质的理解，巩固理论知识。

**应用与扩展**：

- **程序验证**：利用拉回描述程序片段的条件关系，确保程序在满足特定前置条件下能够正确执行。
- **逻辑编程**：通过拉回来描述逻辑规则的组合和推理过程。
- **代数结构研究**：利用拉回构造复杂代数结构的子对象和商对象。

通过对拉回的深入理解，读者能够更好地掌握范畴论中有限极限的核心概念，并将其应用于各种数学和计算机科学的问题中，为后续章节中更复杂的极限与余极限概念打下坚实的基础。

### ----------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.4节：余等化子（Coequalizers）**。本节将探讨余等化子的定义、在集合范畴中的具体构造、相关命题以及练习题。余等化子作为等化子的对偶概念，在范畴论中具有重要的作用，特别是在描述对象间的“合并”关系时尤为关键。

## 9.4 余等化子（Coequalizers）

### 9.4.1 余等化子的定义（Definition）

**定义**：

设$f, g : A \rightrightarrows B$是一个范畴$\mathcal{C}$中的两条平行态射。一个态射$h : B \to C$被称为$f$和$g$的**余等化子（Coequalizer）**，如果满足以下条件：

1. **兼容性条件**：
  $$
   h \circ f = h \circ g
  $$
   即，$ h$将$f$和$g$映射到同一个态射。

2. **普遍性条件**：
   对于任何态射$k : B \to D $，如果$k \circ f = k \circ g $，则存在唯一的态射$l : C \to D $，使得：
  $$
   l \circ h = k
  $$
   

**直观理解**：

余等化子$h : B \to C$可以看作是通过将$f$和$g$的“差异”强制消除，形成一个新的对象$C $，其中$f$和$g$在$C$中被“等同化”。

### 9.4.2 集合范畴中的余等化子（Coequalizers in Set）

**例子1：集合范畴中的余等化子**

设$f, g : S \rightrightarrows T$是集合范畴$\text{Set}$中的两个函数。余等化子$h : T \to U$必须满足：

1. **兼容性条件**：
  $$
   h \circ f = h \circ g
  $$
   
2. **普遍性条件**：
   对于任何函数$k : T \to V $，如果$k \circ f = k \circ g $，则存在唯一的函数$l : U \to V $，使得：
  $$
   l \circ h = k
  $$
   

**构造方法**：

1. **定义关系$R $**：
   
   由$f$和$g$定义的关系$R \subseteq T \times T$为：
  $$
   R = \{ (f(s), g(s)) \mid s \in S \}
  $$
   
   这个关系描述了$f$和$g$如何在$T$中“配对”。

2. **构造等价关系$R_e $**：
   
  $R$通常不是一个等价关系，因此需要将其扩展为最小的等价关系$R_e $，即对$R$进行自反、对称和传递闭包。

   - **自反闭包**：
    $$
     R_1 = R \cup \Delta \cup R^{\text{op}}
    $$
     其中$\Delta = \{ (t, t) \mid t \in T \}$是自反关系，$ R^{\text{op}} = \{ (t_2, t_1) \mid (t_1, t_2) \in R \}$是对称关系。

   - **传递闭包**：
     通过递归定义$R_{i+1} = \{ (t_1, t_2) \mid \exists t \in T, (t_1, t) \in R_1 \text{ 且 } (t, t_2) \in R_i \}$对每个$i \in \mathbb{N} $，最终得到$R_e = \bigcup_{n \in \mathbb{N}} R_n $。

3. **构造商集$U $**：
   
   令$U = T / R_e $，即$T$上关于等价关系$R_e$的商集。

4. **定义余等化子$h $**：
   
   定义函数$h : T \to U$为将每个元素$t \in T$映射到其等价类：
  $$
   h(t) = [t]
  $$
   

**命题9.4.2**：

**命题**：
箭头$h : T \to U$是$f$和$g$的余等化子。

**证明**：

1. **兼容性条件**：
   
   对于任意$s \in S $，有：
  $$
   h(f(s)) = [f(s)] = [g(s)] = h(g(s))
  $$
   因此，$ h \circ f = h \circ g $。

2. **普遍性条件**：
   
   设$k : T \to V$满足$k \circ f = k \circ g $。
   
   由于$R \subseteq R_e $，对于所有$(t_1, t_2) \in R_e $，有$k(t_1) = k(t_2) $。
   
   这意味着$k$在每个等价类上是恒定的，因此存在唯一的函数$l : U \to V $，使得：
  $$
   l([t]) = k(t)
  $$
   
   从而：
  $$
   l \circ h = k
  $$
   
   因为$h$是满射（每个等价类都有代表元素），$ l$是唯一的。

**结论**：

因此，$ h$满足余等化子的定义，是$f$和$g$的余等化子。

### 9.4.3 正则上同态（Regular Epimorphisms）

**定义与命题**：

- **等化子的单态性**：
  
  在命题9.1.2中，我们已经看到等化子是单态的。余等化子的对偶命题是：**所有的余等化子都是上同态**。

- **命题**：
  
  不是所有的上同态都是余等化子的。例如，在幺半群范畴中，将非负整数包含到所有整数中的映射是一个上同态，但它不是任何一对态射的余等化子。

- **正则上同态（Regular Epimorphisms）**：
  
  如果一个上同态$h : B \to C$是某对平行态射$f, g : A \rightrightarrows B$的余等化子，则称$h$为**正则上同态**。

  **定义**：
  
  正则上同态是那些可以被表示为某对平行态射的余等化子的上同态。

- **集合范畴中的性质**：
  
  在集合范畴$\text{Set}$中，所有的上同态都是正则的。这是因为在$\text{Set}$中，每个上同态都是余等化子的余等化子。

**命题9.4.3**：

**命题**：
在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**解释**：

- 这意味着，通过拉回构造，如果原始箭头$f$是单态的，那么拉回图式中的$p_2 : P \to B$也保持了单态的性质。

**证明**（详见练习题3）：

由于在本节中命题的证明被留给了练习题，下面我们将在**练习3**中详细证明。

### 9.4.4 练习题（Exercises）

**练习1**：

**题目**：
证明图式（9.4）是一个拉回图式。

**图式（9.4）**：

$$
\begin{array}{ccc}
S & \xrightarrow{f} & T \\
g \downarrow & & \downarrow{i} \\
g^{-1}(A) & \xrightarrow{j} & A \\
\end{array}
$$

其中，$ g^{-1}(A) = \{ x \in S \mid g(x) \in A \} $，$ j$是包含映射，$ h$是$g$在$g^{-1}(A)$上的限制映射。

**解析**：

**目标**：
证明图式（9.4）是一个拉回图式，即$g^{-1}(A)$及其态射$j : g^{-1}(A) \to S$和$h : g^{-1}(A) \to A$满足拉回的定义条件。

**证明步骤**：

1. **构造拉回对象**：

   - 拉回对象$P = g^{-1}(A) $。
   - 态射$p_1 = j : P \to S$是包含映射。
   - 态射$p_2 = h : P \to A$是$g$在$P$上的限制映射。
   
2. **验证拉回条件**：

   - **兼容性条件**：
    $$
     f \circ p_1 = f \circ j = i \circ h = i \circ p_2
    $$
     因此，图式满足兼容性条件$f \circ p_1 = i \circ p_2 $。
     
   - **普遍性条件**：
     对于任何对象$C$及其态射$k : C \to S$和$l : C \to A$满足：
    $$
     f \circ k = i \circ l
    $$
     需要存在唯一态射$m : C \to P$使得：
    $$
     j \circ m = k \quad \text{和} \quad h \circ m = l
    $$
     
     **构造$m $**：
     定义$m(c) = c$其中$c \in C$映射到$P$中的元素$(c, l(c)) $，确保$l(c) = g(c) \in A $，因此$m$是合法的。
     
     **唯一性**：
     由于$P$是包含映射，且$m$满足$j \circ m = k$和$h \circ m = l $，$ m$是唯一的。
   
3. **结论**：

   因此，图式（9.4）满足拉回的定义条件，是一个拉回图式。

**练习2**：

**题目**：
证明定理9.3.3。

**定理9.3.3重述**：
对于任意一个箭头$f : A \to B$在范畴$\mathcal{C}$中，以下三个条件是等价的：

1. **(a)$f$是单态（Monic）**。
2. **(b) 图式**
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \end{array}
  $$
   是一个极限锥子。
3. **(c) 存在一个对象$P$和一个箭头$g : P \to A $，使得图式**
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。

**证明**：

我们需要证明$(a) \Leftrightarrow (b) \Leftrightarrow (c) $。

1. **(a)$\Rightarrow$(b)**：
   
   假设$f$是单态的。我们需要证明图式$A \rightrightarrows^{f}_{f} B$是一个极限锥子。
   
   - **极限锥子的定义**：
     需要满足兼容性条件$f \circ \text{id}_A = f \circ \text{id}_A $（显然成立），并且对于任何满足条件的态射族，存在唯一的态射因子化到$A $。
   
   - **普遍性条件**：
     假设有一个对象$C$及其态射$h_1, h_2 : C \to A$满足：
    $$
     f \circ h_1 = f \circ h_2
    $$
     由于$f$是单态的，得$h_1 = h_2 $。
     
     因此，极限锥子满足普遍性条件，即图式$A \rightrightarrows^{f}_{f} B$是极限锥子。

2. **(b)$\Rightarrow$(a)**：
   
   假设图式$A \rightrightarrows^{f}_{f} B$是一个极限锥子。我们需要证明$f$是单态的。
   
   - **单态的定义**：
     对于任意两个态射$h_1, h_2 : C \to A $，如果$f \circ h_1 = f \circ h_2 $，则$h_1 = h_2 $。
   
   - **利用极限锥子的普遍性**：
     由于图式是极限锥子，存在唯一的态射因子化$h : C \to A $，使得$\text{id}_A \circ h = h_1$和$\text{id}_A \circ h = h_2 $，即$h_1 = h_2 $。
   
   - **结论**：
     因此，$ f$是单态的。

3. **(a)$\Rightarrow$(c)**：
   
   假设$f$是单态的。我们需要构造一个对象$P$及态射$g : P \to A $，使得图式
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。
   
   - **构造$P $**：
     令$P = A $。
   
   - **定义态射**：
     定义$g = \text{id}_A : P \to A $。
   
   - **验证兼容性条件**：
    $$
     f \circ g = f \circ \text{id}_A = f = f \circ g
    $$
     因此，兼容性条件满足。
   
   - **普遍性条件**：
     对于任何满足$f \circ h = f \circ h$的态射$h : C \to A $，由于$f$是单态的，得$h$唯一。
     
     因此，存在唯一态射$l : C \to P$使得$g \circ l = h $，即$l = h $。
   
   - **结论**：
     因此，图式是极限锥子。

4. **(c)$\Rightarrow$(a)**：
   
   假设存在一个对象$P$及态射$g : P \to A $，使得图式
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。需要证明$f$是单态的。
   
   - **利用普遍性条件**：
     取$C = A $，并考虑态射$h_1 = \text{id}_A$和$h_2 = \text{id}_A $。
     
     根据普遍性条件，存在唯一态射$l : A \to P$使得：
    $$
     g \circ l = h_1 = \text{id}_A
    $$
     即，$ g \circ l = \text{id}_A $。
     
   - **构造右逆**：
     因为$g \circ l = \text{id}_A $，$ g$具有右逆$l $，即$g$是一个分裂单态。
     
   - **证明$f$是单态**：
     对于任意两个态射$k_1, k_2 : C \to A $，如果$f \circ k_1 = f \circ k_2 $，则：
    $$
     g \circ (k_1) = g \circ (k_2)
    $$
     因为$g \circ l = \text{id}_A $，则：
    $$
     k_1 = l \circ g \circ k_1 = l \circ g \circ k_2 = k_2
    $$
     
     因此，$ f$是单态的。

**结论**：

这三个条件互相等价，证明了定理9.3.3。

**练习3**：

**题目**：
证明命题9.3.4。

**命题9.3.4重述**：
在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

其中，$ f \circ p_1 = g \circ p_2 $。

**证明**：

**目标**：
证明如果$f$是单态的，那么拉回图式中的$p_2 : P \to B$也是单态的。

**证明步骤**：

1. **假设**：
   
  $f : A \to B$是单态的，即对于任意态射$h_1, h_2 : X \to A $，若$f \circ h_1 = f \circ h_2 $，则$h_1 = h_2 $。

2. **要证明**：
   
  $p_2 : P \to B$是单态的，即对于任意态射$k_1, k_2 : Y \to P $，若$p_2 \circ k_1 = p_2 \circ k_2 $，则$k_1 = k_2 $。

3. **利用拉回的普遍性条件**：
   
   - 拉回图式满足$f \circ p_1 = g \circ p_2 $。
   
   - 设$p_2 \circ k_1 = p_2 \circ k_2 = k $。
   
   - 根据拉回的普遍性条件，存在唯一的态射$m : Y \to P $，使得：
    $$
     p_1 \circ m = p_1 \circ k_1 \quad \text{和} \quad p_2 \circ m = p_2 \circ k_1
    $$
   
   - 由于$p_2 \circ k_1 = p_2 \circ k_2 $，得：
    $$
     p_2 \circ k_1 = p_2 \circ k_2
    $$
   
   - 同时，由于$p_1 \circ k_1 = p_1 \circ k_2 $，根据拉回的普遍性条件，得：
    $$
     k_1 = k_2
    $$
   
4. **结论**：
   
   因此，$ p_2$是单态的。

**总结**：

在拉回图式中，如果原始箭头$f$是单态的，那么从拉回对象到$B$的投影箭头$p_2$也保持了单态性。

### 9.4.5 最弱前置条件作为拉回（Weakest Precondition as Pullback）

**引言**：

在程序验证中，通常需要为程序片段附加前置条件和后置条件。一个常用的方法是确定每个后置条件的“最弱前置条件”（weakest precondition），即在保证程序片段执行后满足后置条件所需的最小条件。

**例子**：

考虑以下程序片段：

```
1. {X < 3}         // 前置条件
2. X := X + 1;     // 程序片段
3. {X < 24}        // 后置条件
```

- **前置条件**：在执行程序片段之前，变量$X$满足$X < 3 $。
- **后置条件**：在执行程序片段之后，变量$X$满足$X < 24 $。

**最弱前置条件**：

对于给定的后置条件$\{X < 24\} $，最弱前置条件是$\{X < 23\} $，因为在$X < 23$的情况下，执行$X := X + 1$后，必然有$X < 24 $。

**范畴论解释**：

将这个过程放入范畴论的框架中，可以通过拉回来描述最弱前置条件。

1. **定义**：

   - 设$D$是输入集合，$ E$是输出集合。
   - 程序片段被视为一个态射$f : D \to E $。

2. **条件与子对象**：

   - 任何条件$C$在集合$X$上可以被视为其子集$X_0 = \{ x \in X \mid x \text{ 满足 } C \} $。
   - 后置条件$S \subseteq E $。

3. **最弱前置条件**：

   - 最弱前置条件是$f^{-1}(S) = \{ x \in D \mid f(x) \in S \} $。
   - 这是$D$的一个子对象，通过包含映射$j : f^{-1}(S) \hookrightarrow D $。
   - 拉回图式为：

    $$
     \begin{array}{ccc}
     f^{-1}(S) & \xrightarrow{j} & D \\
     \downarrow{h} & & \downarrow{f} \\
     S & \xrightarrow{i} & E \\
     \end{array}
    $$
     
     其中，$ h$是$f$在$f^{-1}(S)$上的限制映射。

4. **实例**：

   - 对于程序片段$X := X + 1 $，后置条件$S = \{ X \mid X < 24 \} $，最弱前置条件是$f^{-1}(S) = \{ X \mid X + 1 < 24 \} = \{ X \mid X < 23 \} $。
   

**总结**：

通过将最弱前置条件视为拉回，可以利用范畴论的工具来形式化和分析程序验证中的条件推导过程。这为程序语义的形式化提供了强有力的理论支持。

### 9.4.6 重新审视构造所有有限极限（Constructing All Finite Limits Revisited）

**引言**：

推论9.2.11描述了一类极限的存在性如何保证所有有限极限的存在。类似的构造方法也适用于拉回。

**命题9.4.7**：

**命题**：
如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明概要**：

1. **利用终对象和拉回构造有限极限**：
   
   - **终对象**：作为空积（0-极限）。
   
   - **积的存在性**：
     - 二元积可以通过拉回构造。
     - 一般的有限积可以通过组合二元积来构造。
   
   - **更复杂的有限图式**：
     - 通过组合多个拉回，可以构造任意有限图式的极限。

2. **数学归纳法**：
   
   - **基础情况**：终对象和二元积满足有限极限的基础条件。
   
   - **归纳步骤**：假设对于包含$n$个箭头的有限图式，其极限存在；通过添加一个箭头，利用拉回来构造包含$n + 1$个箭头的图式的极限。

**结论**：

因此，具有终对象和所有拉回的范畴必然具有所有有限极限。

### 9.4.8 练习题（Exercises）

**练习4**：

**题目**：
证明如果图式（9.3）是在任何具有积的范畴中一个拉回，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。（这里$p_1$和$p_2$指的是图式中所标记的箭头。）

**图式（9.3）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & S \\
\downarrow{p_2} & & \downarrow{f} \\
U & \xrightarrow{g} & T \\
\end{array}
$$

**解析**：

**目标**：
证明在任何具有积的范畴中，如果图式（9.3）是一个拉回图式，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**证明步骤**：

1. **构造积**：
   
   - 在范畴$\mathcal{C}$中，$ S \times U$是$S$和$U$的积。
   - 态射$\langle p_1, p_2 \rangle : P \to S \times U$是由$p_1$和$p_2$组成的唯一态射，使得：
    $$
     \pi_S \circ \langle p_1, p_2 \rangle = p_1 \quad \text{和} \quad \pi_U \circ \langle p_1, p_2 \rangle = p_2
    $$
     其中，$ \pi_S : S \times U \to S$和$\pi_U : S \times U \to U$是积的投影态射。

2. **验证单态性**：
   
   - 需要证明$\langle p_1, p_2 \rangle$是单态的，即对于任意态射$h_1, h_2 : X \to P $，若：
    $$
     \langle p_1, p_2 \rangle \circ h_1 = \langle p_1, p_2 \rangle \circ h_2
    $$
     则$h_1 = h_2 $。
   
   - 根据积的定义，有：
    $$
     p_1 \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_2 = p_1 \circ h_2
    $$
    $$
     p_2 \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_2 = p_2 \circ h_2
    $$
   
   - 因为图式是拉回图式，且$p_1 \circ h_1 = p_1 \circ h_2$和$p_2 \circ h_1 = p_2 \circ h_2 $，根据拉回的普遍性条件，得$h_1 = h_2 $。
   
3. **结论**：
   
   因此，态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**总结**：

在具有积的范畴中，通过拉回构造的态射到积对象的自然箭头是单态的，这反映了拉回对象在积对象中的“唯一性”特性。

**练习5**：

**题目**：
证明等化子可以通过积和拉回来构造。（提示：先在集合范畴中操作，然后推广到一般范畴。）

**解析**：

**目标**：
证明在一个具有积和拉回的范畴中，任意等化子可以通过积和拉回来构造。

**证明步骤**：

1. **设定**：
   
   - 给定一对平行态射$f, g : A \rightrightarrows B $。
   
2. **构造积**：
   
   - 构造$A \times A $，即$A$和自身的积。
   - 投影态射$\pi_1, \pi_2 : A \times A \to A $。

3. **构造拉回**：
   
   - 构造拉回$P$及其态射$p_1, p_2 : P \to A $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$
   
   - 由于$P$是拉回对象，满足普遍性条件。

4. **定义等化子**：
   
   - 定义等化子$E$及其包含态射$e : E \hookrightarrow A $，满足：
    $$
     f \circ e = g \circ e
    $$
   
   - 由拉回的普遍性条件，存在唯一态射$e : E \hookrightarrow A $，使得$p_1 \circ e = p_2 \circ e $。

5. **验证等化子性质**：
   
   - **兼容性条件**：
    $$
     f \circ e = f \circ p_1 \circ e = g \circ p_2 \circ e = g \circ e
    $$
   
   - **普遍性条件**：
     对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一态射$k : C \to E$使得$e \circ k = h $。
   
6. **结论**：
   
   因此，等化子$E \hookrightarrow A$可以通过构造积$A \times A$和拉回$P$来得到。

**总结**：

在具有积和拉回的范畴中，等化子可以通过构造积和拉回来实现。这展示了极限构造中的模块化和组合性，使得复杂的极限结构能够通过基本的极限（积和拉回）的组合来构造。

**练习6**：

**题目**：
证明命题9.3.7。

**命题9.3.7重述**：
如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明**：

**目标**：
证明如果一个范畴$\mathcal{C}$具有终对象和所有拉回，那么$\mathcal{C}$具有所有有限极限。

**证明步骤**：

1. **基础情况**：
   
   - **终对象**：在有限极限中，终对象对应于空图式的极限。
   - **二元积**：
     - 在范畴$\mathcal{C}$中，二元积$S \times U$可以通过拉回构造：
      $$
       \begin{array}{ccc}
       S \times U & \xrightarrow{\pi_1} & S \\
       \downarrow{\pi_2} & & \downarrow{\text{id}_S} \\
       U & \xrightarrow{f} & S \\
       \end{array}
      $$
       其中，$ f : S \to S$是恒等映射，拉回对象即为$S \times U $。
   
2. **数学归纳法**：
   
   - **假设**：
     - 假设对于任何包含$n$个箭头的有限图式，其极限存在。
   
   - **归纳步骤**：
     - 设有一个包含$n + 1$个箭头的有限图式。
     - 将该图式拆分为一个包含$n$个箭头的子图式和一个新箭头。
     - 利用归纳假设，已知包含$n$个箭头的子图式的极限存在。
     - 通过拉回来结合新箭头，构造包含$n + 1$个箭头的图式的极限。
   
3. **构造方法**：
   
   - 使用拉回的普遍性条件，确保新的拉回对象满足所有兼容性条件和普遍性条件。
   - 逐步添加箭头，确保每一步都能通过拉回来保持极限的性质。
   
4. **结论**：
   
   通过数学归纳法，证明了具有终对象和所有拉回的范畴$\mathcal{C}$具有所有有限极限。

**总结**：

具有终对象和所有拉回的范畴能够通过组合这些基本极限构造出所有有限极限。这为理解和构造复杂的极限结构提供了系统的方法。

**练习7**：

**题目**：
证明在集合范畴$\text{Set}$中，如果图式（9.2）中的箭头$f$是上同态（Epimorphism），那么$p_2$也是上同态。（即在$\text{Set}$中，拉回一个满射仍然是满射。）

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

其中，$ f \circ p_1 = g \circ p_2 $。

**证明**：

**目标**：
证明如果$f : A \to C$是满射的，那么$p_2 : P \to B$也是满射的。

**证明步骤**：

1. **设定**：
   
   -$f : A \to C$是满射。
   - 拉回对象$P = \{ (b, a) \in B \times A \mid g(b) = f(a) \} $。
   - 态射$p_1 : P \to A$和$p_2 : P \to B$分别为投影映射。

2. **验证$p_2$是满射**：
   
   - 对于任意$b \in B $，由于$f$是满射，存在$a \in A$使得$f(a) = g(b) $。
   
   - 因此，$ (b, a) \in P $，且$p_2(b, a) = b $。
   
   - 这表明对于每个$b \in B $，存在$p = (b, a) \in P$使得$p_2(p) = b $。

3. **结论**：
   
   因此，态射$p_2 : P \to B$是满射的，即上同态。

**总结**：

在集合范畴中，通过拉回构造的投影态射$p_2$保持了原箭头$f$的上同态性（即满射性）。这展示了拉回在保持态射性质方面的有力作用。

**练习8**：

**题目**：
给出一个范畴，其中存在一个上同态，其拉回沿至少一个箭头不是上同态的。

**解析**：

**目标**：
构造一个范畴，其中存在一个上同态$f$，使得沿某个箭头的拉回$p_2$不是上同态的。

**构造方法**：

1. **选择范畴**：
   
   选择幺半群范畴$\text{Mon}$作为例子。

2. **定义箭头**：
   
   - 设$f : \mathbb{N} \hookrightarrow \mathbb{Z}$是从自然数集合$\mathbb{N}$到整数集合$\mathbb{Z}$的包含映射。
   - 在$\text{Mon}$中，幺半群同态必须保持运算和单位元。
   
3. **验证$f$是上同态**：
   
   -$f$是上同态，因为在$\text{Mon}$中，包含映射保留了幺半群结构，并且$f$满足$f(n + m) = f(n) + f(m) $。
   -$f$是满射，因为每个整数都可以表示为两个自然数的差，但在幺半群中，差运算不被保留，因此$f$不是满射。
   
   **修正**：
   
   为了确保$f$是上同态，可以选择一个不同的例子。例如，考虑$f : \mathbb{N} \to \mathbb{N}$定义为$f(n) = 0 $，这是一个满射。

4. **构造拉回**：
   
   选择一个箭头$g : \mathbb{N} \to \mathbb{N} $，例如$g(n) = 2n $。
   
   - 拉回对象$P$满足$f(p_1(n)) = g(p_2(n)) $，即$0 = 2 p_2(n) $，所以$p_2(n) = 0 $。
   
   - 因此，$ P$是$\mathbb{N} \times \mathbb{N}$中满足$p_2(n) = 0$的元素集合，即$P = \mathbb{N} \times \{0\} $。

5. **验证$p_2$不是上同态**：
   
   - 定义$p_2 : P \to \mathbb{N}$为投影映射。
   -$p_2(n, 0) = 0 $，对于任何$n \in \mathbb{N} $，$ p_2(n, 0) = 0 $。
   
   - 因此，$ p_2$将所有元素映射到$0 $，即$p_2$不是满射。

**结论**：

在幺半群范畴$\text{Mon}$中，存在一个上同态$f $（例如常数映射$f(n) = 0 $）其拉回沿某个箭头$g$的投影$p_2$不是上同态的。

**总结**：

通过在幺半群范畴中的具体构造，我们展示了存在上同态的拉回箭头不保持上同态性的情况。这说明，在一般范畴中，拉回不一定保持所有态射的性质，强调了拉回行为在不同范畴中的多样性。

**练习9**：

**题目**：
证明在任何范畴中，拉回一个分裂上同态（split epimorphism）仍然是一个分裂上同态。

**解析**：

**目标**：
证明如果$f : A \to B$是一个分裂上同态（即存在$g : B \to A$满足$f \circ g = \text{id}_B $），那么拉回图式中的$p_2 : P \to C$也是分裂上同态。

**证明步骤**：

1. **设定**：
   
   -$f : A \to B$是分裂上同态，存在$g : B \to A $，使得：
    $$
     f \circ g = \text{id}_B
    $$
   
   - 构造拉回$P$及其态射$p_1 : P \to A$和$p_2 : P \to C $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$
   
2. **构造右逆**：
   
   - 需要构造一个态射$h : C \to P $，使得：
    $$
     p_2 \circ h = \text{id}_C
    $$
   
   - 定义$h$如下：
    $$
     h(c) = (g \circ g(c), c)
    $$
     其中，$ g(c) \in A $，且满足$f(g(c)) = g(c) $，因为$f \circ g = \text{id}_B $。
   
   - 验证：
    $$
     p_2(h(c)) = p_2(g(g(c)), c) = c
    $$
   
3. **验证右逆的存在性**：
   
   - 因为$p_2 \circ h = \text{id}_C $，所以$h$是$p_2$的右逆。
   
4. **结论**：
   
   因此，$ p_2$是分裂上同态。

**总结**：

拉回一个分裂上同态的箭头仍然是分裂上同态。这表明拉回在保持某些态射性质（如分裂上同态性）方面具有稳定性。

**练习10**：

**题目**：
证明如果下面的左右两个方块都是拉回图式，那么外部的矩形也是拉回图式。这对最弱前置条件有何意义？

$$
\begin{array}{ccc}
C & \xrightarrow{g} & D \\
\downarrow{f} & & \downarrow{h} \\
B & \xrightarrow{k} & E \\
\end{array}
\quad \text{和} \quad
\begin{array}{ccc}
D & \xrightarrow{h} & E \\
\downarrow{m} & & \downarrow{n} \\
F & \xrightarrow{p} & G \\
\end{array}
$$

**证明**：

**目标**：
证明如果两个内部方块都是拉回图式，那么整个外部矩形也是拉回图式。同时解释其对最弱前置条件的意义。

**证明步骤**：

1. **设定**：
   
   - 左方块：
    $$
     \begin{array}{ccc}
     C & \xrightarrow{g} & D \\
     \downarrow{f} & & \downarrow{h} \\
     B & \xrightarrow{k} & E \\
     \end{array}
    $$
     是一个拉回图式。
   
   - 右方块：
    $$
     \begin{array}{ccc}
     D & \xrightarrow{h} & E \\
     \downarrow{m} & & \downarrow{n} \\
     F & \xrightarrow{p} & G \\
     \end{array}
    $$
     也是一个拉回图式。
   
2. **构造外部矩形**：
   
   需要证明整个外部矩形：
  $$
   \begin{array}{ccc}
   C & \xrightarrow{g} & D \\
   \downarrow{f} & & \downarrow{h} \\
   B & \xrightarrow{k} & E \\
   \downarrow{n \circ k} & & \downarrow{n} \\
   G & & G \\
   \end{array}
  $$
   是一个拉回图式。

3. **验证拉回条件**：
   
   - **兼容性条件**：
     - 外部矩形需要满足$p \circ m = n \circ h $。
   
   - **普遍性条件**：
     - 对于任何满足兼容性条件的态射族，存在唯一态射因子化到外部矩形。
   
4. **利用内部拉回的普遍性条件**：
   
   - 由于左方块和右方块都是拉回图式，可以通过组合它们的普遍性条件，推导出外部矩形的普遍性条件。
   
   - 具体来说，拉回的普遍性条件保证了存在唯一态射因子化到外部矩形。
   
5. **结论**：
   
   因此，整个外部矩形也是一个拉回图式。

**对最弱前置条件的意义**：

- **条件的组合**：
  
  在程序验证中，最弱前置条件的组合可以通过拉回的组合性质来实现。即，复杂程序片段的前置条件可以通过组合多个子片段的拉回构造来得到。

- **模块化验证**：
  
  这种性质允许将程序分解为多个模块，每个模块通过拉回来确定其最弱前置条件，最终组合得到整体程序的最弱前置条件。

**总结**：

通过证明拉回的组合性，我们可以在处理复杂的程序验证问题时，利用拉回的稳定性和组合性，确保条件的传递性和模块化。这增强了程序验证方法的灵活性和可扩展性。

## 本节总结

**余等化子（Coequalizers）** 是等化子的对偶概念，用于在一对平行态射之间构造一个“合并”对象，使得两个态射在该对象上被等同化。在集合范畴中，余等化子通过构造商集的方式实现，具体涉及将满足特定关系的元素划分为等价类。

**主要要点**：

1. **余等化子的定义**：
   - 满足兼容性条件$h \circ f = h \circ g $。
   - 满足普遍性条件，对于任何满足$k \circ f = k \circ g$的态射$k $，存在唯一态射$l$使得$l \circ h = k $。

2. **集合范畴中的余等化子**：
   - 通过构造等价关系$R_e$并形成商集$U = T / R_e $，定义余等化子$h : T \to U $。
   - 余等化子在$\text{Set}$中对应于将元素按关系$f$和$g$生成的等价关系划分。

3. **正则上同态**：
   - 余等化子都是上同态。
   - 不是所有的上同态都是余等化子的，因此定义了正则上同态为那些可以表示为某对平行态射余等化子的上同态。

4. **拉回与单态性**：
   - 拉回构造中的态射可以保持原箭头的性质，如单态性。
   - 拉回的组合性保证了复杂图式的拉回构造。

5. **最弱前置条件**：
   - 程序验证中的最弱前置条件可以通过拉回来形式化和构造。
   - 拉回的组合性支持模块化的程序验证方法。

6. **构造有限极限**：
   - 具有终对象和所有拉回的范畴具备所有有限极限。
   - 等化子可以通过积和拉回来构造。

**应用与扩展**：

- **程序验证**：利用余等化子构造最弱前置条件，确保程序在特定条件下的正确性。
- **代数结构研究**：通过余等化子构造复杂的代数对象，如环、模等的商对象。
- **逻辑编程**：利用余等化子描述逻辑规则的合并和推理过程。
- **范畴结构分析**：理解和构造复杂对象间的合并关系，提高范畴论工具的应用能力。

通过掌握余等化子的定义、构造方法及其性质，读者能够更全面地理解范畴论中的极限与余极限概念，并将其应用于各种数学和计算机科学的问题中，为进一步学习和研究打下坚实的理论基础。

### ---------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.5节：余等化子（Coequalizers）**。本节将探讨余等化子的定义、在集合范畴中的具体构造、相关命题以及练习题。余等化子作为等化子的对偶概念，在范畴论中具有重要的作用，特别是在描述对象间的“合并”关系时尤为关键。

## 9.5 余等化子（Coequalizers）

### 9.5.1 定义（Definition）

**定义**：

设$f, g : A \rightrightarrows B$是一个范畴$\mathcal{C}$中的两条平行态射。一个态射$h : B \to C$被称为$f$和$g$的**余等化子（Coequalizer）**，如果满足以下条件：

1. **兼容性条件**：
  $$
   h \circ f = h \circ g
  $$
   即，$ h$将$f$和$g$映射到同一个态射。

2. **普遍性条件**：
   对于任何态射$k : B \to D $，如果$k \circ f = k \circ g $，则存在唯一的态射$l : C \to D $，使得：
  $$
   l \circ h = k
  $$

**直观理解**：

余等化子$h : B \to C$可以看作是通过将$f$和$g$的“差异”强制消除，形成一个新的对象$C $，其中$f$和$g$在$C$中被“等同化”。

### 9.5.2 集合范畴中的余等化子（Coequalizers in Set）

**例子1：集合范畴中的余等化子**

设$f, g : S \rightrightarrows T$是集合范畴$\text{Set}$中的两个函数。余等化子$h : T \to U$必须满足：

1. **兼容性条件**：
  $$
   h \circ f = h \circ g
  $$

2. **普遍性条件**：
   对于任何函数$k : T \to V $，如果$k \circ f = k \circ g $，则存在唯一的函数$l : U \to V $，使得：
  $$
   l \circ h = k
  $$

**构造方法**：

1. **定义关系$R $**：
   
   由$f$和$g$定义的关系$R \subseteq T \times T$为：
  $$
   R = \{ (f(s), g(s)) \mid s \in S \}
  $$
   
   这个关系描述了$f$和$g$如何在$T$中“配对”。

2. **构造等价关系$R_e $**：
   
  $R$通常不是一个等价关系，因此需要将其扩展为最小的等价关系$R_e $，即对$R$进行自反、对称和传递闭包。

   - **自反闭包**：
    $$
     R_1 = R \cup \Delta \cup R^{\text{op}}
    $$
     其中$\Delta = \{ (t, t) \mid t \in T \}$是自反关系，$ R^{\text{op}} = \{ (t_2, t_1) \mid (t_1, t_2) \in R \}$是对称关系。

   - **传递闭包**：
     通过递归定义
    $$
     R_{i+1} = \{ (t_1, t_2) \mid \exists t \in T, (t_1, t) \in R_1 \text{ 且 } (t, t_2) \in R_i \}
    $$
     对每个$i \in \mathbb{N} $，最终得到
    $$
     R_e = \bigcup_{n \in \mathbb{N}} R_n
    $$
     即$R_e$是$R_1$的传递闭包，也是包含$R$的最小等价关系。

3. **构造商集$U $**：
   
   令$U = T / R_e $，即$T$上关于等价关系$R_e$的商集。

4. **定义余等化子$h $**：
   
   定义函数$h : T \to U$为将每个元素$t \in T$映射到其等价类：
  $$
   h(t) = [t]
  $$

**命题9.4.2**：

**命题**：

箭头$h : T \to U$是$f$和$g$的余等化子。

**证明**：

1. **兼容性条件**：

   对于任意$s \in S $，有：
  $$
   h(f(s)) = [f(s)] = [g(s)] = h(g(s))
  $$
   因此，$ h \circ f = h \circ g $。

2. **普遍性条件**：

   设$k : T \to V$满足$k \circ f = k \circ g $。

   由于$R \subseteq R_e $，对于所有$(t_1, t_2) \in R_e $，有$k(t_1) = k(t_2) $。

   这意味着$k$在每个等价类上是恒定的，因此存在唯一的函数$l : U \to V $，使得：
  $$
   l([t]) = k(t)
  $$
   
   从而：
  $$
   l \circ h = k
  $$
   
   因为$h$是满射（每个等价类都有代表元素），$ l$是唯一的。

**结论**：

因此，$ h$满足余等化子的定义，是$f$和$g$的余等化子。

### 9.5.3 正则上同态（Regular Epimorphisms）

**定义与命题**：

- **余等化子的上同态性**：

  在命题9.1.2中，我们已经看到等化子是单态的。余等化子的对偶命题是：**所有的余等化子都是上同态（Epimorphism）**。

- **命题**：

  不是所有的上同态都是余等化子的。例如，在**单半群**范畴中，将非负整数包含到所有整数中的映射是一个上同态，但它不是任何一对态射的余等化子。

- **正则上同态（Regular Epimorphisms）**：

  如果一个上同态$h : B \to C$是某对平行态射$f, g : A \rightrightarrows B$的余等化子，则称$h$为**正则上同态（Regular Epimorphism）**。

  **定义**：

  正则上同态是那些可以被表示为某对平行态射余等化子的上同态。

- **集合范畴中的性质**：

  在集合范畴$\text{Set}$中，所有的上同态都是正则的。这是因为在$\text{Set}$中，每个上同态都是余等化子的余等化子。

**命题9.4.3**：

**命题**：

在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**解释**：

- 这意味着，通过拉回构造，如果原始箭头$f$是单态的，那么拉回图式中的$p_2 : P \to B$也保持了单态的性质。
- 具体来说，如果$f$在$P$上是单态的，那么从$P$到$B$的箭头$p_2$也是单态的。

**证明**（详见练习题3）：

由于在本节中命题的证明被留给了练习题，下面我们将在**练习3**中详细证明。

### 9.5.4 练习题（Exercises）

**练习1**：

**题目**：

证明图式（9.4）是一个拉回图式。

**图式（9.4）**：

$$
\begin{array}{ccc}
S & \xrightarrow{f} & T \\
g \downarrow & & \downarrow{i} \\
g^{-1}(A) & \xrightarrow{j} & A \\
\end{array}
$$

其中，$ g^{-1}(A) = \{ x \in S \mid g(x) \in A \} $，$ j$是包含映射，$ h$是$g$在$g^{-1}(A)$上的限制映射。

**解析**：

**目标**：

证明图式（9.4）是一个拉回图式，即$g^{-1}(A)$及其态射$j : g^{-1}(A) \to S$和$h : g^{-1}(A) \to A$满足拉回的定义条件。

**证明步骤**：

1. **构造拉回对象**：

   - 拉回对象$P = g^{-1}(A) $。
   - 态射$p_1 = j : P \to S$是包含映射。
   - 态射$p_2 = h : P \to A$是$g$在$P$上的限制映射。

2. **验证拉回条件**：

   - **兼容性条件**：
    $$
     f \circ p_1 = f \circ j = i \circ h = i \circ p_2
    $$
     因此，图式满足兼容性条件$f \circ p_1 = i \circ p_2 $。

   - **普遍性条件**：
     对于任何对象$C$及其态射$k : C \to S$和$l : C \to A$满足：
    $$
     f \circ k = i \circ l
    $$
     需要存在唯一态射$m : C \to P$使得：
    $$
     j \circ m = k \quad \text{和} \quad h \circ m = l
    $$
     
     **构造$m $**：
     定义$m(c) = c$其中$c \in C$映射到$P$中的元素$(c, l(c)) $，确保$l(c) = g(c) \in A $，因此$m$是合法的。

     **唯一性**：
     由于$P$是包含映射，且$m$满足$j \circ m = k$和$h \circ m = l $，$ m$是唯一的。

3. **结论**：

   因此，图式（9.4）满足拉回的定义条件，是一个拉回图式。

**练习2**：

**题目**：

证明定理9.3.3。

**定理9.3.3重述**：

对于任意一个箭头$f : A \to B$在范畴$\mathcal{C}$中，以下三个条件是等价的：

1. **(a)$f$是单态（Monic）**。
2. **(b) 图式**
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \end{array}
  $$
   是一个极限锥子。
3. **(c) 存在一个对象$P$和一个箭头$g : P \to A $，使得图式**
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。

**证明**：

我们需要证明$(a) \Leftrightarrow (b) \Leftrightarrow (c) $。

1. **(a)$\Rightarrow$(b)**：

   假设$f$是单态的。我们需要证明图式$A \rightrightarrows^{f}_{f} B$是一个极限锥子。

   - **极限锥子的定义**：
     需要满足兼容性条件$f \circ \text{id}_A = f \circ \text{id}_A $（显然成立），并且对于任何满足条件的态射族，存在唯一的态射因子化到$A $。

   - **普遍性条件**：
     假设有一个对象$C$及其态射$h_1, h_2 : C \to A$满足：
    $$
     f \circ h_1 = f \circ h_2
    $$
     由于$f$是单态的，得$h_1 = h_2 $。

     因此，极限锥子满足普遍性条件，即图式$A \rightrightarrows^{f}_{f} B$是极限锥子。

2. **(b)$\Rightarrow$(a)**：

   假设图式$A \rightrightarrows^{f}_{f} B$是一个极限锥子。我们需要证明$f$是单态的。

   - **单态的定义**：
     对于任意两个态射$h_1, h_2 : C \to A $，如果$f \circ h_1 = f \circ h_2 $，则$h_1 = h_2 $。

   - **利用极限锥子的普遍性**：
     由于图式是极限锥子，存在唯一的态射因子化$h : C \to A $，使得$\text{id}_A \circ h = h_1$和$\text{id}_A \circ h = h_2 $，即$h_1 = h_2 $。

   - **结论**：
     因此，$ f$是单态的。

3. **(a)$\Rightarrow$(c)**：

   假设$f$是单态的。我们需要构造一个对象$P$及态射$g : P \to A $，使得图式
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。

   - **构造$P $**：
     令$P = A $。

   - **定义态射**：
     定义$g = \text{id}_A : P \to A $。

   - **验证兼容性条件**：
    $$
     f \circ g = f \circ \text{id}_A = f = f \circ g
    $$
     因此，兼容性条件满足。

   - **普遍性条件**：
     对于任何满足$f \circ h = f \circ h$的态射$h : C \to A $，由于$f$是单态的，得$h$唯一。
     
     因此，存在唯一态射$l : C \to P$使得$g \circ l = h $，即$l = h $。

   - **结论**：
     因此，图式是极限锥子。

4. **(c)$\Rightarrow$(a)**：

   假设存在一个对象$P$及态射$g : P \to A $，使得图式
  $$
   \begin{array}{ccc}
   A & \rightrightarrows^{f}_{f} & B \\
   \downarrow & & \downarrow \\
   P & \xrightarrow{g} & A \\
   \end{array}
  $$
   是一个极限锥子。需要证明$f$是单态的。

   - **利用普遍性条件**：
     取$C = A $，并考虑态射$h_1 = \text{id}_A$和$h_2 = \text{id}_A $。

     根据普遍性条件，存在唯一态射$l : A \to P$使得：
    $$
     g \circ l = h_1 = \text{id}_A
    $$
     即，$ g \circ l = \text{id}_A $。

     因为$g \circ l = \text{id}_A $，$ g$具有右逆$l $，即$g$是一个分裂单态。

   - **证明$f$是单态**：
     对于任意两个态射$k_1, k_2 : C \to A $，如果$f \circ k_1 = f \circ k_2 $，则：
    $$
     g \circ (k_1) = g \circ (k_2)
    $$
     因为$g \circ l = \text{id}_A $，则：
    $$
     k_1 = l \circ g \circ k_1 = l \circ g \circ k_2 = k_2
    $$
     
     因此，$ f$是单态的。

**结论**：

这三个条件互相等价，证明了定理9.3.3。

**练习3**：

**题目**：

证明命题9.3.4。

**命题9.3.4重述**：

在图式（9.2）中，如果箭头$f$是单态的，那么$p_2$也是单态的。

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

其中，$ f \circ p_1 = g \circ p_2 $。

**证明**：

**目标**：

证明如果$f$是单态的，那么拉回图式中的$p_2 : P \to B$也是单态的。

**证明步骤**：

1. **假设**：

  $f : A \to B$是单态的。

2. **要证明**：

  $p_2 : P \to B$是单态的，即对于任意态射$h_1, h_2 : Q \to P $，如果$p_2 \circ h_1 = p_2 \circ h_2 $，则$h_1 = h_2 $。

3. **利用拉回的普遍性条件**：

   - 拉回图式满足$f \circ p_1 = g \circ p_2 $。
   
   - 假设$p_2 \circ h_1 = p_2 \circ h_2 = k $。

   - 根据拉回的普遍性条件，存在唯一的态射$m : Q \to P $，使得：
    $$
     p_1 \circ m = p_1 \circ h_i \quad \text{和} \quad p_2 \circ m = p_2 \circ h_i \quad (i = 1, 2)
    $$
   
   - 由于$p_2 \circ h_1 = p_2 \circ h_2 $，以及$p_1 \circ h_1 = p_1 \circ h_2 $（因为$f \circ p_1 = g \circ p_2$且$f$是单态的），因此根据普遍性条件，得：
    $$
     h_1 = h_2
    $$

4. **结论**：

   因此，$ p_2$是单态的。

**总结**：

拉回中的一个箭头$p_2$保持了原箭头$f$的单态性。这表明拉回构造在保持态射性质（如单态性）方面具有重要作用。

### 9.5.5 等式、等化子与余等化子（Equations, Equalizers, and Coequalizers）

**引言**：

- **等化子**：可以看作是在某个子对象上满足特定等式或方程组的最大子对象。
- **余等化子**：可以看作是通过最少的“破坏性”标识来强制某个等式在等价类上成立的最小对象。

**例子**：

考虑有两种定义有理数的方法：

1. **通过余等化子构造有理数**：

   在第一种构造中，将$\mathbb{Z} \times \mathbb{N}^+$中的元素$(a, b)$记作$a/b $。定义等价关系$a/b \sim c/d$当且仅当$a \cdot d = b \cdot c $。这是通过余等化子的方式实现的，具体可以视为某对态射的余等化子。

2. **通过等化子构造有理数**：

   在第二种构造中，只考虑相对质数的有序对$(a, b) $（即$\gcd(a, b) = 1 $）。这可以通过等化子来实现，即等化子对应于满足$\gcd(a, b) = 1$的最大子集。

**总结**：

- **等化子** 和 **余等化子** 提供了在范畴论中处理等式和等价关系的强大工具。
- 通过等化子，可以在对象上定义满足特定条件的子对象。
- 通过余等化子，可以在对象上强制特定条件成立，形成新的对象。

### 9.5.6 重新审视构造所有有限余极限（Constructing All Finite Colimits Revisited）

**引言**：

推论9.2.11描述了一类极限的存在性如何保证所有有限极限的存在。类似的构造方法也适用于余等化子和其他有限余极限。

**命题9.5.7**：

**命题**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明概要**：

1. **利用终对象和拉回构造有限极限**：
   
   - **终对象**：作为空图式（0-极限）的极限。
   
   - **二元积**：
     - 二元积可以通过拉回构造。例如，通过拉回恒等映射来获得二元积。

   - **更复杂的有限图式**：
     - 通过组合多个拉回来逐步构造任意有限图式的极限。

2. **数学归纳法**：
   
   - **基础情况**：
     - 范畴中具有终对象和二元积。
   
   - **归纳步骤**：
     - 假设对于包含$n$个箭头的有限图式，其极限存在。
     - 添加一个箭头，通过拉回来构造包含$n + 1$个箭头的图式的极限。

3. **结论**：

   因此，具有终对象和所有拉回的范畴必然具有所有有限极限。

**总结**：

具有终对象和所有拉回的范畴能够通过组合这些基本极限构造出所有有限极限。这为理解和构造复杂的极限结构提供了系统的方法。

### 9.5.8 练习题（Exercises）

**练习4**：

**题目**：

证明如果图式（9.3）是在任何具有积的范畴中一个拉回，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。（这里$p_1$和$p_2$指的是图式中所标记的箭头。）

**图式（9.3）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & S \\
\downarrow{p_2} & & \downarrow{f} \\
U & \xrightarrow{g} & T \\
\end{array}
$$

**解析**：

**目标**：

证明在任何具有积的范畴中，如果图式（9.3）是一个拉回图式，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**证明步骤**：

1. **构造积**：

   - 在范畴$\mathcal{C}$中，$ S \times U$是$S$和$U$的积。
   - 态射$\langle p_1, p_2 \rangle : P \to S \times U$是由$p_1$和$p_2$组成的唯一态射，使得：
    $$
     \pi_S \circ \langle p_1, p_2 \rangle = p_1 \quad \text{和} \quad \pi_U \circ \langle p_1, p_2 \rangle = p_2
    $$
     其中，$ \pi_S : S \times U \to S$和$\pi_U : S \times U \to U$是积的投影态射。

2. **验证单态性**：

   - 需要证明$\langle p_1, p_2 \rangle$是单态的，即对于任意态射$h_1, h_2 : X \to P $，若：
    $$
     \langle p_1, p_2 \rangle \circ h_1 = \langle p_1, p_2 \rangle \circ h_2
    $$
     则$h_1 = h_2 $。

   - 根据积的定义，有：
    $$
     p_1 \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_2 = p_1 \circ h_2
    $$
    $$
     p_2 \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_2 = p_2 \circ h_2
    $$
   
   - 因为图式是拉回图式，且$p_1 \circ h_1 = p_1 \circ h_2$和$p_2 \circ h_1 = p_2 \circ h_2 $，根据拉回的普遍性条件，得$h_1 = h_2 $。

3. **结论**：

   因此，态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**总结**：

在具有积的范畴中，通过拉回构造的态射到积对象的自然箭头是单态的，这反映了拉回对象在积对象中的“唯一性”特性。

**练习5**：

**题目**：

证明等化子可以通过积和拉回来构造。（提示：先在集合范畴中操作，然后推广到一般范畴。）

**解析**：

**目标**：

证明在一个具有积和拉回的范畴中，任意等化子可以通过积和拉回来构造。

**证明步骤**：

1. **设定**：

   - 给定一对平行态射$f, g : A \rightrightarrows B $。

2. **构造积**：

   - 构造$A \times A $，即$A$和自身的积。
   - 投影态射$\pi_1, \pi_2 : A \times A \to A $。

3. **构造拉回**：

   - 构造拉回$P$及其态射$p_1, p_2 : P \to A $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$
   
   - 由于$P$是拉回对象，满足普遍性条件。

4. **定义等化子**：

   - 定义等化子$E$及其包含态射$e : E \hookrightarrow A $，满足：
    $$
     f \circ e = g \circ e
    $$
   
   - 由拉回的普遍性条件，存在唯一态射$e : E \hookrightarrow A $，使得$p_1 \circ e = p_2 \circ e $。

5. **验证等化子性质**：

   - **兼容性条件**：
    $$
     f \circ e = f \circ p_1 \circ e = g \circ p_2 \circ e = g \circ e
    $$
   
   - **普遍性条件**：
     对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一态射$k : C \to E$使得$e \circ k = h $。

6. **结论**：

   因此，等化子$E \hookrightarrow A$可以通过构造积$A \times A$和拉回$P$来得到。

**总结**：

在具有积和拉回的范畴中，等化子可以通过构造积和拉回来实现。这展示了极限构造中的模块化和组合性，使得复杂的极限结构能够通过基本的极限（积和拉回）的组合来构造。

**练习6**：

**题目**：

证明命题9.3.7。

**命题9.3.7重述**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明**：

**目标**：

证明如果一个范畴$\mathcal{C}$具有终对象和所有拉回，那么$\mathcal{C}$具有所有有限极限。

**证明步骤**：

1. **基础情况**：

   - **终对象**：在有限极限中，终对象对应于空图式（0-极限）的极限。
   
   - **二元积**：
     - 在范畴$\mathcal{C}$中，二元积$S \times U$可以通过拉回构造：
      $$
       \begin{array}{ccc}
       S \times U & \xrightarrow{\pi_1} & S \\
       \downarrow{\pi_2} & & \downarrow{\text{id}_S} \\
       U & \xrightarrow{f} & S \\
       \end{array}
      $$
       其中，$ f : S \to S$是恒等映射，拉回对象即为$S \times U $。

2. **数学归纳法**：

   - **假设**：
     - 假设对于任何包含$n$个箭头的有限图式，其极限存在。
   
   - **归纳步骤**：
     - 设有一个包含$n + 1$个箭头的有限图式。
     - 将该图式拆分为一个包含$n$个箭头的子图式和一个新箭头。
     - 利用归纳假设，已知包含$n$个箭头的子图式的极限存在。
     - 通过拉回来结合新箭头，构造包含$n + 1$个箭头的图式的极限。

3. **构造方法**：

   - 使用拉回的普遍性条件，确保新的拉回对象满足所有兼容性条件和普遍性条件。
   - 逐步添加箭头，确保每一步都能通过拉回来保持极限的性质。

4. **结论**：

   因此，具有终对象和所有拉回的范畴必然具有所有有限极限。

**总结**：

具有终对象和所有拉回的范畴能够通过组合这些基本极限构造出所有有限极限。这为理解和构造复杂的极限结构提供了系统的方法。

**练习7**：

**题目**：

证明在集合范畴$\text{Set}$中，如果图式（9.2）中的箭头$f$是上同态（Epimorphism），那么$p_2$也是上同态。（即在$\text{Set}$中，拉回一个满射仍然是满射。）

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

**证明**：

**目标**：

证明如果$f : A \to C$是满射的，那么$p_2 : P \to B$也是满射的。

**证明步骤**：

1. **设定**：

   -$f : A \to C$是满射。
   - 拉回对象$P = \{ (b, a) \in B \times A \mid g(b) = f(a) \} $。
   - 态射$p_1 : P \to A$和$p_2 : P \to B$分别为投影映射。

2. **验证$p_2$是满射**：

   - 对于任意$b \in B $，因为$f$是满射，存在$a \in A$使得$f(a) = g(b) $。
   
   - 因此，$ (b, a) \in P $，且$p_2(b, a) = b $。
   
   - 这表明对于每个$b \in B $，存在$p \in P$使得$p_2(p) = b $。

3. **结论**：

   因此，态射$p_2 : P \to B$是满射的，即上同态。

**总结**：

在集合范畴中，通过拉回构造的投影态射$p_2$保持了原箭头$f$的上同态性（即满射性）。这展示了拉回在保持态射性质方面的有力作用。

**练习8**：

**题目**：

给出一个范畴，其中存在一个上同态，其拉回沿至少一个箭头不是上同态的。

**解析**：

**目标**：

构造一个范畴，其中存在一个上同态$f $，使得沿某个箭头的拉回$p_2$不是上同态的。

**构造方法**：

1. **选择范畴**：

   选择**单半群**范畴$\text{Mon}$作为例子。

2. **定义箭头**：

   - 设$f : \mathbb{N} \to \mathbb{Z}$是从自然数集合$\mathbb{N}$到整数集合$\mathbb{Z}$的包含映射。
   - 在$\text{Mon}$中，幺半群同态必须保持运算和单位元。

3. **验证$f$是上同态**：

   -$f$是上同态，因为在$\text{Mon}$中，包含映射保留了幺半群结构，并且$f$满足$f(n + m) = f(n) + f(m) $。
   -$f$是满射，因为在幺半群中，差运算不被保留，因此$f$不是满射。**修正**：

   - 为了确保$f$是上同态，可以选择一个不同的例子。例如，考虑$f : \mathbb{N} \to \mathbb{N}$定义为$f(n) = 0 $，这是一个满射。

4. **构造拉回**：

   - 选择一个箭头$g : \mathbb{N} \to \mathbb{N} $，例如$g(n) = 2n $。
   
   - 拉回对象$P$满足$f(p_1(n)) = g(p_2(n)) $，即$0 = 2 p_2(n) $，所以$p_2(n) = 0 $。

   - 因此，$ P = \mathbb{N} \times \{0\} $。

5. **验证$p_2$不是上同态**：

   - 定义$p_2 : P \to \mathbb{N}$为投影映射。
   
   -$p_2(n, 0) = 0 $，对于任何$n \in \mathbb{N} $，$ p_2(n, 0) = 0 $。
   
   - 因此，$ p_2$将所有元素映射到$0 $，即$p_2$不是满射。

**结论**：

在单半群范畴$\text{Mon}$中，存在一个上同态$f $（例如常数映射$f(n) = 0 $），其拉回沿某个箭头$g$的投影$p_2$不是上同态的。

**总结**：

通过在单半群范畴中的具体构造，我们展示了存在上同态的拉回箭头不保持上同态性的情况。这说明在一般范畴中，拉回不一定保持所有态射的性质，强调了拉回行为在不同范畴中的多样性。

**练习9**：

**题目**：

证明在任何范畴中，拉回一个分裂上同态（split epimorphism）仍然是一个分裂上同态。

**解析**：

**目标**：

证明如果$f : A \to B$是一个分裂上同态（即存在$g : B \to A$满足$f \circ g = \text{id}_B $），那么拉回图式中的$p_2 : P \to C$也是分裂上同态。

**证明步骤**：

1. **设定**：

   -$f : A \to B$是分裂上同态，存在$g : B \to A $，使得：
    $$
     f \circ g = \text{id}_B
    $$
   
   - 构造拉回$P$及其态射$p_1 : P \to A$和$p_2 : P \to C $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$

2. **构造右逆**：

   - 需要构造一个态射$h : C \to P $，使得：
    $$
     p_2 \circ h = \text{id}_C
    $$
   
   - 定义$h$如下：
    $$
     h(c) = (g \circ h(c), c)
    $$
     其中$h(c)$是$C$中的元素，确保$g(c) \in A$且满足$f(g(c)) = g(c) $（因为$f \circ g = \text{id}_B $）。

3. **验证右逆的存在性**：

   - 因为$p_2 \circ h = \text{id}_C $，所以$h$是$p_2$的右逆。

4. **结论**：

   因此，$ p_2$是分裂上同态。

**总结**：

拉回一个分裂上同态的箭头仍然是分裂上同态。这表明拉回在保持某些态射性质（如分裂上同态性）方面具有稳定性。

**练习10**：

**题目**：

证明如果下面的左右两个方块都是拉回图式，那么外部的矩形也是拉回图式。这对最弱前置条件有何意义？

$$
\begin{array}{ccc}
C & \xrightarrow{g} & D \\
\downarrow{f} & & \downarrow{h} \\
B & \xrightarrow{k} & E \\
\end{array}
\quad \text{和} \quad
\begin{array}{ccc}
D & \xrightarrow{h} & E \\
\downarrow{m} & & \downarrow{n} \\
F & \xrightarrow{p} & G \\
\end{array}
$$

**证明**：

**目标**：

证明如果两个内部方块都是拉回图式，那么整个外部矩形也是拉回图式。同时解释其对最弱前置条件的意义。

**证明步骤**：

1. **设定**：

   - **左方块**：
    $$
     \begin{array}{ccc}
     C & \xrightarrow{g} & D \\
     \downarrow{f} & & \downarrow{h} \\
     B & \xrightarrow{k} & E \\
     \end{array}
    $$
     是一个拉回图式。
   
   - **右方块**：
    $$
     \begin{array}{ccc}
     D & \xrightarrow{h} & E \\
     \downarrow{m} & & \downarrow{n} \\
     F & \xrightarrow{p} & G \\
     \end{array}
    $$
     也是一个拉回图式。

2. **构造外部矩形**：

   需要证明整个外部矩形：
  $$
   \begin{array}{ccc}
   C & \xrightarrow{g} & D \\
   \downarrow{f} & & \downarrow{h} \\
   B & \xrightarrow{k} & E \\
   \downarrow{n \circ k} & & \downarrow{n} \\
   G & & G \\
   \end{array}
  $$
   是一个拉回图式。

3. **验证拉回条件**：

   - **兼容性条件**：
     - 外部矩形需要满足$p \circ m = n \circ h $。
   
   - **普遍性条件**：
     - 对于任何对象$R$及其态射$r_1 : G \to R$和$r_2 : G \to R$满足：
      $$
       p \circ r_1 = n \circ r_2
      $$
     - 需要存在唯一态射$r : E \to R$使得：
      $$
       r \circ h = r_1 \quad \text{和} \quad r \circ n = r_2
      $$

4. **利用内部拉回的普遍性条件**：

   - 由于左方块和右方块都是拉回图式，可以通过组合它们的普遍性条件，推导出外部矩形的普遍性条件。

   - 具体来说，拉回的普遍性条件保证了存在唯一态射因子化到外部矩形。

5. **结论**：

   因此，整个外部矩形也是一个拉回图式。

**对最弱前置条件的意义**：

- **条件的组合**：

  在程序验证中，最弱前置条件的组合可以通过拉回的组合性质来实现。即，复杂程序片段的前置条件可以通过组合多个子片段的拉回构造来得到。

- **模块化验证**：

  这种性质允许将程序分解为多个模块，每个模块通过拉回来确定其最弱前置条件，最终组合得到整体程序的最弱前置条件。

**总结**：

通过证明拉回的组合性，可以更高效地处理复杂的程序验证问题，确保条件的传递性和模块化。

## 本节总结

**余等化子（Coequalizers）** 是等化子的对偶概念，用于在一对平行态射之间构造一个“合并”对象，使得两个态射在该对象上被等同化。在集合范畴中，余等化子通过构造商集的方式实现，具体涉及将满足特定关系的元素划分为等价类。

**主要要点**：

1. **余等化子的定义**：
   - 满足兼容性条件$h \circ f = h \circ g $。
   - 满足普遍性条件，对于任何满足$k \circ f = k \circ g$的态射$k $，存在唯一态射$l$使得$l \circ h = k $。

2. **集合范畴中的余等化子**：
   - 通过构造等价关系$R_e$并形成商集$U = T / R_e $，定义余等化子$h : T \to U $。
   - 余等化子在$\text{Set}$中对应于将元素按关系$f$和$g$生成的等价关系划分。

3. **正则上同态**：
   - 余等化子都是上同态。
   - 不是所有的上同态都是余等化子的，因此定义了正则上同态为那些可以表示为某对平行态射余等化子的上同态。

4. **拉回与单态性**：
   - 拉回构造中的态射可以保持原箭头的性质，如单态性。
   - 拉回的组合性保证了复杂图式的拉回构造。

5. **最弱前置条件**：
   - 程序验证中的最弱前置条件可以通过拉回来形式化和构造。
   - 拉回的组合性支持模块化的程序验证方法。

6. **构造有限极限**：
   - 具有终对象和所有拉回的范畴具备所有有限极限。
   - 等化子可以通过积和拉回来构造。

**应用与扩展**：

- **程序验证**：利用余等化子构造最弱前置条件，确保程序在特定条件下的正确性。
- **代数结构研究**：通过余等化子构造复杂的代数对象，如环、模等的商对象。
- **逻辑编程**：利用余等化子描述逻辑规则的合并和推理过程。
- **范畴结构分析**：理解和构造复杂对象间的合并关系，提高范畴论工具的应用能力。

通过掌握余等化子的定义、构造方法及其性质，读者能够更全面地理解范畴论中的极限与余极限概念，并将其应用于各种数学和计算机科学的问题中，为进一步学习和研究打下坚实的理论基础。

### ----------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.6节：关于和（Sums）更多内容**。本节将探讨范畴中和的特殊性质，包括和的**不相交性**（Disjoint Sums）和**普遍性**（Universality），并通过具体例子说明这些概念在不同范畴中的表现。此外，我们还将介绍**FLS范畴**（Finite Limits and Sums Categories）和**一致范畴**（Coherent Categories），以及无限普遍和的相关内容。

## 9.6 关于和的更多内容（More about Sums）

### 9.6.1 不相交和（Disjoint Sums）

**定义**：

设$A$和$B$是一个范畴$\mathcal{C}$中的两个对象，且该范畴具有一个初始对象$0$和它们的和$A + B $。我们有一个交换图式：

$$
\begin{array}{ccc}
A & \xrightarrow{i} & A + B \\
\downarrow{0} & & \downarrow{j} \\
B & \xrightarrow{k} & A + B \\
\end{array}
\quad \text{（图式9.8）}
$$

如果以下两个条件同时满足：

1. 图式（9.8）是一个**拉回**（Pullback）。
2. 规范注入态射$i: A \to A + B$和$j: B \to A + B$是**单态**（Monic）的。

则称和$A + B$是**不相交的和**，即和是**不相交的**。

**性质与解释**：

- **不相交性**意味着在和对象$A + B$中，来自$A$和$B$的子对象$A$和$B$仅在初始对象$0$处重合。换句话说，除了$0$以外，$ A$和$B$在和对象中不相交。
- 在集合范畴$\text{Set}$中，和通常通过**不相交并集**来实现，即将两个集合通过添加标记来确保它们在并集中不相交。

**例子1：集合范畴中的不相交和**

在$\text{Set}$中，给定两个集合$A$和$B $，它们的不相交和$A + B$通常定义为：

$$
A + B = \{ (a, 1) \mid a \in A \} \cup \{ (b, 2) \mid b \in B \}
$$

其中，$ (a, 1)$和$(b, 2)$通过第二个分量$1$和$2$来标记，确保$A$和$B$在和中不相交。

### 9.6.2 推前（Pushouts）

**定义**：

推前（Pushout）是拉回的对偶概念。具体来说，给定一个交换方形：

$$
\begin{array}{ccc}
B & \xrightarrow{q_2} & Q \\
\downarrow{f} & & \downarrow{r} \\
C & \xrightarrow{q_1} & Q \\
\end{array}
\quad \text{（图式9.6）}
$$

如果对于任意对象$R$和任意一对态射$r_1: C \to R$和$r_2: B \to R $，满足$r_1 \circ f = r_2 \circ g $，则存在唯一的态射$r: Q \to R$使得：

$$
r \circ q_1 = r_1 \quad \text{且} \quad r \circ q_2 = r_2
$$

则称图式（9.6）是一个**推前**。

**解释**：

推前可以看作是通过“拼接”两个对象来形成一个新的对象$Q $，使得在$Q$中$B$和$C$通过它们的共同部分$A$被合并。

**例子2：集合范畴中的推前**

在$\text{Set}$中，推前可以通过**并集**的方式实现。例如，设有两个函数$f: A \to B$和$g: A \to C $，则它们的推前$Q$可以构造为：

$$
Q = (B \sqcup C) / \sim
$$

其中，$ \sim$是由$f(a) \sim g(a)$对所有$a \in A$生成的等价关系。这里，$ \sqcup$表示不相交并集。

### 9.6.3 例子：集合范畴中的补集

**例子3：集合范畴中的补集**

在$\text{Set}$中，每个子对象都有一个补集。这是因为对于任意集合$S$和其子集$A \subseteq S $，补集$B = S \setminus A$满足$A \cup B = S$且$A \cap B = \emptyset $。这对应于前述的不相交和的定义。

### 9.6.4 例子：单半群范畴中的非补集子对象

**例子4：单半群范畴中的非补集子对象**

在单半群范畴$\text{Mon}$中，存在许多**非补集**的子对象。例如，将非负整数集$\mathbb{N}$包含到整数集$\mathbb{Z}$中的映射是一个单态的子对象，但其补集（负整数集）并不是一个子半群，因为负整数集不包含单位元$0 $，且两个负整数的和不一定是负整数。

**说明**：

即使在集合范畴中每个子集都有补集，在更结构化的范畴中，如单半群范畴，补集的存在性受到额外的结构限制。

### 9.6.5 可计算子集（Computable Subsets）

**引言**：

从计算的角度来看，某些自然数的可计算子集没有可计算的补集。这在程序语言语义学中具有重要意义，因为条件语句如 `if n in A then P` 的可计算性依赖于集合$A$具有补集。

**定义**：

- **可计算集合（Computable Set）**：一个集合$A \subseteq \mathbb{N}$是**可计算的**或**递归可枚举的**（recursively enumerable），如果存在一个算法能在输入$n$时停机并接受（halt and accept）当且仅当$n \in A $。
- **非可计算补集**：如果一个可计算集合$A$满足存在一个元素$n$其成员资格无法通过任何算法决定，则$A$的补集$\mathbb{N} \setminus A$不是可计算的。

**例子**：

存在可计算集合$A$具有属性：

1. **性质（a）**：存在一个算法，当且仅当$n \in A$时，该算法在输入$n$时停机。
2. **性质（b）**：不存在任何算法能在所有输入$n$时决定$n \in A $。

这样的集合$A$的补集$\mathbb{N} \setminus A$无法通过算法完全决定。

**解释**：

在计算机科学中，编程语言的语义需要确定条件语句的行为。只有当条件集合及其补集都是可计算的时，条件语句才能有明确的计算意义。

### 9.6.6 普遍和（Universal Sums）

**定义**：

在一个具有拉回的范畴中，和$A = \coprod_{i \in I} A_i$及其过渡态射$u_i: A_i \to A$是**普遍的**（universal），如果对于任何态射$B \to A $，有：

$$
\forall i \in I, \quad B \times_A A_i \cong B_i
$$

且存在一个同构$\coprod_{i \in I} B_i \cong B $，其中$B_i = B \times_A A_i $。

**解释**：

普遍和的定义意味着和对象$A$具有以下性质：

1. **普遍性**：和对象是一个“最优”的对象，能唯一地映射到任何满足过渡条件的对象。
2. **保结构性**：拉回保留了和的结构，使得可以通过拉回来构造更复杂的对象。

**性质**：

- **有限普遍和**：在有限集合索引$I$的情况下，和对象仍然满足普遍和的定义。
- **初始对象的角色**：如果索引集合为空，和对象是初始对象。

**例子5：集合范畴中的普遍和**

在$\text{Set}$中，和对象满足普遍和的定义。给定一族集合$\{A_i\}_{i \in I} $，它们的和$\coprod_{i \in I} A_i$通过不相交并集构造，且满足普遍性条件。

### 9.6.7 FLS范畴（Finite Limits and Sums Categories）

**定义**：

一个范畴被称为**FLS范畴**（Finite Limits and Sums Category，简称FLS范畴），如果它满足以下条件：

1. **具有有限极限**：范畴中存在所有有限图式的极限。
2. **具有有限和**：范畴中存在所有有限对象的和。
3. **和的不相交性与普遍性**：和是**不相交的**且**普遍的**。

**解释**：

FLS范畴结合了有限极限和有限和的结构，使得在这些范畴中可以方便地构造和操作对象的极限和和。

**例子6：代数结构范畴**

许多代数结构的范畴，如群、环、模等，都是FLS范畴，因为它们通常具有有限极限和有限和，并且和满足不相交性和普遍性。

### 9.6.8 一致范畴（Coherent Categories）

**定义**：

一个范畴被称为**一致范畴**（Coherent Category），如果它同时是FLS范畴和**正则范畴**（Regular Category）。

**解释**：

一致范畴结合了有限极限、有限和以及正则范畴的性质，使得它们在逻辑和计算机科学中具有重要的应用，特别是在描述和操作逻辑规则时。

**性质**：

- **逻辑对应**：一致范畴对应于一种称为**正逻辑**（Positive Logic）的逻辑体系。
- **范畴同态**：一致范畴之间的同态保留了有限极限、有限和和正则上同态的结构。

**例子7：模型范畴**

所有基于**有限前置条件**（Finite Prelimit）的模型范畴都是一致范畴。例如，所有多元有理代数结构的范畴都是一致范畴。

### 9.6.9 无限普遍和（Infinite Universal Sums）

**定义**：

在一个具有拉回的范畴中，一个无限和$A = \coprod_{i \in I} A_i$及其过渡态射$u_i: A_i \to A$是**无限普遍的**（Infinite Universal），如果对于任何态射$B \to A $，有：

$$
\forall i \in I, \quad B \times_A A_i \cong B_i
$$

并且：

$$
\coprod_{i \in I} B_i \cong B
$$

其中$B_i = B \times_A A_i $。

**解释**：

无限普遍和的定义是有限普遍和的推广，适用于无限索引集合。它确保和对象在无限情况下仍然具有最优的映射和结构保持性质。

**性质**：

- **保结构性**：无限普遍和允许在无限情况下通过拉回来保持和的结构。
- **同构性**：确保通过拉回来构造的对象与和对象保持同构关系。

**例子8：集合范畴中的无限普遍和**

在$\text{Set}$中，任意无限和$\coprod_{i \in I} A_i$满足无限普遍和的定义，因为不相交并集在任意索引集合下都满足普遍性条件。

## 9.6.9 练习题（Exercises）

**练习4**：

**题目**：

证明如果图式（9.3）是在任何具有积的范畴中一个拉回，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。（这里$p_1$和$p_2$指的是图式中所标记的箭头。）

**图式（9.3）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & S \\
\downarrow{p_2} & & \downarrow{f} \\
U & \xrightarrow{g} & T \\
\end{array}
$$

**解析**：

**目标**：

证明在任何具有积的范畴中，如果图式（9.3）是一个拉回图式，那么态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**证明步骤**：

1. **构造积**：

   - 在范畴$\mathcal{C}$中，$ S \times U$是$S$和$U$的积。
   - 态射$\langle p_1, p_2 \rangle : P \to S \times U$是由$p_1$和$p_2$组成的唯一态射，使得：
    $$
     \pi_S \circ \langle p_1, p_2 \rangle = p_1 \quad \text{和} \quad \pi_U \circ \langle p_1, p_2 \rangle = p_2
    $$
     其中，$ \pi_S : S \times U \to S$和$\pi_U : S \times U \to U$是积的投影态射。

2. **验证单态性**：

   - 需要证明$\langle p_1, p_2 \rangle$是单态的，即对于任意态射$h_1, h_2 : X \to P $，若：
    $$
     \langle p_1, p_2 \rangle \circ h_1 = \langle p_1, p_2 \rangle \circ h_2
    $$
     则$h_1 = h_2 $。
   
   - 根据积的定义，有：
    $$
     p_1 \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_S \circ \langle p_1, p_2 \rangle \circ h_2 = p_1 \circ h_2
    $$
    $$
     p_2 \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_1 = \pi_U \circ \langle p_1, p_2 \rangle \circ h_2 = p_2 \circ h_2
    $$
   
   - 因为图式是拉回图式，且$p_1 \circ h_1 = p_1 \circ h_2$和$p_2 \circ h_1 = p_2 \circ h_2 $，根据拉回的普遍性条件，得$h_1 = h_2 $。

3. **结论**：

   因此，态射$\langle p_1, p_2 \rangle : P \to S \times U$是单态的。

**练习5**：

**题目**：

证明等化子可以通过积和拉回来构造。（提示：先在集合范畴中操作，然后推广到一般范畴。）

**解析**：

**目标**：

证明在一个具有积和拉回的范畴中，任意等化子可以通过积和拉回来构造。

**证明步骤**：

1. **设定**：

   - 给定一对平行态射$f, g : A \rightrightarrows B $。

2. **构造积**：

   - 构造$A \times A $，即$A$和自身的积。
   - 投影态射$\pi_1, \pi_2 : A \times A \to A $。

3. **构造拉回**：

   - 构造拉回$P$及其态射$p_1, p_2 : P \to A $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$
   
   - 由于$P$是拉回对象，满足普遍性条件。

4. **定义等化子**：

   - 定义等化子$E$及其包含态射$e : E \hookrightarrow A $，满足：
    $$
     f \circ e = g \circ e
    $$
   
   - 由拉回的普遍性条件，存在唯一态射$e : E \hookrightarrow A $，使得$p_1 \circ e = p_2 \circ e $。

5. **验证等化子性质**：

   - **兼容性条件**：
    $$
     f \circ e = f \circ p_1 \circ e = g \circ p_2 \circ e = g \circ e
    $$
   
   - **普遍性条件**：
     对于任何$h : C \to A$满足$f \circ h = g \circ h $，存在唯一态射$k : C \to E$使得$e \circ k = h $。

6. **结论**：

   因此，等化子$E \hookrightarrow A$可以通过构造积$A \times A$和拉回$P$来得到。

**总结**：

在具有积和拉回的范畴中，等化子可以通过构造积和拉回来实现。这展示了极限构造中的模块化和组合性，使得复杂的极限结构能够通过基本的极限（积和拉回）的组合来构造。

**练习6**：

**题目**：

证明命题9.3.7。

**命题9.3.7重述**：

如果一个范畴具有终对象和所有拉回，那么它具有所有有限极限。

**证明**：

**目标**：

证明如果一个范畴$\mathcal{C}$具有终对象和所有拉回，那么$\mathcal{C}$具有所有有限极限。

**证明步骤**：

1. **基础情况**：

   - **终对象**：在有限极限中，终对象对应于空图式（0-极限）的极限。
   
   - **二元积**：
     - 在范畴$\mathcal{C}$中，二元积$S \times U$可以通过拉回构造：
      $$
       \begin{array}{ccc}
       S \times U & \xrightarrow{\pi_1} & S \\
       \downarrow{\pi_2} & & \downarrow{\text{id}_S} \\
       U & \xrightarrow{\text{id}_S} & S \\
       \end{array}
      $$
       其中，$ \text{id}_S : S \to S$是恒等映射，拉回对象即为$S \times U $。

2. **数学归纳法**：

   - **假设**：
     - 假设对于任何包含$n$个箭头的有限图式，其极限存在。
   
   - **归纳步骤**：
     - 设有一个包含$n + 1$个箭头的有限图式。
     - 将该图式拆分为一个包含$n$个箭头的子图式和一个新箭头。
     - 利用归纳假设，已知包含$n$个箭头的子图式的极限存在。
     - 通过拉回来结合新箭头，构造包含$n + 1$个箭头的图式的极限。

3. **构造方法**：

   - 使用拉回的普遍性条件，确保新的拉回对象满足所有兼容性条件和普遍性条件。
   - 逐步添加箭头，确保每一步都能通过拉回来保持极限的性质。

4. **结论**：

   因此，具有终对象和所有拉回的范畴必然具有所有有限极限。

**总结**：

具有终对象和所有拉回的范畴能够通过组合这些基本极限构造出所有有限极限。这为理解和构造复杂的极限结构提供了系统的方法。

**练习7**：

**题目**：

证明在集合范畴$\text{Set}$中，如果图式（9.2）中的箭头$f$是上同态（Epimorphism），那么$p_2$也是上同态。（即在$\text{Set}$中，拉回一个满射仍然是满射。）

**图式（9.2）**：

$$
\begin{array}{ccc}
P & \xrightarrow{p_1} & A \\
\downarrow{p_2} & & \downarrow{f} \\
B & \xrightarrow{g} & C \\
\end{array}
$$

**证明**：

**目标**：

证明如果$f : A \to C$是满射的，那么$p_2 : P \to B$也是满射的。

**证明步骤**：

1. **设定**：

   -$f : A \to C$是满射。
   - 拉回对象$P = \{ (b, a) \in B \times A \mid g(b) = f(a) \} $。
   - 态射$p_1 : P \to A$和$p_2 : P \to B$分别为投影映射。

2. **验证$p_2$是满射**：

   - 对于任意$b \in B $，因为$f$是满射，存在$a \in A$使得$f(a) = g(b) $。
   - 因此，$ (b, a) \in P $，且$p_2(b, a) = b $。
   - 这表明对于每个$b \in B $，存在$p \in P$使得$p_2(p) = b $。

3. **结论**：

   因此，态射$p_2 : P \to B$是满射的，即上同态。

**总结**：

在集合范畴中，通过拉回构造的投影态射$p_2$保持了原箭头$f$的上同态性（即满射性）。这展示了拉回在保持态射性质方面的有力作用。

**练习8**：

**题目**：

给出一个范畴，其中存在一个上同态，其拉回沿至少一个箭头不是上同态的。

**解析**：

**目标**：

构造一个范畴，其中存在一个上同态$f $，使得沿某个箭头的拉回$p_2$不是上同态的。

**构造方法**：

1. **选择范畴**：

   选择**单半群**范畴$\text{Mon}$作为例子。

2. **定义箭头**：

   - 设$f : \mathbb{N} \to \mathbb{N}$定义为$f(n) = 0 $（常数映射），这是一个满射上同态。
   
3. **构造拉回**：

   - 选择一个箭头$g : \mathbb{N} \to \mathbb{N} $，例如$g(n) = 2n $。
   - 拉回对象$P$满足$f(p_1(n)) = g(p_2(n)) $，即$0 = 2 p_2(n) $，所以$p_2(n) = 0 $。
   - 因此，$ P = \mathbb{N} \times \{0\} $。

4. **验证$p_2$不是上同态**：

   - 定义$p_2 : P \to \mathbb{N}$为投影映射。
   -$p_2(n, 0) = 0 $，对于任何$n \in \mathbb{N} $，$ p_2(n, 0) = 0 $。
   - 因此，$ p_2$将所有元素映射到$0 $，即$p_2$不是满射。

**结论**：

在单半群范畴$\text{Mon}$中，存在一个上同态$f $（例如常数映射$f(n) = 0 $），其拉回沿某个箭头$g$的投影$p_2$不是上同态的。

**总结**：

通过在单半群范畴中的具体构造，我们展示了存在上同态的拉回箭头不保持上同态性的情况。这说明在一般范畴中，拉回不一定保持所有态射的性质，强调了拉回行为在不同范畴中的多样性。

**练习9**：

**题目**：

证明在任何范畴中，拉回一个分裂上同态（split epimorphism）仍然是一个分裂上同态。

**解析**：

**目标**：

证明如果$f : A \to B$是一个分裂上同态（即存在$g : B \to A$满足$f \circ g = \text{id}_B $），那么拉回图式中的$p_2 : P \to C$也是分裂上同态。

**证明步骤**：

1. **设定**：

   -$f : A \to B$是分裂上同态，存在$g : B \to A $，满足：
    $$
     f \circ g = \text{id}_B
    $$
   
   - 构造拉回$P$及其态射$p_1 : P \to A$和$p_2 : P \to C $，满足：
    $$
     f \circ p_1 = g \circ p_2
    $$

2. **构造右逆**：

   - 需要构造一个态射$h : C \to P $，使得：
    $$
     p_2 \circ h = \text{id}_C
    $$
   
   - 定义$h$如下：
    $$
     h(c) = (g(c), c)
    $$
     其中，$ g(c) \in A $，且满足$f(g(c)) = g(c) $（因为$f \circ g = \text{id}_B $）。

3. **验证右逆的存在性**：

   - 因为$p_2 \circ h = p_2(g(c), c) = c $，所以$h$是$p_2$的右逆。
   
4. **结论**：

   因此，$ p_2$是分裂上同态。

**总结**：

拉回一个分裂上同态的箭头仍然是分裂上同态。这表明拉回在保持某些态射性质（如分裂上同态性）方面具有稳定性。

**练习10**：

**题目**：

证明如果下面的左右两个方块都是拉回图式，那么外部的矩形也是拉回图式。这对最弱前置条件有何意义？

$$
\begin{array}{ccc}
C & \xrightarrow{g} & D \\
\downarrow{f} & & \downarrow{h} \\
B & \xrightarrow{k} & E \\
\end{array}
\quad \text{和} \quad
\begin{array}{ccc}
D & \xrightarrow{h} & E \\
\downarrow{m} & & \downarrow{n} \\
F & \xrightarrow{p} & G \\
\end{array}
$$

**解析**：

**目标**：

证明如果两个内部方块都是拉回图式，那么整个外部矩形也是拉回图式。同时解释其对最弱前置条件的意义。

**证明步骤**：

1. **设定**：

   - **左方块**：
    $$
     \begin{array}{ccc}
     C & \xrightarrow{g} & D \\
     \downarrow{f} & & \downarrow{h} \\
     B & \xrightarrow{k} & E \\
     \end{array}
    $$
     是一个拉回图式。
   
   - **右方块**：
    $$
     \begin{array}{ccc}
     D & \xrightarrow{h} & E \\
     \downarrow{m} & & \downarrow{n} \\
     F & \xrightarrow{p} & G \\
     \end{array}
    $$
     也是一个拉回图式。

2. **构造外部矩形**：

   需要证明整个外部矩形：
  $$
   \begin{array}{ccc}
   C & \xrightarrow{g} & D \\
   \downarrow{f} & & \downarrow{h} \\
   B & \xrightarrow{k} & E \\
   \downarrow{n \circ k} & & \downarrow{n} \\
   G & & G \\
   \end{array}
  $$
   是一个拉回图式。

3. **验证拉回条件**：

   - **兼容性条件**：
     - 外部矩形需要满足$p \circ m = n \circ h $。
   
   - **普遍性条件**：
     - 对于任何对象$R$及其态射$r_1 : G \to R$和$r_2 : G \to R$满足：
      $$
       p \circ r_1 = n \circ r_2
      $$
     - 需要存在唯一态射$r : E \to R$使得：
      $$
       r \circ h = r_1 \quad \text{和} \quad r \circ n = r_2
      $$
   
4. **利用内部拉回的普遍性条件**：

   - 由于左方块和右方块都是拉回图式，可以通过组合它们的普遍性条件，推导出外部矩形的普遍性条件。
   
   - 具体来说，拉回的普遍性条件保证了存在唯一态射因子化到外部矩形。

5. **结论**：

   因此，整个外部矩形也是一个拉回图式。

**对最弱前置条件的意义**：

- **条件的组合**：

  在程序验证中，最弱前置条件的组合可以通过拉回的组合性质来实现。即，复杂程序片段的前置条件可以通过组合多个子片段的拉回构造来得到。

- **模块化验证**：

  这种性质允许将程序分解为多个模块，每个模块通过拉回来确定其最弱前置条件，最终组合得到整体程序的最弱前置条件。

**总结**：

通过证明拉回的组合性，可以更高效地处理复杂的程序验证问题，确保条件的传递性和模块化。这增强了程序验证方法的灵活性和可扩展性。

## 本节总结

**和（Sums）** 是范畴论中一种重要的余极限，能够描述多个对象的“合并”关系。和在不同范畴中具有不同的性质，如在集合范畴中和是不相交且普遍的，但在其他范畴中可能不具备这些性质。通过具体例子和命题的证明，我们理解了和的构造方法及其在保持态射性质（如单态性）中的重要作用。

**主要要点**：

1. **不相交和**：
   - 和对象中各组成部分通过初始对象仅在初始对象处相交。
   - 在集合范畴中，通过不相交并集实现。

2. **推前（Pushouts）**：
   - 拉回的对偶概念，用于通过“拼接”两个对象形成新的对象。
   - 在集合范畴中，通过并集和等价关系构造。

3. **补集**：
   - 在集合范畴中，每个子集都有补集。
   - 在更结构化的范畴中，如单半群范畴，补集的存在性受到结构限制。

4. **可计算子集**：
   - 存在可计算集合其补集不可计算，影响程序语义中的条件语句。

5. **普遍和**：
   - 和对象满足普遍性条件，确保和是“最优”的合并对象。
   - 在有限和无限情况下均有不同的定义和性质。

6. **FLS范畴**：
   - 具有有限极限和有限和，且和满足不相交性与普遍性。

7. **一致范畴**：
   - 结合了FLS范畴和正则范畴的性质，对应于正逻辑。

**应用与扩展**：

- **程序验证**：利用和和推前构造最弱前置条件，确保程序在特定条件下的正确性。
- **代数结构研究**：通过和构造复杂的代数对象，如环、模等的合并和商对象。
- **逻辑编程**：利用和描述逻辑规则的合并和推理过程。
- **范畴结构分析**：理解和构造复杂对象间的合并关系，提高范畴论工具的应用能力。

通过掌握和的定义、构造方法及其性质，读者能够更全面地理解范畴论中的极限与余极限概念，并将其应用于各种数学和计算机科学的问题中，为进一步学习和研究打下坚实的理论基础。

### ---------------------------

好的，让我们继续详细解析**第9章：极限与余极限（Limits and Colimits）**中的**9.7节：将统一化视为余等化子（Unification as Coequalizer）**。本节将探讨统一化的概念及其在范畴论中的表达方式，特别是通过余等化子的构造。此外，我们将讨论自由图式（Free Sketches）及其在统一化中的应用，并详细解析相关命题和练习题。

## 9.7 将统一化视为余等化子（Unification as Coequalizer）

### 9.7.1 统一化的例子

**统一化（Unification）**是逻辑和计算机科学中的一个重要概念，特别是在自动定理证明和类型推断中。统一化的目标是找到一种替换（substitution），使得两个表达式通过这种替换后变得相同。如果存在这样的替换，那么称这两个表达式是**可统一的**（unifiable）。在范畴论中，统一化可以通过余等化子的存在来描述。

**例子1**：

考虑一个具有三种类型（sort）的代数结构：$ A $、$ C$和$S $。定义两个运算：
-$m : A \times A \to S $
-$t : C \times C \to A $

假设有以下元素：
-$a, b \in A $
-$u, v, w \in C $

构造以下术语：
$$
\begin{align*}
x_1 &= m(t(u, v), a) \\
y_1 &= m(a, a) \\
x_2 &= m(b, t(u, w)) \\
y_2 &= m(b, a) \\
\end{align*}
$$
所有这些术语的类型均为$S $。现在，我们寻找一种替换，使得通过替换后$x_1 = y_1$且$x_2 = y_2 $。

考虑以下替换：
$$
\begin{align*}
w &\leftarrow v \\
a &\leftarrow t(u, v) \\
\end{align*}
$$
应用此替换后：
$$
\begin{align*}
x'_1 &= m(t(u, v), t(u, v)) = y'_1 = m(t(u, v), t(u, v)) \\
x'_2 &= m(b, t(u, v)) = y'_2 = m(b, t(u, v)) \\
\end{align*}
$$
因此，这种替换使得$x'_1 = y'_1$且$x'_2 = y'_2 $，即完成了统一化。

此外，任何其他导致这些等式成立的替换都可以通过进一步替换（如在此例中进一步替换$a $）来获得。因此，这种替换是最小的统一化替换。

### 9.7.2 自由图式（Free Sketches）

**自由图式（Free Sketch）** 是一种特殊的图式，具有以下特点：
- 它没有图式中的图（diagrams）。
- 任何作为锥（cone）顶点的节点只出现在该锥中。

在这种图式中，节点通常表示为$s_1 \times s_2 \times \cdots \times s_n $，而运算的形式通常为：
$$
f : s_1 \times \cdots \times s_n \to t_1 \times \cdots \times t_m
$$
但我们可以假设任何运算的目标不是积节点。这是因为根据定义5.3.1，一个指向积的函数完全由与其投影的组合函数决定，因此可以将一个指向积的函数替换为多个指向各个积分量的函数。

如果我们有一个基于节点$s_1, \ldots, s_n$且顶点为$s$的锥，则一个带有生成元$x $（类型为$s $）的自由代数包含元素$p_1(x), \ldots, p_n(x) $（类型分别为$s_1, \ldots, s_n $）。显然，它同构于一个由元素$x_1, \ldots, x_n $（类型分别为$s_1, \ldots, s_n $）生成的自由代数。因此，每个自由代数同构于一个基本自由代数，其中所有给定元素的类型不是任何锥的顶点。

**定义**：
- **基本自由代数**：类型不是任何锥的顶点的自由代数。
- **适当术语（Proper Term）**：在自由代数中没有投影的术语。

### 9.7.3 命题：在基本自由代数中，每个元素都有唯一的适当术语表达

**命题9.7.3**：

在一个基本自由代数中，每个元素都有一个唯一的适当术语表达。

**证明**：

由于基本自由代数中每个运算的目标都是基节点，我们可以应用构造7.6.5，仅使用FP–1和FP–3（这些构造步骤确保术语的规范性）。这样，我们构造的术语中不会出现投影，因此每个元素都可以唯一地表示为一个适当术语。

从FP–1出发，构造出的元素在图式的运算下是封闭的；从FP–3出发，积类型的元素是基类型元素的积。因此，这构造是图式的一个模型，因为没有需要的等式，并且是自由的，因为没有任何标识。

**结论**：

因此，在基本自由代数中，每个元素都有一个唯一的适当术语表达。

### 9.7.4 命题：如果$h : F(X) \to F(W)$是一个映射，那么要么存在一个子集$W_0 \subseteq W$使得$h$因式分解，或者$h$是范畴$\mathcal{C}$中的一个上同态（epimorphism）。

**命题9.7.4**：

设$h : F(X) \to F(W)$是一个映射在$\mathcal{C}$中，则：
- 要么存在一个子集$W_0 \subseteq W $，使得$h$因式分解通过$W_0 $；
- 要么$h$是范畴$\mathcal{C}$中的一个上同态。

**证明**：

**目标**：

证明$h$满足上述条件。

**证明步骤**：

1. **假设**：

   设$F(X)$和$F(W)$是基本自由代数。对于每个$x \in X $，$ h(x)$要么是一个元素$w \in W $，要么是一个形如$f(u_1, \ldots, u_n)$的术语，其中$f$是图式中的一个非投影运算，且$u_1, \ldots, u_n$是比$f(u_1, \ldots, u_n)$更简单的术语。

2. **定义参与性**：

   如果$w \in W$被包含在某个$h(x)$中，则称$w$**参与**了$h(x) $。具体来说：
   - 如果$h(x) = w $，则$w$参与了$h(x) $。
   - 如果$h(x) = f(u_1, \ldots, u_n) $，则$u_1, \ldots, u_n$中的每个元素如果包含某个$w $，则$w$参与了$h(x) $。

3. **检查$W$中元素的参与性**：

   如果存在某个$w \in W$不参与任何$h(x) $，则可以选择$W_0 \subseteq W$只包含参与的元素，从而使得$h$因式分解通过$W_0 $。

4. **假设所有$w \in W$都参与了$h(x)$对于某个$x \in X $**：

   现在假设$h$不是因式分解通过任何子集$W_0 \subseteq W $，那么根据命题，需要证明$h$是一个上同态。

5. **构造$k \neq l : F(W) \to F(T) $**：

   假设存在两个不同的映射$k$和$l$满足$k \circ h = l \circ h $，需要证明$k = l $。

   - 由于$k \neq l $，存在某个$w \in W$使得$k(w) \neq l(w) $。
   - 对于运算$f $，有：
    $$
     k(f(u_1, \ldots, u_n)) = f(k(u_1), \ldots, k(u_n)) \neq f(l(u_1), \ldots, l(u_n)) = l(f(u_1, \ldots, u_n))
    $$
   - 因此，$ k \circ h \neq l \circ h $，这与假设$k \circ h = l \circ h$矛盾。

6. **结论**：

   因此，$ h$必须是一个上同态。

**总结**：

命题9.7.4说明了在基本自由代数中，映射要么可以通过某个子集因式分解，要么就是一个上同态。这为理解统一化如何通过余等化子来实现提供了基础。

### 9.7.5 定理：统一化存在性（Theorem 9.7.5）

**定理9.7.5**：

设$S$是一个自由FP图式（Free FP Sketch），且$C$是$S$在集合范畴$\text{Set}$中模型的全子范畴。假设$X $、$ Y $、$ Z$是由$S$的对象类型定义的有限集合。若存在一个图式：
$$
\begin{array}{ccc}
F(X) & \rightrightarrows^{d_0}_{d_1} & F(Y) \\
& & \downarrow^{d} \\
& & F(Z) \\
\end{array}
\quad \text{（图式9.13）}
$$
且满足$d \circ d_0 = d \circ d_1 $，则态射$d_0$和$d_1$在$C$中存在余等化子（coequalizer），且该余等化子也是一个自由代数。

**证明概要**：

证明基于[Rydeheard and Burstall, 1985]的构造，利用自由代数的性质和拉回、余等化子的构造方法。证明采用双重归纳法：
1. **第一层归纳**：基于态射的复杂度。
2. **第二层归纳**：基于生成元集合$X$的元素数量。

**具体步骤**：

1. **基础情况**：$ X$包含一个元素。
   - 构造一个子集$W$并定义态射$e_0, e_1 : F(W) \to F(Y) $，使得它们对应于统一化替换。
   - 利用命题9.7.3和命题9.7.4，证明存在一个余等化子。

2. **归纳步骤**：假设对于少于$n+1$个元素的$X $，余等化子存在。
   - 选取一个元素$x \in X $，构造包含该元素的子图式。
   - 使用归纳假设，证明包含$n+1$个元素的$X$的余等化子存在。

3. **结论**：

   通过双重归纳法，证明了对于任意有限集合$X $，统一化的余等化子存在且是自由代数。

**总结**：

定理9.7.5证明了在自由FP图式下，统一化可以通过余等化子的存在来实现。这为逻辑和计算机科学中的统一化问题提供了范畴论的理论基础。

### 9.7.6 练习题（Exercises）

根据原文，9.7.6包含以下练习题：

**练习1**：

**题目**：

在任何范畴中，如果有如下图式：
$$
\begin{array}{ccc}
A & \rightrightarrows^{f}_{g} & B \\
c \downarrow & & \downarrow \\
C & \xrightarrow{h} & D \\
\end{array}
$$
且$h \circ c = h \circ d$是一个余等化子图式，并且$e : D \to E$是一个上同态，那么证明：
$$
\begin{array}{ccc}
A & \rightrightarrows^{f \circ e}_{g \circ e} & B \\
c \downarrow & & \downarrow \\
C & \xrightarrow{h} & D \\
\end{array}
$$
也是一个余等化子图式。

**解析**：

**目标**：

证明如果原图式是余等化子，并且$e : D \to E$是上同态，那么$e \circ h : C \to E$也是余等化子。

**证明步骤**：

1. **设定**：

   - 原图式：
    $$
     \begin{array}{ccc}
     A & \rightrightarrows^{f}_{g} & B \\
     c \downarrow & & \downarrow \\
     C & \xrightarrow{h} & D \\
     \end{array}
    $$
     是一个余等化子图式，满足$h \circ f = h \circ g $。
   
   - 上同态$e : D \to E $。

2. **构造新图式**：

   - 新图式：
    $$
     \begin{array}{ccc}
     A & \rightrightarrows^{f \circ e}_{g \circ e} & B \\
     c \downarrow & & \downarrow \\
     C & \xrightarrow{h \circ e} & E \\
     \end{array}
    $$
   
   - 需要证明新图式满足余等化子的定义。

3. **验证兼容性条件**：

   - 原条件$h \circ f = h \circ g$经过$e$的作用，得到：
    $$
     e \circ h \circ f = e \circ h \circ g
    $$
     即：
    $$
     (h \circ e) \circ f = (h \circ e) \circ g
    $$
     因此，新图式满足兼容性条件。

4. **验证普遍性条件**：

   - 假设存在态射$k : B \to F$使得：
    $$
     k \circ (f \circ e) = k \circ (g \circ e)
    $$
     即：
    $$
     k \circ f \circ e = k \circ g \circ e
    $$
   
   - 由于$e$是上同态，存在唯一的态射$l : D \to F$使得：
    $$
     l \circ e = k
    $$
   
   - 因为原图式是余等化子，存在唯一的态射$m : C \to D$使得：
    $$
     m \circ c = f \quad \text{和} \quad m \circ c = g
    $$
   
   - 因此，存在唯一的态射$m' : C \to E$使得：
    $$
     m' = e \circ m
    $$
   
   - 满足：
    $$
     m' \circ c = e \circ m \circ c = e \circ f = f \circ e
    $$
    $$
     m' \circ c = e \circ m \circ c = e \circ g = g \circ e
    $$
   
   - 因此，存在唯一态射$m'$使得$m' \circ c = f \circ e$且$m' \circ c = g \circ e $。

5. **结论**：

   因此，新图式也是一个余等化子图式。

**总结**：

通过证明，若原图式是余等化子且$e$是上同态，则经过$e$作用后的新图式仍然是余等化子图式。

---

**练习2**：

**题目**：

在任何具有和的范畴中，如果对于$i = 1, 2 $，态射对：
$$
\begin{array}{ccc}
A_i & \rightrightarrows^{f_i}_{g_i} & B_i \\
c_i \downarrow & & \downarrow \\
C_i & \xrightarrow{h_i} & D_i \\
\end{array}
$$
都是余等化子图式，那么态射对：
$$
\begin{array}{ccc}
A_1 + A_2 & \rightrightarrows^{f_1 + f_2}_{g_1 + g_2} & B_1 + B_2 \\
c_1 + c_2 \downarrow & & \downarrow \\
C_1 + C_2 & \xrightarrow{h_1 + h_2} & D_1 + D_2 \\
\end{array}
$$
也是余等化子图式。

**解析**：

**目标**：

证明在具有和的范畴中，如果每对$A_i \rightrightarrows B_i$的态射对都是余等化子，则它们的和态射对也是余等化子。

**证明步骤**：

1. **设定**：

   - 对于$i = 1, 2 $，图式：
    $$
     \begin{array}{ccc}
     A_i & \rightrightarrows^{f_i}_{g_i} & B_i \\
     c_i \downarrow & & \downarrow \\
     C_i & \xrightarrow{h_i} & D_i \\
     \end{array}
    $$
     是余等化子图式。
   
   - 和态射对：
    $$
     \begin{array}{ccc}
     A_1 + A_2 & \rightrightarrows^{f_1 + f_2}_{g_1 + g_2} & B_1 + B_2 \\
     c_1 + c_2 \downarrow & & \downarrow \\
     C_1 + C_2 & \xrightarrow{h_1 + h_2} & D_1 + D_2 \\
     \end{array}
    $$
   
2. **验证兼容性条件**：

   - 因为每个$h_i \circ f_i = h_i \circ g_i $，所以：
    $$
     (h_1 + h_2) \circ (f_1 + f_2) = h_1 \circ f_1 + h_2 \circ f_2 = h_1 \circ g_1 + h_2 \circ g_2 = (h_1 + h_2) \circ (g_1 + g_2)
    $$
     因此，和态射对满足兼容性条件。

3. **验证普遍性条件**：

   - 设存在态射$k : B_1 + B_2 \to E$使得：
    $$
     k \circ (f_1 + f_2) = k \circ (g_1 + g_2)
    $$
   
   - 由于$A_1 + A_2$和$B_1 + B_2$是和对象，存在唯一态射$k_1 : B_1 \to E$和$k_2 : B_2 \to E$使得：
    $$
     k \circ i_1 = k_1 \quad \text{和} \quad k \circ i_2 = k_2
    $$
     其中$i_1 : B_1 \to B_1 + B_2$和$i_2 : B_2 \to B_1 + B_2$是规范注入态射。
   
   - 由于每个图式是余等化子，有唯一态射$m_i : C_i \to D_i$使得：
    $$
     m_i \circ c_i = f_i \quad \text{和} \quad m_i \circ c_i = g_i
    $$
   
   - 定义态射$m = m_1 + m_2 : C_1 + C_2 \to D_1 + D_2 $，满足：
    $$
     m \circ (c_1 + c_2) = f_1 + f_2 = g_1 + g_2
    $$
   
   - 由于和态射对满足兼容性条件，存在唯一的态射$l : D_1 + D_2 \to E$使得：
    $$
     l \circ (h_1 + h_2) = k
    $$
   
4. **结论**：

   因此，和态射对也是余等化子图式。

**总结**：

在具有和的范畴中，余等化子图式的和态射对仍然是余等化子图式。这展示了余等化子的封闭性在和运算下的稳定性。

---

**练习3**：

**题目**：

设$d_0, d_1 : A_1 + A_2 \to B$是一对平行态射，且$u_i : A_i \to A_1 + A_2$是和的规范注射。若$e : B \to C$是$d_0 \circ u_1$和$d_1 \circ u_1$的余等化子，且$c : C \to D$是$e \circ d_0 \circ u_2$和$e \circ d_1 \circ u_2$的余等化子，则证明$c \circ e : B \to D$是$d_0$和$d_1$的余等化子。

**解析**：

**目标**：

证明复合态射$c \circ e : B \to D$是$d_0$和$d_1$的余等化子。

**证明步骤**：

1. **设定**：

   -$d_0, d_1 : A_1 + A_2 \to B$是一对平行态射。
   -$u_i : A_i \to A_1 + A_2$是和的规范注射。
   -$e : B \to C$是$d_0 \circ u_1$和$d_1 \circ u_1$的余等化子。
   -$c : C \to D$是$e \circ d_0 \circ u_2$和$e \circ d_1 \circ u_2$的余等化子。

2. **构造余等化子**：

   - 需要证明$c \circ e : B \to D$满足：
    $$
     c \circ e \circ d_0 = c \circ e \circ d_1
    $$
   
   - 由于$e$是$d_0 \circ u_1$和$d_1 \circ u_1$的余等化子，有：
    $$
     e \circ d_0 \circ u_1 = e \circ d_1 \circ u_1
    $$
   
   - 由于$c$是$e \circ d_0 \circ u_2$和$e \circ d_1 \circ u_2$的余等化子，有：
    $$
     c \circ e \circ d_0 \circ u_2 = c \circ e \circ d_1 \circ u_2
    $$
   
   - 因此，$ c \circ e$满足兼容性条件。

3. **验证普遍性条件**：

   - 设$k : B \to E$是一个态射，使得：
    $$
     k \circ d_0 = k \circ d_1
    $$
   
   - 由于$e$是$d_0 \circ u_1$和$d_1 \circ u_1$的余等化子，存在唯一态射$l : C \to E$使得：
    $$
     l \circ e = k
    $$
   
   - 进一步，由于$c$是$e \circ d_0 \circ u_2$和$e \circ d_1 \circ u_2$的余等化子，存在唯一态射$m : D \to E$使得：
    $$
     m \circ c = l
    $$
   
   - 因此，$ m \circ c \circ e = l \circ e = k $，即存在唯一态射$m \circ c : D \to E$使得：
    $$
     (m \circ c) \circ (c \circ e) = k
    $$
   
   - 因此，$ c \circ e$满足普遍性条件。

4. **结论**：

   因此，$ c \circ e : B \to D$是$d_0$和$d_1$的余等化子。

**总结**：

通过分步构造和利用已有的余等化子，证明了复合态射$c \circ e$也是一对平行态射$d_0$和$d_1$的余等化子。这展示了余等化子在和运算下的传递性和组合性。

## 本节总结

**统一化作为余等化子** 展示了逻辑和计算机科学中的重要概念如何通过范畴论中的余等化子来形式化和实现。通过具体的例子和命题证明，我们理解了统一化的结构及其在自由图式下的表现方式。

**主要要点**：

1. **统一化**：
   - 统一化寻找一种替换，使得两个表达式通过替换后相同。
   - 在范畴论中，统一化可以通过余等化子的存在来描述。

2. **自由图式**：
   - 自由图式没有图式中的图（diagrams），并且任何作为锥顶的节点只出现在该锥中。
   - 自由代数中的元素可以唯一地表示为适当术语。

3. **余等化子的性质**：
   - 余等化子满足兼容性条件和普遍性条件。
   - 在和运算下，余等化子具有封闭性。

4. **统一化与余等化子的关系**：
   - 统一化可以视为将一对平行态射的余等化子，用于找到最小的统一替换。

**应用与扩展**：

- **自动定理证明**：通过统一化来匹配和合并不同的逻辑表达式。
- **类型推断**：在编程语言中，通过统一化推断变量的类型。
- **范畴论中的逻辑**：统一化作为逻辑中的一个基本操作，可以通过范畴论工具进行分析和推广。
- **程序验证**：利用余等化子的性质确保程序中的条件和操作的一致性。

通过掌握统一化作为余等化子的表达方式，读者能够更深入地理解逻辑、代数结构以及计算机科学中的核心概念，并将其应用于更广泛的数学和理论计算机科学问题中。

### ----------------------------



### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------