[toc]



### **第13章 剪切消除（Hauptsatz）**

#### **引言**

**Gentzen 定理**是逻辑学中最重要的定理之一，它与自然演绎中的规范化紧密相关，后者在很大程度上受其启发。这个定理的变体构成了诸如 **PROLOG** 等语言的基础。换句话说，这是一个每个人都应该至少见证一次其证明的结果。然而，这个证明非常精细且复杂。因此，我们将首先指出需要理解的关键情况。随后，我们将详细展开证明的细节。

---

### **13.1 关键情况**

**目标**：消除特殊形式的剪切（Cut），即在剪切规则中，左前提是一个**右逻辑规则**，右前提是一个**左逻辑规则**，并且两者都引入了公式 $C$ 的主要符号。

**一般形式的剪切规则**：

$$
\frac{A \vdash C, B \quad A' , C \vdash B'}{\text{Cut}} \quad A, A' \vdash B, B'
$$

- **解释**：$A \vdash C, B$ 是左前提，$A', C \vdash B'$ 是右前提，我们希望消除中间的公式 $C$。

**关键情况揭示了逻辑规则的深层对称性**，这些规则彼此精确匹配。

以下是需要重点理解的关键情况：

---

#### **1. $R\wedge$ 和 $L1\wedge$**

- **规则形式**：

  - **右合取引入（$R\wedge$）**：
    $$
    \frac{A \vdash C, B \quad A' \vdash D, B'}{R\wedge} \quad A, A' \vdash C \wedge D, B, B'
    $$
  
  - **左合取消解（$L1\wedge$）**：
    $$
    \frac{A'', C \vdash B''}{L1\wedge} \quad A'', C \wedge D \vdash B''
    $$
  
  - **剪切**：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$

- **替换方式**：

  - 通过消除剪切，我们可以得到新的推导：
    $$
    \frac{A \vdash C, B \quad A'', C \vdash B''}{\text{Cut}} \quad A, A'' \vdash B, B''
    $$
  
  - 然后，通过结构规则（如弱化和交换），得到：
    $$
    A, A', A'' \vdash B, B', B''
    $$

- **解释**：

  - 我们首先对 $A \vdash C, B$ 和 $A'', C \vdash B''$ 应用剪切，消除中间的 $C$，得到 $A, A'' \vdash B, B''$。
  
  - 然后，通过结构规则，将 $A'$ 和 $B'$ 加入到序列中。

---

#### **2. $R\wedge$ 和 $L2\wedge$**

- **规则形式**：

  - **右合取引入（$R\wedge$）**：
    $$
    \frac{A \vdash C, B \quad A' \vdash D, B'}{R\wedge} \quad A, A' \vdash C \wedge D, B, B'
    $$
  
  - **左合取消解（$L2\wedge$）**：
    $$
    \frac{A'', D \vdash B''}{L2\wedge} \quad A'', C \wedge D \vdash B''
    $$
  
  - **剪切**：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$

- **替换方式**：

  - 对 $A' \vdash D, B'$ 和 $A'', D \vdash B''$ 应用剪切，得到：
    $$
    \frac{A', A'' \vdash B', B''}{\text{Cut}}
    $$
  
  - 然后，通过结构规则，得到：
    $$
    A, A', A'' \vdash B, B', B''
    $$

- **解释**：

  - 类似于情况1，但这里消除的是 $D$。

---

#### **3. $R1\vee$ 和 $L\vee$**

- **规则形式**：

  - **右析取引入1（$R1\vee$）**：
    $$
    \frac{A \vdash C, B}{R1\vee} \quad A \vdash C \vee D, B
    $$
  
  - **左析取消解（$L\vee$）**：
    $$
    \frac{A', C \vdash B' \quad A'', D \vdash B''}{L\vee} \quad A', A'', C \vee D \vdash B', B''
    $$
  
  - **剪切**：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$

- **替换方式**：

  - 对 $A \vdash C, B$ 和 $A', C \vdash B'$ 应用剪切，得到：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$
  
  - 然后，通过结构规则，得到：
    $$
    A, A', A'' \vdash B, B', B''
    $$

- **解释**：

  - 这是情况1的对偶，针对析取的情况。

---

#### **4. $R2\vee$ 和 $L\vee$**

- **规则形式**：

  - **右析取引入2（$R2\vee$）**：
    $$
    \frac{A \vdash D, B}{R2\vee} \quad A \vdash C \vee D, B
    $$
  
  - **左析取消解（$L\vee$）**：
    $$
    \frac{A', C \vdash B' \quad A'', D \vdash B''}{L\vee} \quad A', A'', C \vee D \vdash B', B''
    $$
  
  - **剪切**：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$

- **替换方式**：

  - 对 $A \vdash D, B$ 和 $A'', D \vdash B''$ 应用剪切，得到：
    $$
    \frac{A, A'' \vdash B, B''}{\text{Cut}}
    $$
  
  - 然后，通过结构规则，得到：
    $$
    A, A', A'' \vdash B, B', B''
    $$

- **解释**：

  - 这是情况2的对偶。

---

#### **5. $R\lnot$ 和 $L\lnot$**

- **规则形式**：

  - **右否定引入（$R\lnot$）**：
    $$
    \frac{A, C \vdash B}{R\lnot} \quad A \vdash \lnot C, B
    $$
  
  - **左否定消解（$L\lnot$）**：
    $$
    \frac{A' \vdash C, B'}{L\lnot} \quad A', \lnot C \vdash B'
    $$
  
  - **剪切**：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$

- **替换方式**：

  - 注意这里的交换：
    $$
    \frac{A' \vdash C, B' \quad A, C \vdash B}{\text{Cut}} \quad A', A \vdash B', B
    $$

- **解释**：

  - 剪切时，我们将 $C$ 从一个前提的右边移动到另一个前提的左边，体现了否定的对偶性质。

---

#### **6. $R\Rightarrow$ 和 $L\Rightarrow$**

- **规则形式**：

  - **右蕴涵引入（$R\Rightarrow$）**：
    $$
    \frac{A, C \vdash D, B}{R\Rightarrow} \quad A \vdash C \Rightarrow D, B
    $$
  
  - **左蕴涵消解（$L\Rightarrow$）**：
    $$
    \frac{A' \vdash C, B' \quad A'', D \vdash B''}{L\Rightarrow} \quad A', A'', C \Rightarrow D \vdash B', B''
    $$
  
  - **剪切**：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$

- **替换方式**：

  - 首先，对 $A' \vdash C, B'$ 和 $A, C \vdash D, B$ 应用剪切，得到：
    $$
    \frac{A', A \vdash D, B', B}{\text{Cut}}
    $$
  
  - 然后，对 $A', A \vdash D, B', B$ 和 $A'', D \vdash B''$ 再次应用剪切，得到：
    $$
    \frac{A, A', A'' \vdash B, B', B''}{\text{Cut}}
    $$
  
  - **注意**：这里需要两个剪切步骤。

- **解释**：

  - 蕴涵的剪切消除需要两个步骤，因为需要处理前提和结论中的 $C$ 和 $D$。

---

#### **7. $R\forall$ 和 $L\forall$**

- **规则形式**：

  - **右全称量化引入（$R\forall$）**：
    $$
    \frac{A \vdash C, B}{R\forall} \quad A \vdash \forall \xi . C, B
    $$
  
  - **左全称量化消解（$L\forall$）**：
    $$
    \frac{A', C[a/\xi] \vdash B'}{L\forall} \quad A', \forall \xi . C \vdash B'
    $$
  
  - **剪切**：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$

- **替换方式**：

  - 将 $A \vdash C[a/\xi], B$ 和 $A', C[a/\xi] \vdash B'$ 进行剪切，得到：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$

- **解释**：

  - 在左前提中，将 $\xi$ 替换为 $a$，以便匹配右前提中的 $C$。

---

#### **8. $R\exists$ 和 $L\exists$**

- **规则形式**：

  - **右存在量化引入（$R\exists$）**：
    $$
    \frac{A \vdash C[a/\xi], B}{R\exists} \quad A \vdash \exists \xi . C, B
    $$
  
  - **左存在量化消解（$L\exists$）**：
    $$
    \frac{A', C \vdash B'}{L\exists} \quad A', \exists \xi . C \vdash B'
    $$
  
  - **剪切**：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$

- **替换方式**：

  - 将 $A \vdash C[a/\xi], B$ 和 $A', C[a/\xi] \vdash B'$ 进行剪切，得到：
    $$
    \frac{A, A' \vdash B, B'}{\text{Cut}}
    $$

- **解释**：

  - 这是情况7的对偶，处理存在量化的情况。

---

### **13.2 主要引理**

**定义**：公式 $A$ 的**度数**（degree），记为 $\partial(A)$，定义如下：

- **原子公式**：$\partial(A) = 1$。

- **合取、析取、蕴涵**：$\partial(A \wedge B) = \partial(A \vee B) = \partial(A \Rightarrow B) = \max(\partial(A), \partial(B)) + 1$。

- **否定、全称量化、存在量化**：$\partial(\lnot A) = \partial(\forall \xi . A) = \partial(\exists \xi . A) = \partial(A) + 1$。

- **注意**：替换不改变度数，即 $\partial(A[a/\xi]) = \partial(A)$。

**剪切规则的度数**：定义为它所消除的公式的度数。

**观察**：在前面讨论的关键情况下，剪切被替换为度数更低的剪切。

**证明的度数**：一个证明 $\pi$ 的度数 $d(\pi)$，定义为其所有剪切规则的度数的上确界。因此，$d(\pi) = 0$ 当且仅当 $\pi$ 是无剪切的。

**证明的高度**：证明 $\pi$ 的高度 $h(\pi)$，是其对应树的高度。若 $\pi$ 以规则 $r$ 结束，其前提由 $\pi_1, \dots, \pi_n$（$n = 0, 1, 2$）证明，则 $h(\pi) = \max(h(\pi_i)) + 1$。

---

#### **主要引理的陈述**

**引理**：设 $C$ 是度数为 $d$ 的公式，$\pi$ 和 $\pi'$ 是证明 $A \vdash B$ 和 $A' \vdash B'$ 的证明，其度数均小于 $d$。那么，我们可以构造一个证明 $\$$(注意：这里的 $\$$ 是新的证明的符号）$，它证明 $A, A' - C \vdash B - C, B'$，且度数小于 $d$。

- **解释**：

  - $A' - C$ 表示从序列 $A'$ 中删除所有 $C$ 的出现。

  - 同样地，$B - C$ 表示从 $B$ 中删除所有 $C$。

---

#### **证明思路**

**构造 $\$ $ 的方法**：对 $h(\pi) + h(\pi')$ 进行归纳，但这个归纳并非对称的。在某些阶段，可能会优先考虑 $\pi$ 或 $\pi'$，并且这种选择会对 $\$ $ 产生不可逆转的影响。

**为了简化**，我们假设在 $A' - C$ 和 $B - C$ 中，我们已经删除了所有 $C$ 的出现。这使得我们的表述更加简洁，而不影响证明的本质。

---

#### **情况分析**

令 $\pi$ 的最后一个规则为 $r$，其前提由 $\pi_i$ 证明。同样，$\pi'$ 的最后一个规则为 $r'$，其前提由 $\pi'_j$ 证明。我们需要考虑以下几种情况：

---

**1. $\pi$ 是一个公理**

- **两种子情况**：

  - **$\pi$ 证明 $C \vdash C$**：则从 $\pi'$ 通过结构规则，可以得到一个证明 $\$ $，证明 $C, A' - C \vdash B'$。

  - **$\pi$ 证明 $D \vdash D$（$D \neq C$）**：则从 $\pi$ 通过结构规则，可以得到一个证明 $\$ $，证明 $D, A' - C \vdash D, B'$。

---

**2. $\pi'$ 是一个公理**

- **处理方式**：与情况1类似，但需要注意，如果 $\pi$ 和 $\pi'$ 都是公理，我们可能会任意地优先考虑 $\pi$。

---

**3. $r$ 是一个结构规则**

- **处理方式**：

  - 对 $\pi_1$ 和 $\pi'$ 应用归纳假设，得到一个证明 $\$ _1$，证明 $A_1, A' - C \vdash B_1 - C, B'$。

  - 然后，通过对 $\$ _1$ 应用结构规则，得到 $\$ $。

  - **注意**：如果 $\pi$ 的最后一个规则是对 $C$ 的收缩（$RC$），那么在 $B_1$ 中可能会有比 $B$ 中更多的 $C$ 出现。

---

**4. $r'$ 是一个结构规则**

- **处理方式**：与情况3的对偶。

---

**5. $r$ 是一个逻辑规则，且不是以 $C$ 为主公式的右规则**

- **处理方式**：

  - 对每个 $\pi_i$ 和 $\pi'$ 应用归纳假设，得到证明 $\$ _i$，证明 $A_i, A' - C \vdash B_i - C, B'$。

  - 将相同的规则 $r$ 应用于 $\$ _i$，因为 $r$ 不会在右侧引入新的 $C$，因此得到一个证明 $\$ $，证明 $A, A' - C \vdash B - C, B'$。

---

**6. $r'$ 是一个逻辑规则，且不是以 $C$ 为主公式的左规则**

- **处理方式**：与情况5的对偶。

---

**7. $r$ 和 $r'$ 都是逻辑规则，$r$ 是以 $C$ 为主公式的右规则，$r'$ 是以 $C$ 为主公式的左规则**

- **这是唯一重要的情况，也是对称的。**

- **处理步骤**：

  1. 对每个 $\pi_i$ 和 $\pi'$ 应用归纳假设，得到证明 $\$ _i$，证明 $A_i, A' - C \vdash B_i - C, B'$。

  2. 对 $\pi$ 和每个 $\pi'_j$ 应用归纳假设，得到证明 $\$ '_j$，证明 $A, A'_j - C \vdash B - C, B'_j$。

  3. 对 $\$ _i$ 应用规则 $r$（以及必要的结构规则），得到一个证明 $\rho$，证明 $A, A' - C \vdash C, B - C, B'$。

  4. 对 $\$ '_j$ 应用规则 $r'$（以及必要的结构规则），得到一个证明 $\rho'$，证明 $A, A' - C, C \vdash B - C, B'$。

  5. 现在，我们有两个证明，其中一个的右侧结论多了一个 $C$，另一个的左侧前提多了一个 $C$。

  6. 使用剪切规则，我们可以将它们合并，但剪切的度数是 $d$，这太高了。

  7. **关键点**：这是之前提到的关键情况之一，因此我们可以用度数小于 $d$ 的剪切来替换。

  8. 最后，通过结构规则的调整，得到证明 $\$ $。

---

### **13.3 Hauptsatz（主要定理）**

#### **命题**

**陈述**：如果 $\pi$ 是一个度数为 $d > 0$ 的证明序列，那么可以构造一个度数更低的同一序列的证明 $\$ $。

---

#### **证明**

**归纳基础**：对 $h(\pi)$ 进行归纳。

**情况分析**：

1. **$\pi$ 的最后一个规则 $r$ 不是度数为 $d$ 的剪切**：

   - 根据归纳假设，对 $\pi$ 的子证明 $\pi_i$，可以得到度数小于 $d$ 的证明 $\$ _i$。

   - 将规则 $r$ 应用于 $\$ _i$，得到证明 $\$ $。

2. **$\pi$ 的最后一个规则 $r$ 是度数为 $d$ 的剪切**：

   - 设剪切形式为：
     $$
     \frac{A \vdash C, B \quad A', C \vdash B'}{\text{Cut}} \quad A, A' \vdash B, B'
     $$
   
   - 根据归纳假设，可以得到度数小于 $d$ 的证明 $\$ _i$。

   - 应用**主要引理**，得到度数小于 $d$ 的证明 $\$ $，证明 $A, A' \vdash B, B'$。

---

#### **结论**

通过迭代上述命题，我们得到：

**定理（Gentzen，1934）**：在序列演算中，剪切规则是多余的。

---

#### **复杂度分析**

**注意**：剪切消除过程会显著增加证明的高度。

- **主要引理的复杂度**：线性的。剪切的消除至多将高度乘以一个常数（例如 $k = 4$）。

- **命题的复杂度**：指数级的。度数减少1，证明的高度可能从 $h$ 增加到 $4h$。

- **总体复杂度**：超级指数级的。一个高度为 $h$、度数为 $d$ 的证明，经过剪切消除，可能变成高度为 $H(d, h)$ 的证明，其中：
  $$
  H(0, h) = h \\
  H(d+1, h) = 4^{H(d, h)}
  $$

- **结论**：尽管剪切消除是有效的算法，但在一般情况下，其复杂度过高，难以实际应用。

---

### **13.4 归结（Resolution）**

**背景**：Gentzen 的结果并未涉及具有非平凡公理的情况。然而，通过仔细检查证明，我们可以发现，唯一无法消除剪切的情况是其中一个前提是公理的情况，需要通过替换来扩展公理。

---

#### **应用于 PROLOG**

- **公理的形式**：非常特殊，称为**原子直觉序列**（或 **Horn 子句**），形式为 $A \vdash B$。

- **目标**：证明目标（goal），即形式为 $\vdash B$ 的原子序列。

- **可用规则**：

  - 通过替换得到的公理 $A \vdash B$。

  - 身份公理 $A \vdash A$，其中 $A$ 是原子公式。

  - 剪切规则。

  - 结构规则。

- **注意**：收缩和弱化规则是多余的。

---

#### **引理**

**陈述**：如果原子序列 $A \vdash B$ 可以使用上述规则证明，那么存在一个直觉序列 $A' \vdash B'$，可以在不使用弱化或收缩的情况下证明，且：

- $A'$ 由 $A$ 的公式构成。

- $B'$ 在 $B$ 中。

---

#### **证明思路**

**对证明 $\pi$ 进行归纳**：

1. **$\pi$ 是公理**：结论立即成立。

2. **$\pi$ 以结构规则结束**：对 $\pi$ 的前提应用归纳假设。

3. **$\pi$ 以剪切结束**：

   - 形式为：
     $$
     \frac{A_1 \vdash C, B_1 \quad A_2 , C \vdash B_2}{\text{Cut}} \quad A_1 , A_2 \vdash B_1 , B_2
     $$

   - 根据归纳假设，得到 $A'_1 \vdash B'_1$ 和 $A'_2 \vdash B'_2$。

   - 两种情况：

     - **$B'_1 \neq C$**：取 $A' = A'_1$，$B' = B'_1$。

     - **$B'_1 = C$**：通过交换和 $n$ 次剪切（$C$ 在 $A_2$ 中出现 $n$ 次），得到结果 $A' = A'_1, \dots, A'_1, A'_2 - C$，$B' = B'_2$。

---

#### **结论**

- **应用于目标**：对于目标 $\vdash B$，$A'$ 为空，$B' = B$。

- **注意**：推导必然在直觉片段中。

- **剪切的优化**：可以通过调整剪切的应用顺序来消除交换。此外，与身份公理的剪切是无用的。

---

#### **命题**

**陈述**：为了证明一个目标，我们只需要使用与公理的实例（通过替换）进行剪切。

---

#### **罗宾逊的归结方法**

- **概述**：罗宾逊的归结方法（1965）为找到这样的证明提供了一种合理的策略。

- **核心思想**：尝试所有可能的剪切和替换组合，替换受限于**统一（unification）**。

- **进一步探讨**：超出了本章范围。

---

### **总结**

- 本章探讨了 **Gentzen** 的剪切消除定理，展示了如何通过消除剪切规则来简化证明。

- **关键情况**：重点分析了剪切消除的关键情况，揭示了逻辑规则之间的对称性。

- **主要引理**：提供了在剪切度数降低的情况下，构造新证明的方法。

- **主要定理（Hauptsatz）**：证明了在序列演算中，剪切规则是多余的，可以被消除。

- **复杂度**：剪切消除过程的复杂度可能非常高，限制了其实用性。

- **应用**：讨论了剪切消除在 PROLOG 等逻辑编程语言中的应用，以及罗宾逊的归结方法。

---

### **后续展望**

- **深入理解逻辑推理**：剪切消除的重要性在于它提供了一种简化逻辑推理的机制，有助于我们更好地理解逻辑系统的性质。

- **逻辑编程的应用**：在逻辑编程中，剪切消除和归结方法是核心技术，可以进一步研究它们的优化和应用。

- **复杂度研究**：对于剪切消除过程的复杂度，可以尝试寻找更高效的算法或限制其应用范围，以提高实用性。

---

如果您对本章的内容有任何疑问，或者需要进一步的解释和详细讲解，请随时提出来！

### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------



### ---------------------------



### ----------------------------