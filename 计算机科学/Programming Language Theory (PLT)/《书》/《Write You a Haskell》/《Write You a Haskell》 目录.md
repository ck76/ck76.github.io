《Write You a Haskell》

https://smunix.github.io/dev.stephendiehl.com/fun/index-2.html

https://github.com/JKTKops/Write-You-a-Haskell-2

https://github.com/JKTKops/Write-You-a-Haskell-2?tab=readme-ov-file







![](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTwY-fETLOxr1PyEIe-OcST4eQjsUIzf-Dslw&s)



**目录 Contents**

------

**第1章 介绍** (Chapter 1: Introduction)

1.1 目标 (Goals) ............................................................... 7
 1.2 前提条件 (Prerequisites) ..................................................... 7

------

**第2章 Haskell基础** (Chapter 2: Haskell Basics)

2.1 函数 (Functions) ............................................................ 15
 2.2 数据类型 (Datatypes) ......................................................... 16
 2.3 值 (Values) ................................................................. 16
 2.4 模式匹配 (Pattern matching) ................................................ 17
 2.5 递归 (Recursion) ............................................................ 18
 2.6 惰性求值 (Laziness) ........................................................ 19
 2.7 高阶种类类型 (Higher-Kinded Types) ........................................ 20
 2.8 类型类 (Typeclasses) ........................................................ 20
 2.9 操作符 (Operators) .......................................................... 21
 2.10 单子 (Monads) ............................................................. 21
 2.11 应用子 (Applicatives) ......................................................... 23
 2.12 单类 (Monoids) ............................................................. 23
 2.13 派生 (Deriving) ............................................................. 24
 2.14 IO操作 (IO) ................................................................. 24
 2.15 单子变换器 (Monad Transformers) .......................................... 25

------

**第3章 解析** (Chapter 3: Parsing)

3.1 文本 (Text) ................................................................. 30
 3.2 Cabal 与 Stack ............................................................. 30
 3.3 资源 (Resources) ............................................................ 31
 3.4 解析器组合器 (Parser Combinators) .......................................... 32
 3.5 NanoParsec ................................................................. 32
 3.6 Parsec ................................................................. 38
 3.7 评估 (Evaluation) ............................................................ 41
 3.8 REPL ................................................................. 42
 3.9 健全性 (Soundness) .......................................................... 43
 3.10 完整源码 (Full Source) ...................................................... 44

------

**第4章 λ演算** (Chapter 4: Lambda Calculus)

4.1 SKI组合子 (SKI Combinators) .................................................. 47
 4.2 实现 (Implementation) .......................................................... 47
 4.3 替换 (Substitution) ............................................................. 48
 4.4 转换与等价 (Conversion and Equivalences) .................................... 49
 4.5 归约 (Reduction) ............................................................... 50
 4.6 Let表达式 ................................................................. 51
 4.7 一切皆λ项 (Everything Can Be a λ term) ...................................... 51
 4.8 递归 (Recursion) ............................................................... 52
 4.9 美化打印 (Pretty Printing) ...................................................... 54
 4.10 完整源码 (Full Source) ....................................................... 55

------

**第5章 类型系统** (Chapter 5: Type Systems)

5.1 规则 (Rules) ................................................................. 56
 5.2 类型安全 (Type Safety) .......................................................... 57
 5.3 类型 (Types) ................................................................. 58
 5.4 小步语义 (Small-Step Semantics) ............................................ 59
 5.5 观察 (Observations) ............................................................. 63
 5.6 简单类型λ演算 (Simply Typed Lambda Calculus) ............................. 64
 5.7 类型检查器 (Type Checker) ....................................................... 64
 5.8 评估 (Evaluation) ............................................................. 67
 5.9 观察 (Observations) ............................................................. 67
 5.10 符号参考 (Notation Reference) .............................................. 68
 5.11 完整源码 (Full Source) ....................................................... 69

------

**第6章 评估** (Chapter 6: Evaluation)

6.1 评估模型 (Evaluation Models) .................................................. 70
 6.2 按值调用 (Call-by-value) ......................................................... 71
 6.3 按名调用 (Call-by-name) .......................................................... 72
 6.4 按需调用 (Call-by-need) .......................................................... 73
 6.5 高阶抽象语法 (Higher Order Abstract Syntax, HOAS) ......................... 74
 6.6 参数化高阶抽象语法 (Parametric Higher Order Abstract Syntax, PHOAS) ..... 76
 6.7 嵌入IO (Embedding IO) ........................................................... 78
 6.8 完整源码 (Full Source) ........................................................... 79

------

**第7章 Hindley-Milner 推断** (Chapter 7: Hindley-Milner Inference)

7.1 语法 (Syntax) ................................................................. 82
 7.2 多态性 (Polymorphism) .......................................................... 83
 7.3 类型 (Types) ................................................................. 83
 7.4 上下文 (Context) ............................................................... 84
 7.5 推断单子 (Inference Monad) ..................................................... 85
 7.6 替换 (Substitution) ............................................................. 85
 7.7 单一化 (Unification) ............................................................ 87
 7.8 泛化与实例化 (Generalization and Instantiation) ............................. 89
 7.9 类型规则 (Typing Rules) .......................................................... 90
 7.10 约束生成 (Constraint Generation) ............................................ 94
 7.11 类型检查 (Typing) ............................................................... 95
 7.12 约束求解器 (Constraint Solver) ................................................ 96
 7.13 练习例子 (Worked Examples) .................................................... 97
 7.14 解释器 (Interpreter) ............................................................ 99
 7.15 交互式Shell (Interactive Shell) .............................................. 100
 7.16 观察 (Observations) ............................................................. 103
 7.17 完整源码 (Full Source) .......................................................... 105

------

**第8章 ProtoHaskell的设计** (Chapter 8: Design of ProtoHaskell)

8.1 Haskell：丰富的语言 (Haskell: A Rich Language) ............................ 106
 8.2 作用域 (Scope) ................................................................. 107
 8.3 中间形式 (Intermediate Forms) .................................................. 108
 8.4 编译器单子 (Compiler Monad) ..................................................... 109
 8.5 工程概览 (Engineering Overview) ............................................... 110
 8.6 REPL ................................................................. 110
 8.7 解析器 (Parser) ............................................................... 112
 8.8 重命名器 (Renamer) ............................................................ 113
 8.9 数据类型 (Datatypes) ............................................................ 113
 8.10 去糖 (Desugaring) ............................................................. 113
 8.11 核心语言 (Core) ............................................................... 116
 8.12 类型类 (Type Classes) ........................................................... 117
 8.13 类型检查器 (Type Checker) ....................................................... 118
 8.14 解释器 (Interpreter) ............................................................ 119
 8.15 错误报告 (Error Reporting) ..................................................... 119

------

**第9章 扩展解析器** (Chapter 9: Extended Parser)

9.1 工具链 (Toolchain) ............................................................. 131
 9.2 Alex ................................................................. 133
 9.3 Happy ................................................................. 134
 9.4 语法错误 (Syntax Errors) ........................................................ 136
 9.5 类型错误来源 (Type Error Provenance) ......................................... 137
 9.6 缩进 (Indentation) ............................................................... 140
 9.7 可扩展操作符 (Extensible Operators) ............................................ 142
 9.8 完整源码 (Full Source) .......................................................... 145

------

**第10章 自定义数据类型** (Chapter 10: Custom Datatypes)

10.1 代数数据类型 (Algebraic data types) ........................................... 146
 10.2 等规类型 (Isorecursive Types) .................................................... 147
 10.3 内存布局 (Memory Layout) ........................................................ 148
 10.4 模式审查 (Pattern Scrutiny) ..................................................... 149
 10.5 语法 (Syntax) ................................................................. 151
 10.6 GHC.Generics ............................................................. 151
 10.7 沃德勒算法 (Wadler’s Algorithm) ............................................. 152
 10.8 完整源码 (Full Source) .......................................................... 153

------

**第11章 重命名器** (Chapter 11: Renamer)

11.1 重命名过程 (Renaming Pass) ..................................................... 154
 11.2 完整源码 (Full Source) .......................................................... 154

------

**第12章 模式匹配与去糖** (Chapter 12: Pattern Matching & Desugaring)

*此章节内容已包含在前述章节中，无需单独列出。*

------

**第13章 System-F** (Chapter 13: System-F)

*内容待补充。*

------

**第14章 类型类** (Chapter 14: Type Classes)

*内容待补充。*

------

**第15章 核心语言** (Chapter 15: Core Language)

*内容待补充。*

------

**第16章 种类** (Chapter 16: Kinds)

*内容待补充。*

------

**第17章 Haskell类型检查器** (Chapter 17: Haskell Type Checker)

*内容待补充。*

------

**第18章 核心解释器** (Chapter 18: Core Interpreter)

*内容待补充。*

------

**第19章 Prelude** (Chapter 19: Prelude)

*内容待补充。*

------

**第20章 惰性求值设计** (Chapter 20: Design of Lazy Evaluation)

*内容待补充。*

------

**第21章 STG** (Chapter 21: STG)

*内容待补充。*

------

**第22章 编译** (Chapter 22: Compilation)

*内容待补充。*

------

**第23章 运行时设计** (Chapter 23: Design of the Runtime)

*内容待补充。*

------

**第24章 Imp** (Chapter 24: Imp)

*内容待补充。*

------

**第25章 代码生成 (C)** (Chapter 25: Code Generation (C))

*内容待补充。*

------

**第26章 代码生成 (LLVM)** (Chapter 26: Code Generation (LLVM))

26.1 LLVM ................................................................. 175
 26.2 类型 (Types) ............................................................... 176
 26.3 变量 (Variables) ............................................................ 178
 26.4 指令 (Instructions) .......................................................... 178
 26.5 数据 (Data) ................................................................. 179
 26.6 基本块 (Blocks) ............................................................. 179
 26.7 控制流 (Control Flow) .......................................................... 180
 26.8 调用 (Calls) ................................................................. 188
 26.9 内存 (Memory) ............................................................... 188
 26.10 获取元素指针 (GetElementPtr) .............................................. 189
 26.11 类型转换 (Casts) ............................................................. 189
 26.12 工具链 (Toolchain) ........................................................... 189
 26.13 llvm-general ............................................................. 191
 26.14 代码生成 (LLVM) ............................................................. 191
 26.15 资源 (Resources) ............................................................. 191

------

**第27章 行多态与效果类型** (Chapter 27: Row Polymorphism & Effect Typing)

*内容待补充。*

------

**第28章 未来工作** (Chapter 28: Future Work)

*内容待补充。*

------

**附录**

**习题** (Exercises) ................................................................. 29

**拓展阅读** (Further reading) ..................................................... 27

------

**注释：**

- 部分章节内容尚未提供详细信息，建议根据具体内容补充相应的子章节和页码。
- 请确保所有章节和子章节的翻译准确，并根据实际内容调整编号和页码。



----

- [Chapter 1: Introduction](https://smunix.github.io/dev.stephendiehl.com/fun/000_introduction.html)
- [Chapter 2: Haskell Basics](https://smunix.github.io/dev.stephendiehl.com/fun/001_basics.html)
- [Chapter 3: Parsing](https://smunix.github.io/dev.stephendiehl.com/fun/002_parsers.html)
- [Chapter 4: Lambda Calculus](https://smunix.github.io/dev.stephendiehl.com/fun/003_lambda_calculus.html)
- [Chapter 5: Type Systems](https://smunix.github.io/dev.stephendiehl.com/fun/004_type_systems.html)
- [Chapter 6: Evaluation](https://smunix.github.io/dev.stephendiehl.com/fun/005_evaluation.html)
- [Chapter 7: Hindley-Milner Inference](https://smunix.github.io/dev.stephendiehl.com/fun/006_hindley_milner.html)
- [Chapter 8: Design of ProtoHaskell](https://smunix.github.io/dev.stephendiehl.com/fun/007_path.html)
- [Chapter 9: Extended Parser](https://smunix.github.io/dev.stephendiehl.com/fun/008_extended_parser.html)
- [Chapter 10: Custom Datatypes](https://smunix.github.io/dev.stephendiehl.com/fun/009_datatypes.html)
- Chapter 11: Renamer
- Chapter 12: Pattern Matching & Desugaring
- Chapter 13: System-F
- Chapter 14: Type Classes
- Chapter 15: Core Language
- Chapter 16: Kinds
- Chapter 17: Haskell Type Checker
- Chapter 18: Core Interpreter
- Chapter 19: Prelude
- Chapter 20: Design of Lazy Evaluation
- Chapter 21: STG
- Chapter 22: Compilation
- Chapter 23: Design of the Runtime
- Chapter 24: Imp
- Chapter 25: Code Generation ( C )
- Chapter 26: Code Generation ( LLVM )
- Chapter 27: Row Polymorphism & Effect Typing
- Chapter 28: Future Work
