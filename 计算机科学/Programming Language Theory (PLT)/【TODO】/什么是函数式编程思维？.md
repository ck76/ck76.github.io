- https://www.zhihu.com/question/28292740/answer/612467700?utm_psn=1813669367822548992

一知乎老哥说的不错

```
作者：含章
链接：https://www.zhihu.com/question/28292740/answer/612467700
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

我还记得大一学python的时候，那是我第一次接触“函数式”的东西。我以为函数式编程就是map，把一个序列转化为另一个序列。后来学了点haskell和scheme，好像函数式是一大堆语言上的概念，什么数据不可变，什么continuation，cps，callcc，monad，arrow。再后来学了一点lambda calculus，以为函数式是基于和图灵机等价的lambda calculus延申出来的计算模型，是SKI，是抽象。再后来接触到了PLT，好嘛，函数式是C-H同构翻译过来的定理，是集合论，是类型论，是直觉类型论，是同伦类型论，是宇宙，是...我现在倒是认为，什么面向对象，什么函数式，都是看待问题的一种方式，是世界观。面向对象就像把所有的东西都看作独立的个体，它们可以被归类，有自己的状态，可以互相发消息。面向对象编程思维就是设计好一个个对象，然后自己亲手去“摆弄”它们。谁什么时间干什么，安排的明明白白。而函数式则是把世界看成一个整体。就像我们高中学物理的动力学似的，给定一个初始状态，根据牛顿动力学定律，整个体系之后的运动都是确定的。是一个个具体的运动规则应用在整个体系之上，整个体系被运动规则驱动，做着完全可预测的工作。所以函数式当然没有什么变量，没有什么副作用，因为我们是物理学家，我们在用规则刻画整个世界。我们没有什么对象，没有什么消息，有的只是[一切] ->规则-> [新的一切]。所以，我现在觉得，函数式编程思维啊，还是map。
```

这段话讲述了作者从学习编程语言的过程中，逐步对“函数式编程”概念的理解与演变，最终形成了一种对编程范式的哲学思考。

### 主要内容分析：
1. **初次接触函数式编程**：
   - 作者最初接触“函数式编程”是在学习Python时，认为函数式编程就是通过`map`函数将一个序列转换为另一个序列。
   - 这种理解将函数式编程简化为对集合操作的一种技术手段。

2. **深入学习Haskell和Scheme**：
   - 学习Haskell和Scheme之后，作者开始意识到函数式编程涉及更多的概念，如数据不可变性、continuation-passing style (CPS)、call/cc（call with current continuation）、monad、arrow等。
   - 这些概念在函数式编程语言中非常重要，帮助开发者以更高层次的抽象来构建程序。

3. **探索Lambda Calculus**：
   - 随着对Lambda Calculus的学习，作者进一步理解函数式编程是基于与图灵机等价的计算模型，即Lambda Calculus，是关于函数的抽象与计算。
   - 在这一阶段，作者开始理解函数式编程不仅仅是语言特性，而是计算的一个基本模型。

4. **接触PLT（编程语言理论）**：
   - 学习PLT后，作者认识到函数式编程还涉及深奥的理论基础，如Curry-Howard同构、集合论、类型论、直觉类型论、同伦类型论等。
   - 这些理论为函数式编程提供了坚实的数学基础，使得它不仅仅是一种编程风格，而是与逻辑和数学有着深刻联系的世界观。

5. **世界观的转变**：
   - 最终，作者将函数式编程视为一种世界观，类似于面向对象编程，但两者关注点不同。
   - 面向对象编程将世界视为由独立个体（对象）组成，这些对象有状态并通过消息进行交互。
   - 而函数式编程则将世界看作一个整体，使用规则（函数）来描述状态的转换，强调系统的整体行为，而不是个别对象的操作。

6. **函数式编程的本质**：
   - 作者回到最初的认知，认为函数式编程的思维本质仍然是“map”，即对整个世界的规则应用，生成新的状态。
   - 这是一种从整体视角出发，以规则驱动状态变化的方式来看待编程的问题。

### 总结：
- **函数式编程**从最初简单的序列操作，到深入理解的复杂概念，再到一种看待编程问题的哲学思考，作者认为它是用规则刻画世界的一种方式。
- **面向对象编程**关注个体对象的状态和行为，而**函数式编程**更关注整体系统的规则驱动，强调状态变化的可预测性和确定性。
- 最终，作者将函数式编程的思维归结为一种整体视角的“map”操作。

这段话展示了编程语言学习过程中对概念理解的不断深化，以及从技术到哲学的认知转变。

这句话提到了函数式编程背后的一些深奥理论基础。下面我将详细解释每个提到的概念，并说明它们如何与函数式编程相关联。

### 1. **Curry-Howard同构 (Curry-Howard Isomorphism)**
   - **概念**：Curry-Howard同构是计算机科学和逻辑学中的一个重要理论，它指出“程序即证明，类型即命题”的对应关系。简单来说，在Curry-Howard同构中，一个逻辑命题可以被看作一个类型，而该命题的证明则对应于该类型的一个实例（程序）。
   - **与函数式编程的关系**：在函数式编程中，尤其是那些带有类型系统的语言（如Haskell、Coq、Agda），Curry-Howard同构提供了一种理解程序与逻辑推理的方式。编写程序的过程就像是在构造证明，而类型检查则确保了证明的正确性。

### 2. **集合论 (Set Theory)**
   - **概念**：集合论是数学的一个基础理论，它研究集合的性质、运算以及各种集合之间的关系。它是整个数学体系的基础，几乎所有的数学概念都可以在集合论的框架下得到形式化的定义。
   - **与函数式编程的关系**：函数式编程中，许多数据结构（如列表、树、映射等）可以看作是集合的具体表现形式。集合论的概念在函数式编程中广泛应用于定义这些数据结构及其操作。此外，集合论中的函数也直接对应于编程语言中的函数概念。

### 3. **类型论 (Type Theory)**
   - **概念**：类型论是一种理论框架，用于描述和处理数据的类型及其运算。类型论不仅仅用于编程语言，还在数学和逻辑中有着重要应用。它为构建程序提供了一种形式化的方法，确保程序的正确性和安全性。
   - **与函数式编程的关系**：函数式编程语言通常具有强类型系统，这些类型系统背后的理论基础就是类型论。类型论提供了构造和验证程序的工具，确保程序在逻辑上不包含错误。

### 4. **直觉类型论 (Intuitionistic Type Theory)**
   - **概念**：直觉类型论是一种特定的类型论，由瑞典数学家Per Martin-Löf在20世纪70年代提出。它结合了构造性数学和类型论，用于描述如何在不使用经典逻辑（如排中律）的情况下构造数学对象。
   - **与函数式编程的关系**：直觉类型论为依赖类型语言（如Agda和Coq）提供了理论基础。在这些语言中，类型可以依赖于值，程序的证明过程和程序的构造过程紧密相关。

### 5. **同伦类型论 (Homotopy Type Theory, HoTT)**
   - **概念**：同伦类型论是一种将类型论和代数拓扑（特别是同伦论）结合起来的新兴理论。它将类型看作拓扑空间中的对象，将类型之间的等式看作这些对象之间的同伦（即连续变形）。
   - **与函数式编程的关系**：同伦类型论提供了一种新的方式来理解程序中的等价性问题，特别是在证明助手中，如Lean和Coq。同伦类型论允许通过几何直观来理解类型和等式，为函数式编程提供了更强大的逻辑基础。

### 6. **宇宙 (Universes)**
   - **概念**：在类型论中，“宇宙”是指包含所有类型的一个类型，通常被用来避免类型层级之间的悖论。在同伦类型论中，宇宙还可以包含更复杂的结构，如依赖类型或高阶类型。
   - **与函数式编程的关系**：宇宙的概念在依赖类型的编程语言中非常重要，它允许我们定义类型的层次结构，确保类型系统的一致性和表达力。在这些语言中，宇宙帮助管理不同层次的类型，防止类型系统中的自指问题。

### 总结：
- **函数式编程**不仅仅是编程语言的一个范式，更是与深奥的数学和逻辑理论密切相关的领域。这些理论为函数式编程提供了坚实的基础，确保程序的正确性、逻辑一致性和安全性。
- **Curry-Howard同构**帮助我们理解程序和证明的对应关系。
- **集合论**为数据结构的定义和操作提供了基础。
- **类型论**确保了程序的类型安全性。
- **直觉类型论**和**同伦类型论**为依赖类型语言提供了强大的工具。
- **宇宙**管理着类型层次结构，确保类型系统的稳定和强大。

通过理解这些概念，函数式编程的意义和作用就不仅仅是编写代码，而是进入了一个更深层次的逻辑和数学的探讨领域。

在依赖类型的编程语言中，**宇宙**（Universe）的概念起着非常关键的作用，它为管理类型系统中的层次结构提供了理论基础。为了更好地理解这个概念，我们需要深入探讨以下几个方面：

### 1. 什么是宇宙？
**宇宙**是一个特殊的类型，它本身是类型的集合或级别。宇宙允许我们在类型层级上进行区分和管理。例如，如果我们定义一个类型 $A$，而 $A$ 的值本身又是一个类型，那么 $A$ 可以被认为是一个“宇宙”。这种结构可以递归下去，产生一系列嵌套的宇宙。

在类型论中，宇宙通常被表示为 $U_0, U_1, U_2, \ldots$，其中每个 $U_i$ 都是一个更高层次的宇宙。通常，$U_0$ 包含基本的类型，$U_1$ 包含所有 $U_0$ 中的类型，$U_2$ 包含所有 $U_1$ 中的类型，以此类推。

### 2. 为什么需要宇宙？
在依赖类型语言中，类型可以依赖于值，这意味着我们可以构建非常复杂的类型结构。例如，我们可以定义一个类型 $Vec(A, n)$，其中 $A$ 是元素的类型，$n$ 是一个自然数，表示向量的长度。然而，当我们定义这样的类型时，如果没有对类型层级进行控制，我们可能会遇到**类型系统的自指问题**。

**自指问题**意味着一个类型可能会包含自己作为其元素的一部分，这可能导致不一致性或悖论。为了避免这种情况，宇宙提供了一种分层的结构，使得每个层级的类型只能引用低层级的类型，而不能引用自己或更高层级的类型。

### 3. 如何通过宇宙管理不同层次的类型？
在带有宇宙的类型系统中，每个类型被分配到一个特定的宇宙中。例如：

- $U_0$ 包含基本类型，比如自然数、布尔类型等。
- $U_1$ 包含所有 $U_0$ 中的类型，以及定义在这些类型之上的类型构造。
- $U_2$ 包含所有 $U_1$ 中的类型，以此类推。

这种分层方式确保了一个类型 $A$ 所在的宇宙 $U_i$ 不会直接或间接包含自身，这避免了类型系统的自指问题。例如，如果 $A$ 在 $U_0$ 中，那么 $Vec(A, n)$ 可能在 $U_1$ 中，而 $U_1$ 又不能包含 $U_0$ 以内的任何类型，因此不会出现类型自身包含自己的情况。

### 4. 宇宙如何提高类型系统的一致性和表达力？
- **一致性**：通过使用宇宙，我们可以确保类型系统的一致性。宇宙允许我们对类型层次进行严格控制，防止任何可能引起悖论或不一致性的情况。所有类型都位于明确的层级之中，不同层级的类型之间的关系是严格受控的。

- **表达力**：宇宙不仅确保了一致性，还提高了类型系统的表达力。通过引入宇宙，我们可以在类型系统中表达更复杂的关系。例如，我们可以定义宇宙的层次结构，使得类型 $A$ 可以依赖于值，同时还可以依赖于其他类型，从而在类型层次上表达复杂的依赖关系。

### 5. 具体应用：防止类型系统中的自指问题
在一些复杂的依赖类型语言中，如果没有宇宙，可能会发生类型自指的问题。例如，考虑一个类型 $T$，它的定义中直接或间接引用了自己。如果允许这种自指存在，类型系统可能会变得不一致，无法正确推导和检查类型。

宇宙通过严格的层级划分防止了这种情况的发生。每个宇宙中的类型只能依赖于低层级的类型，而不能依赖自身或更高层级的类型。这种机制确保了类型系统的安全性和一致性，从而使得复杂的类型构造和依赖关系得以安全地表达。

### 总结：
宇宙在依赖类型编程语言中起着至关重要的作用。它允许我们构建复杂的类型系统，同时保证系统的一致性和安全性。通过引入宇宙，我们可以避免类型系统中的自指问题，确保每个类型都有明确的层级，防止类型层次结构的混乱。此外，宇宙还提高了类型系统的表达力，使得我们能够在更高层次上表达类型之间的关系和依赖。