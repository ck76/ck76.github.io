[TOC]

# 一、基本概念

在刚开始学习`Dart`的时候，对于`const, final, static`这几个关键字很容易产生困惑，究竟该在那种场景下使用它们，这篇文章就从以下几个方面总结一下这三个关键字：

- 基本概念
- 一些要注意的点
- 在何种场景下，使用哪种关键字

## 1.1 const

`const`有以下几种应用场景：

### (1) `const`用在`=`左边

当`const`用在`=`左边时，其作用是 **声明变量**，它要求 **必须在声明变量时赋值，一旦赋值就不允许修改，而声明值一定要是编译时常数**。

`const`在声明变量时可以省略变量的类型,`var, int`等。

这里的关键点在于区分 **什么是编译时常数**，有以下几种场景：

- 数值、字符串、其它的`const`变量



```dart
void main() {
  const a = 1;
  const b = 'hello';
  const c = a;
}
```

- 表达式。表达式的所有值都是编译时可知的。



```dart
void main() {
  const a = 1;
  const b = a > 1 ? 2 : 1;
}
```

- 集合或对象。集合必须用`const`修饰，对象的构造函数必须用`const`修饰。



```dart
void main() {
  const a = const [1,2,3];
  const b = ConstObject(2);
  b.log();
}

class ConstObject {
  
  final value;
  
  const ConstObject(this.value);
  
  log() {
    print(value);
  }
}
```

### (2) `const`用在等号右边

当`const`用在`=`右边，其作用是 **修饰值**，它意味着对象的整个深度状态可以在编译时完全确定，并且对象将被冻结并且完全不可变。

一般用于修饰集合，它要求两点：

- 集合的元素必须是递归的编译时常数，也就是上面提到的三种情况。



```dart
void main() {
  var c = 2;
  //ERROR, 集合元素必须是编译时常数。
  var a = const [c,2,3];
}
```

- 不允许对集合做任何改变。



```dart
void main() {
  const a = const [1,2,3];
  //ERROR, 不允许修改。
  a[1] = 2;
}
```

### (3) `const`修饰类的构造函数

当`const`修饰类的构造函数时，它要求该类的所有成员都必须是`final`的。



```dart
class ConstObject {
  
  final value;
  //ERROR, 必须是 final 变量。
  int value2;
  
  const ConstObject(this.value);
  
  log() {
    print(value);
  }
}
```

## 1.2 final

`final`的要求就是 **其声明的变量在赋值之后就不再改变**，它并不要求`=`的右边是编译时常数。

`final`有两种场景：

- 文件中的变量声明：必须在声明时赋值。
- 类的成员变量声明：可以在声明时赋值，也可以通过构造函数赋值语法糖`ClassV({this.a})`，或者初始化列表的方式赋值。

## 1.3 static

`static`的概念相对来说就比较容易理解了，它的作用是 **声明类的成员变量，使得多个相同类型的类对象共享同一个成员变量的实例**。

# 二、一些要点

## 2.1 const

- 声明类成员变量时，`const`变量必须同时被声明为`static`的。
- `const`变量，变量命名方式应使用全大写加下划线。
- `const`变量只能在定义的时候初始化。

## 2.2 final

- `final`变量可以在构造函数参数列表或者初始化列表中初始化。

## 2.3 static

- 在文件中，变量不能声明为`static`。

# 三、在何种场景下，使用哪种关键字

下面的表格总结了如何选取关键字，判断的顺序依次往下。

## 3.1 类

| 判断顺序                                   | 关键词                                                       |
| ------------------------------------------ | ------------------------------------------------------------ |
| 值是编译时常数                             | `static const`                                               |
| 值不是编译时常数，但所有类都共享同一个实例 | `static final`：在声明的时候就能确定值，并且不再改变；`static`：不能确定。 |
| 各个类对象持有不同的实例，但只能被赋值一次 | `final`                                                      |
| 其它                                       | 普通定义                                                     |

## 3.2 文件

| 判断条件                                       | 关键词   |
| ---------------------------------------------- | -------- |
| 常量                                           | `const`  |
| 非常量，但在声明时就能确定值，并且不希望被改变 | `final`  |
| 其它                                           | 普通定义 |



10人点赞



[Flutter]()





作者：泽毛
链接：https://www.jianshu.com/p/d674537e1336
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。