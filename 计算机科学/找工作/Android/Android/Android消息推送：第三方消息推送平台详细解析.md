https://www.jianshu.com/p/d77eaca4e52a

[TOC]

# 前言

- 消息推送在Android开发中应用的场景是越来越多了，比如说电商产品进行活动宣传、资讯类产品进行新闻推送等等，如下图：

![img](https://tva1.sinaimg.cn/large/008eGmZEly1gmwg78lfh7j30dj0c7n5i.jpg)

推送消息截图

- 本文将介绍Android中实现消息推送的第三方推送的详细解决方案

> 阅读本文前，建议先阅读我写的文章：[史上最全解析Android消息推送解决方案](https://www.jianshu.com/p/b61a49e0279f)

------

# 目录

![img](https://tva1.sinaimg.cn/large/008eGmZEly1gmwg771tkvj30iw0b1jsy.jpg)

目录

------

# 1. 主流的第三方推送平台分类

- 手机厂商类：小米推送、华为推送。
- 第三方平台类：友盟推送、极光推送、云巴（基于MQTT）
- BAT大厂的平台推送：阿里云移动推送、腾讯信鸽推送、百度云推送

------

# 2. 对比其他推送方式的特点

其他推送方式还有：C2DM、轮询、SMS、MQTT协议、XMPP协议等等，相对于这些推送方式，第三方推送方式的特点分别是：

### 2.1 优点：

1. 成本低
   上述的推送大多数是免费的，假如自己实现则消耗过多资源（开发成本和后台管理、统计成本）
2. 消息到达率高
   如果一个手机里有多个App使用了同一家推送服务，那么这些App将共用一条消息通道，即使你家的App推送服务被杀死了，那么只要用户打开了其他集成该推送服务的App，你家的推送就能到达用户

### 2.2 缺点

1. 安全性低
   使用别人的服务器，所以你懂的。
2. 服务会被杀死
   由于Android系统的机制，后台推送 Service 会被各种主动的或是被动的行为给杀死，而服务一旦被杀死，意味着就接收不到推送消息。

------

# 3. 第三方推送服务方式的特点

- 第三方服务基本都具备免费、和到达率高的特点
- 那么应该如何选择呢？我们来分别看一下第三方推送各种方式的优点：

### 3.1 手机厂商推送

**请记住一个潜规则：操作系统是不会杀死属于自己品牌的推送服务。**

> 1. 手机厂商的推送服务在自家的手机上属于系统级别的服务，这意味着系统不会杀死自家的推送服务
> 2. 比如说，Android原生系统是不会杀死C2DM消息推送服务，MIUI系统是不会杀死小米的推送服务。

当今市场上的Android手机系统份额最高是MIUI系统，即小米（具体排名请看[http://www.umindex.com/](https://links.jianshu.com/go?to=http%3A%2F%2Fwww.umindex.com%2F)）

因为：免费、到达率高且在Android系统市场份额第一的MIUI系统上不被杀死。所以，如果要选择手机厂商的推送服务，**请选择小米推送作为第三方平台实现推送服务**

下面一些应用可以从侧面来证明我的推断：

- **腾讯新闻**使用的小米推送，没有使用自己家的信鸽推送
- **淘宝**使用了自家的阿里云推送，同时还集成了小米推送
- **百度视频**和**爱奇艺**使用的是小米推送，没有用自家的百度推送
- 官网截图 - 集成应用：

![img](https://tva1.sinaimg.cn/large/008eGmZEly1gmwg756v86j30sr08i413.jpg)

集成应用

> 1. 如果希望进一步提高推送的效果，其实可以集成多个手机厂商的推送服务
> 2. 比如小米渠道用小米推送，华为渠道用华为推送，但这样的实现成本会大一些

### 3.2 第三方平台类

请记住一个规则：推送系统会共享一条推送渠道

> 1. 这意味着假设你接入了友盟推送，而恰好今日头条也接入了友盟。
> 2. 有一天你的App被杀死了，但这时用户启动了今日头条，那么推送系统也就会通过共享的推送通道顺便把你推送消息送达到手机上，然后还可能把你的进程也唤醒（被“保活”了）。

所以说，关于如何选择第三方平台类的推送，推送平台的规模效应就很重要了。
那如何得知他们的规模和市场份额呢？按个人经验，主要看两点：

- 问内部的朋友。
- 看推送平台的合作客户里有哪些大的app - 参考对应官网的合作案例

### 3.3 BAT大厂的推送

BAT大厂其实并没有什么优势，**同时谨记：**

- 不要以为用了腾讯信鸽推送，就能占上微信的光保证你的App永远内部被杀死。
- 说个题外话，手机淘宝除了自家的阿里云的移动推送，同时也使用其它的第三方推送平台啊（比如友盟推送）。

------

# 4. 如何选择第三方平台推送服务？

- 选择因素
  用户群体属性、实现成本、渠道
- 具体选择方案

![img](https://tva1.sinaimg.cn/large/008eGmZEly1gmwg733igdj30qo09ggm3.jpg)

示意图

所以，大家可根据自己的使用场景来进行消息推送平台的选择。

------

# 5. 推送消息类别的选择

#### 5.1 推送消息的类别

通常第三方推送平台都支持两种推送消息类型：通知栏消息和透传消息。

- 通知栏消息：该类消息在被送达用户的设备后，直接以系统通知栏的形式展示给用户

> 不会继续被传递到App

- 透传消息：该类消息在被送达用户的设备后，还会继续传递到App

> 1. 通过回调App的某个BroadcastReceiver的形式将消息传递到App内部。然后由App决定如何处理和显示这个消息。
> 2. 所以透传消息不一定会以系统通知栏的形式进行推送，由程序猿自定义

#### 5.2 消息类别的区别与特点

- 二者的区别在于：透传消息在整个消息传递过程中比通知栏消息多了一步-传递到App
- 通知栏消息的优点：送达率高
  因为透传消息在整个消息传递过程中比通知栏消息多了一步-传递到App，因此透传消息就增加一些被系统限制的概率，给系统杀死的概率就高一些，所以说，通知栏消息比透传消息应该能提供更好的送达率。

> 我们来看下小米推送的官方文档描述：
>
> 1. 在一些 Android 系统(如 MIUI)中，受到系统自启动管理设置的限制,应用不能在后台自启动
> 2. 在这类系统中，如果在发送消息的时候对应的应用没有被启动，**透传类消息**将不能顺利送达。
> 3. 因此,对于对送达率要求很高的消息,建议尽量采用通知栏提醒的方式推送消息

- 透传消息的优点：对消息操作程度高 & 自定义程度高

1. 提供了对消息数据的更灵活的操纵能力。

> App如果仅仅通过通知栏消息，是无法接触到消息数据本身的。

1. 可自定义通知提醒的样式（包括提示样式、提示形式如声音等等）

#### 所以大家可以根据不同的使用场景来对推送消息类别进行选择了。

------

# 6. 总结

- 相信大家已经非常了解关于第三方推送的相关信息。
- 关于Android消息推送的其他知识，具体请看：
  [史上最全解析Android消息推送解决方案](https://www.jianshu.com/p/b61a49e0279f)
  [Android消息推送：手把手教你集成小米推送](https://www.jianshu.com/p/b1134bebc2d4)
- 接下来，我会继续介绍具体如何在Android应用中集成相应的第三方推送功能（小米推送、极光推送、个推等等），感兴趣的同学可以继续关注本人运营的`Wechat Public Account`：
- [我想给你们介绍一个与众不同的Android微信公众号（福利回赠）](https://www.jianshu.com/p/2e92908af6ec)
- [我想邀请您和我一起写Android（福利回赠）](https://www.jianshu.com/p/2c5d57fb054d)

------

# 请点赞！因为你的鼓励是我写作的最大动力！

> **相关文章阅读**
> [史上最全解析Android消息推送解决方案](https://www.jianshu.com/p/b61a49e0279f)
> [Android开发：最全面、最易懂的Android屏幕适配解决方案](https://www.jianshu.com/p/ec5a1a30694b)
> [Android开发：Handler异步通信机制全面解析（包含Looper、Message Queue）](https://www.jianshu.com/p/9fe944ee02f7)
> [Android开发：顶部Tab导航栏实现（TabLayout+ViewPager+Fragment）](https://www.jianshu.com/p/ce1d060573ba)
> [Android开发：底部Tab菜单栏实现（FragmentTabHost+ViewPager）](https://www.jianshu.com/p/a663803b2a44)
> [Android开发：JSON简介及最全面解析方法!](https://www.jianshu.com/p/b87fee2f7a23)
> [Android开发：XML简介及DOM、SAX、PULL解析对比](https://www.jianshu.com/p/e636f4f8487b)

------

### 欢迎关注[Carson_Ho](https://www.jianshu.com/users/383970bef0a0/latest_articles)的简书！

不定期分享关于**安卓开发**的干货，追求**短、平、快**，但**却不缺深度**



作者：Carson_Ho
链接：https://www.jianshu.com/p/d77eaca4e52a
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。